<!DOCTYPE html>
<html lang="en" class="mdl-js"><!-- EntryPointHelper::GetHeader --><head>
            
            <title>EventPilot Web App</title>
            
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
            <meta name="HandheldFriendly" content="TRUE">
            <meta name="apple-mobile-web-app-capable" content="yes">
            <meta name="robots" content="noindex">
            <meta name="googlebot" content="noindex">
            <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
            <meta http-equiv="Cache-control" content="max-age=604800">
            <link rel="shortcut icon" type="image/x-icon" href="https://eppro02.ativ.me/favicon.ico">
            <link rel="icon" href="https://eppro02.ativ.me/favicon.ico" type="image/x-icon">
            <script async="" src="analytics.js"></script><script src="page_data_003/jquery.min.js"></script>
            <script src="page_data_003/EPUtility_002.js" type="text/javascript"></script>
            <script src="page_data_003/urn.js"></script>

            <!-- EntryPointHelper::GetHeader END -->


			<!-- Draw Include -->
			<link rel="stylesheet" href="Draw.css">
			<script src="Draw.js"></script>
        <!-- UIDraw::GetStaticIncludes -->
        <link rel="stylesheet" href="fontawesome.min.css">
        <link rel="stylesheet" href="material.min.css">
        <script defer="defer" src="material.min.js"></script>
        <!--getmdl-select-->
        <link rel="stylesheet" href="getmdl-select.min.css">
        <script defer="defer" src="getmdl-select.min.js"></script>
        <!--dialog-polyfill-->
        <link rel="stylesheet" href="dialog-polyfill.css">
        <script defer="defer" src="dialog-polyfill.js"></script>
        <!-- woff2 -->
        <link rel="preload" href="https://eppro02.ativ.me/common/mdl/MaterialDesign.woff2" as="font" type="font/woff2" crossorigin="anonymous">
        <link rel="preload" href="https://eppro02.ativ.me/common/mdl/MaterialDesignOutline.woff2" as="font" type="font/woff2" crossorigin="anonymous">
        <link rel="preload" href="https://eppro02.ativ.me/common/fontawesome/fa-sharp-thin-100.woff2" as="font" type="font/woff2" crossorigin="anonymous">
        <!-- jquery -->
        <link rel="stylesheet" href="jquery-ui.min.css">
        <script src="jquery-ui.min.js"></script>
        <script src="jquery.ui.touch-punch.min.js"></script>
        <link rel="stylesheet" type="text/css" href="jquery.multiselect.css">
        <script type="text/javascript" src="jquery.multiselect.js"></script>
        <!-- UIDraw::GetStaticIncludes END -->
			<!-- UIDraw Include -->
			<link rel="stylesheet" href="UIDraw.css">
			<script src="UIDraw.js"></script>

            <!-- WebHeaderUIDraw -->
            <style>
            .webheaderuidraw_content{
                position:fixed;
                top:0;
                left:0;
                right:0;
                padding: 0 10px;
                background: #FFFFFF;
                box-shadow: 0 1px 3px 0 rgba( 0, 0, 0, 0.3 );
                backdrop-filter: blur( 8px );
                -webkit-backdrop-filter: blur( 8px );
                color:#666;
                z-index: 100;
                text-align: center;
                height:40px;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .webheaderuidraw_content.darkmode{
                background: #333333EE;
                border-bottom:thin solid #777;
                color:#eee;
            }
            .webheaderuidraw_push{
                height:40px;
            }
            
            .webheaderuidraw_title{
                margin:0;
                font-size:18px;
                font-weight: 400;
                text-overflow: ellipsis;
                overflow: hidden;
                white-space: nowrap;
                outline: 0!important;
                flex-grow:1;
            }
            .webheaderuidraw_left, .webheaderuidraw_right{
                display:flex;
                align-items:center;
                min-width:75px;
            }
            .webheaderuidraw_right{
                justify-content:flex-end;
            }

            </style>
            <script>
                // **************************************************
                // WebHeaderUIDraw - JS Class

                class WebHeaderUIDraw extends UIDraw{

                    constructor(objname){
                        super(objname);
                        this.callback = null;
                    }

                    Setup(callback){
                        var local = this;

                        var prefix = this.GetPrefix();
                        var obj    = this.GetObjectName();
                        var name   = this.GetClassNameLower();

                        // Store the callback
                        this.callback = callback;
                    }

                }
//# sourceURL=WebHeaderUIDraw.js
            </script>        <!-- TooltipUIDraw -->
        <script>
        // **************************************************
        // TooltipUIDraw - JS Class
        class TooltipUIDraw extends UIDraw{
            constructor(objname){
                super(objname);

                this.callback = null;

                this.alignment   = 'center';
                this.optionClass = '';
                this.targetID    = '';
                this.msg         = '';

                this.disabled = false;
            }

            Setup(callback){
                this.callback = callback;
            }

            Disable(){
                this.disabled = true;
                let elem = $('#'+this.prefix+'_tooltipuidraw');
                if(typeof elem != 'undefined'){
                    elem.remove();
                }
            }

            SetMsg(msg){
                this.msg = msg;
                let elem = $('#'+this.prefix+'_tooltipuidraw');
                if(typeof elem != 'undefined'){
                    elem.text(msg);
                    this.MDLUpdate();
                }
            }

            SetTargetId(targetID){
                this.targetID = targetID;
                let elem = $('#'+this.prefix+'_tooltipuidraw');
                if(typeof elem != 'undefined'){
                    elem.attr('data-mdl-for', targetID);
                    this.MDLUpdate();
                }
            }

            SetAlignment(alignment){
                this.alignment = alignment;
            }

            SetTooltipPosition(position) {
                switch (position) {
                    case "large":
                    this.optionClass = "mdl-tooltip--large";
                    break;
                    case "top":
                    this.optionClass = "mdl-tooltip--top";
                    break;
                    case "bottom":
                    this.optionClass = "mdl-tooltip--bottom";
                    break;
                    case "right":
                    this.optionClass = "mdl-tooltip--right";
                    break;
                    case "left":
                    this.optionClass = "mdl-tooltip--left";
                    break;
                }//switch
                let elem = $('#'+this.prefix+'_tooltipuidraw');
                if(typeof elem != 'undefined'){
                    // Add a class to javascript
                    elem.removeClass('mdl-tooltip--large mdl-tooltip--top mdl-tooltip--bottom mdl-tooltip--right mdl-tooltip--left');
                    elem.addClass(this.optionClass);
                }
            }

            GetStartHTML() {
                if(!this.disabled){
                    let alignment = "";
                    if (this.alignment != "center") {
                        alignment = `text-align:${this.alignment};`;
                    }

                    let html = `
                        <!-- TooltipUIDraw -->
                        <div id="${this.prefix}_tooltipuidraw" style="min-width:75px; ${alignment}" class="mdl-tooltip ${this.optionClass}" data-mdl-for="${this.targetID}">
                        ${this.msg}
                        </div>`;

                    return html;
                }
                return '';
            }
        }

        function SetupTooltipUIDraw(){
            UIDrawUpdateMDL();
        }
//# sourceURL=TooltipUIDraw.js 
        </script>
        
        <!-- ButtonUIDraw -->
        <style>
                    body: {
            background-color: #f00;
        }
        </style>
        <link rel="stylesheet" href="mdc.button.min.css">
        <style>
        
        .buttonuidraw_basic_outline_button:hover{
            background-color:#EFEFEF;
        }
        .buttonuidraw_basic_outline_button{
            background-color:white;
            border:1px solid #AAA;
            color:#555;
            padding:5px;
            text-align:center;
            border-radius:4px;
            cursor:pointer;
        }

        .buttonuidraw{
            letter-spacing:0;
            font-family: HelveticaNeue, Helvetica, Arial, sans-serif;
        }
        .mymixed_case.mdc-button {
            text-transform: none;
        }
        .mdc-button--raised:not(:disabled){

        }
        .buttonuidraw:hover{
            background-color:#EFEFEF;
        }   
        .buttonuidraw_activity{
            display:none;
            text-align:center;
        }
        .buttonuidraw_activity svg{
            padding-top:10px;
        }
        .buttonuidraw_container{
            display:inline-block;
            text-align:left;
            position:relative;
        }    
        .buttonuidraw_label{
            white-space: nowrap;
            display:flex;
            flex-direction:row;
            align-items:center;
            gap:10px;
        }
        .buttonuidraw_borderonly{
            background:rgba(256,256,256,1);
            box-shadow: none;
            border-radius:3px;
            border: 1px solid;
        }
        .buttonuidraw_noborder{
            border:none;
            background:rgba(256,256,256,1);
            box-shadow:none;
        }
        .buttonuidraw_noborder:hover{
            border:none;
            background:rgba(256,256,256,1);
            box-shadow:none;
        }
        .buttonuidraw_noborder:focus{
            border:none;
            background:rgba(256,256,256,1);
            box-shadow:none;
        }
        .buttonuidraw_noborder.mdc-button--raised:not(:disabled):active{
            border:none;
            background:rgba(256,256,256,1);
            box-shadow:none;
        }
        .buttonuidraw_mini{
            cursor: pointer;
            border-radius: 2px;
            padding: 5px 8px;
            background-color: #1679C2;
            color:white;
            display:inline-block;
        }      
        .buttonuidraw_mini:hover{
            opacity:0.8;
        }     
        .buttonuidraw_subtitle{
            display: none;
            font-size: 0.9em;
            color: #555;
            padding-top: 2px;
            text-align: left;
        }
        .buttonuidraw.disabled {
            opacity:0.5;
            pointer-events:none;
        }
        .buttonuidraw_sideicon_hidden {
            display: none;
        }
        .buttonuidraw_sideicon_active {
            position: absolute;
            left: -1.7em;
            font-size: 1.7em;
            color: #1679C2;
            pointer-events: none;
            
            /* Apparently not necessary to center vertically */
            /* top: 50%; */
            /* transform: translateY(-50%); */
        }
        </style>
        <script>
                    // **************************************************
        // ButtonUIDraw - JS Class
        class ButtonUIDraw extends UIDraw{
            constructor(obj){
                super(obj);

                this.callback = null;

                this.color           = '';
                this.label           = '';
                this.borderOnly      = false;
                this.mixedCaseButton = true;
                this.id              = '';
                this.fontsize        = '1.0em';
                this.subtitle        = '';

                this.bHidden         = false;

                this.tooltip         = new TooltipUIDraw(obj+'.tooltip');
            }

            Config(data){
                var local = this;
                data = local.ParseConfig(data);

                if(data != null){
                    if(typeof data.button_label !== 'undefined' && data.button_label != null){
                        this.SetLabel(data.button_label);
                    }
                }
            }

            /*
            ? Setters:
            SetLabel(label)
            SetColor(color)
            SetBorderOnly(borderOnly)
            SetFontSize(fontsize)
            SetMixedCaseButton(mixedCaseButton)
            SetTooltip(tooltip)
            SetId(id)
            SetBMiniButton(bMiniButton)
            SetBHidden(bHidden)
            SetDisabled(disabled)
            SetSubtitle(subtitle)
            SetSubtitleColor(subtitleColor)
            */

            Setup(callback){
                this.callback = callback;
            }

            SetBorderOnly(borderOnly){
                this.borderOnly = borderOnly;

                let name = this.GetClassNameLower();

                let elem = $('#'+this.prefix+'_'+name+'_container button.buttonuidraw');
                if(this.borderOnly){
                    if(typeof elem != 'undefined'){
                        elem.addClass('buttonuidraw_borderonly');
                        elem.css({'background-color': 'white'});
                        elem.css({'color': this.color});
                        elem.css({'border': '1px solid '+this.color});
                    }
                }else{
                    if(typeof elem != 'undefined'){
                        elem.removeClass('buttonuidraw_borderonly');
                        elem.css({'background-color': this.color});
                        elem.css({'color': 'white'});
                        elem.css({'border': 'none'});
                    }
                }
            }

            SetSubtitle(subtitle){
                this.subtitle = subtitle;
                this.GetElemByExtension('subtitle').html(subtitle);
            }

            SetFontSize(fontsize){
                this.fontsize = fontsize;
            }

            SetMixedCaseButton(mixedCaseButton){
                this.mixedCaseButton = mixedCaseButton;
            }

            SetTooltip(tooltip){
                // If empty tooltip set object SetTargetId to blank so nothing shows
                if(tooltip == ''){
                    this.tooltip.Disable();
                }else{
                    this.tooltip.SetMsg(tooltip);
                }
            }

            SetColor(color){
                this.color = color;

                if(this.borderOnly === null){
                    let txtcolor = this.color;
                    let elem = $('#'+this.prefix+'_buttonuidraw_container button.buttonuidraw');
                    if(typeof elem != 'undefined'){
                        elem.css({'color': txtcolor});
                    }
                }else if(this.borderOnly === true){
                    let txtcolor = this.color;
                    let elem = $('#'+this.prefix+'_buttonuidraw_container button.buttonuidraw');
                    if(typeof elem != 'undefined'){
                        elem.css({'color': txtcolor});
                    }
                }else{
                    let bgcolor = this.color
                    let txtcolor   = 'white';
                    if (this.color == "white" || this.color == "#FFF" || this.color == "#FFFFFF") {
                        bgcolor = 'white';
                        txtcolor   = '#1679C2';
                    }

                    let elem = $('#'+this.prefix+'_buttonuidraw_container button.buttonuidraw');
                    if(typeof elem != 'undefined'){
                        elem.css({'background-color': bgcolor,
                                'color': txtcolor});
                    }
                }
            }

            SetSubtitleColor(color){
                this.subtitleColor = color;
                this.GetElemByExtension('subtitle').css('color',color);
                this.GetElemByExtension('subtitle').show();
            }

            SetMiniButton(val){
                this.bMiniButton = val;
                let elem = $('#'+this.prefix+'_buttonuidraw_container button.buttonuidraw');
                if(typeof elem != 'undefined'){
                    if(val){
                        elem.addClass('buttonuidraw_mini');
                    }else{
                        elem.removeClass('buttonuidraw_mini');
                    }
                }
            }
            

            SetId(id){
                this.id = id;
            }

            SetLabel(label){
                this.label = label;
                let elem = $('#'+this.prefix+'_buttonuidraw_container .buttonuidraw_label');
                if(typeof elem != 'undefined'){
                    elem.html(label);
                }
            }

            GetLabel(){
               return $('#'+this.prefix+'_buttonuidraw_container .buttonuidraw_label').html().trim();
            }

            Blur(){
                $('#'+this.prefix+'_buttonuidraw_button').blur();
            }

            Show(){
                $('#'+this.prefix+'_buttonuidraw_container').show();
            }

            Hide(){
                $('#'+this.prefix+'_buttonuidraw_container').hide();
            }

            Enable(){
                $('#'+this.prefix+'_buttonuidraw_button').removeAttr('disabled');
                $('#'+this.prefix+'_buttonuidraw_button').removeClass('uidraw_disabled');
            }

            Disable(){
                $('#'+this.prefix+'_buttonuidraw_button').attr('disabled', true);
                $('#'+this.prefix+'_buttonuidraw_button').addClass('uidraw_disabled');
            }

            StartActivityIndicator(dataid){
                let elem = $('#'+this.prefix+'_buttonuidraw_button');
                let act  = $('#'+this.prefix+'_buttonuidraw_activity');
                if(typeof dataid != 'undefined'){
                    elem = $('.buttonuidraw[data-id="'+dataid+'"]');
                    act = $(elem).siblings('.buttonuidraw_activity');
                }
                var height = $(elem).outerHeight();
                var width  = $(elem).outerWidth();
                elem.hide();
                $(act).css('width', width);
                $(act).css('height', height);
                $(act).show();
                $(act).css({
                    'height':height,
                    'width':width
                });
            }

            StopActivityIndicator(dataid){
                let elem = $('#'+this.prefix+'_buttonuidraw_button');
                let act  = $('#'+this.prefix+'_buttonuidraw_activity');
                if(typeof dataid != 'undefined'){
                    elem = $('.buttonuidraw[data-id="'+dataid+'"]');
                    act = $(elem).siblings('.buttonuidraw_activity');
                }

                $(act).hide();
                $(elem).show();
            }

            OnClick(e, elem){
                if(typeof e != 'undefined' && e != null){
                    e.stopPropagation();
                }
                if(this.callback != null && typeof this.callback != 'undefined'){
                    this.callback($(elem).attr('data-id'));
                }
            }

            SetFontSize(fontsize){
                this.fontsize = fontsize;
            }

            SetContainerWidth(width){
                let elem = $('#'+this.prefix+'_buttonuidraw_container');
                if(typeof elem != 'undefined'){
                    elem.css({'width': width});
                }
            }

            SetWidth(width){
                this.width = width;
                let elem = $('#'+this.prefix+'_buttonuidraw_button');
                if(typeof elem != 'undefined'){
                    elem.css({'width': width});
                }
            }

            SetSideIcon(val){
                let elem = this.GetElemByExtension('sideicon');
                if(typeof elem != 'undefined'){
                    elem.html(val);
                }
            }

            EnableSideIcon(bEnable){
                let elem = this.GetElemByExtension('sideicon');
                if(typeof elem != 'undefined'){
                    if (bEnable) {
                        elem.addClass('buttonuidraw_sideicon_active');
                        elem.removeClass('buttonuidraw_sideicon_hidden');
                    } else {
                        elem.removeClass('buttonuidraw_sideicon_active');
                        elem.addClass('buttonuidraw_sideicon_hidden');
                    }
                }
            }

            SetSideIconCSS(css){
                let elem = this.GetElemByExtension('sideicon');
                if (css) elem.css(css);
            }

            GetStartHTML() {
                var prefix = this.GetPrefix();
                var obj    = this.GetObjectName();
                var name   = this.GetClassNameLower();

                let colorstyle = "";
                let borderCase = "";
                if (this.borderOnly === null ) {
                    colorstyle = 'color:${this.color};';
                    borderCase = 'buttonuidraw_noborder';
                }else if(this.borderOnly === true){
                    colorstyle = `color:${this.color};border:1px solid ${this.color};`;
                    borderCase = "buttonuidraw_borderonly";
                }else{
                    colorstyle = `background-color:${this.color}; color:white;`;
                    if (this.color == "white" || this.color == "#FFF" || this.color == "#FFFFFF") {
                        colorstyle = "background-color:white; color:#1679C2;";
                    }
                    borderCase = "buttonuidraw_noborder";
                }

                let fontstyle = "";
                if (this.fontsize != "") {
                    fontstyle = `font-size:${this.fontsize};`;
                }

                this.tooltip.SetTargetId(this.prefix+'_buttonuidraw_container');
                let tooltip = this.tooltip.GetStartHTML();

                let mixedCase = "mymixed_case";
                if (!this.mixedCaseButton) {
                    mixedCase = "";
                }

                let displaystyle = "";
                if (this.bHidden) {
                    displaystyle = "display:none;";
                }

                let svg = '<svg style="fill:#555" width="20px" height="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring" style="background: none;"><circle cx="50" cy="50" ng-attr-r="{{config.radius}}" ng-attr-stroke-width="{{config.width}}" ng-attr-stroke="{{config.stroke}}" ng-attr-stroke-dasharray="{{config.dasharray}}" fill="none" stroke-linecap="round" r="40" stroke-width="4" stroke="#555" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(34.6018 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg>';

                let button = `
                <style>
                <link rel="stylesheet" href="{$absPath}src/EventPilot/php/express/common/material-web/mdc.button.min.css">
                </style>

                  <div style="${displaystyle}" class="buttonuidraw_container" id="${prefix}_${name}_container">
                    <div id="${this.prefix}_buttonuidraw_activity" class="buttonuidraw_activity">${svg}</div>
                    <button style="${colorstyle} ${fontstyle}" id="${this.prefix}_buttonuidraw_button" data-id="${this.id}" class="buttonuidraw ${borderCase} ${mixedCase} mdc-button mdc-button--raised" onclick="${obj}.OnClick(event, this);">
                        <div id="${this.prefix}_buttonuidraw_sideicon" class="buttonuidraw_sideicon_hidden"></div>
                      <span class="mdc-button__ripple"></span>
                      <div class="mdc-button__label buttonuidraw_label" id="${this.prefix}_label">${this.label}</div>
                    </button>
                    <div class="buttonuidraw_subtitle" id="${prefix}_${name}_subtitle">${this.subtitle}</div>
                  </div>
                  ${tooltip}`;

                let html = `
                  <!-- ButtonUIDraw -->
                  ${button}`;

                return html;
            }
        }
//# sourceURL=ButtonUIDraw.js
        </script>
        <!-- IFrame2UIDraw -->
        <style>
        .iframe2uidraw_container{
            border:none;
            background-color:white;
        }
        </style>
        <script>
		// **************************************************
		// IFrame2UIDraw - JS Class
		class IFrame2UIDraw extends UIDraw{
            constructor(obj){
                super(obj);

                this.initSrc         = null;
                this.src             = null;
                this.hideCallback    = null
                this.messageCallback = null;
                this.width           = '100%';
                this.height          = '100%';
                this.hideTS          = 0;
                this.confid          = 'AIAAASCEND24';
                this.label           = '';

                this.scrollPosition = 0;

                // https://stackoverflow.com/questions/33859113/javascript-removeeventlistener-not-working-inside-a-class
                // https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener
                this.func = function(e){this.EventReceived(e);}
                this.funcHandler = this.func.bind(this);
            }                Setup(src, hideCallback, messageCallback, width, height){
                var local = this;

                if(width != null && typeof width !== 'undefined'){
                    this.width = width;
                }
                if(height != null && typeof height !== 'undefined'){
                    this.height = height;
                }

                if(src != null && typeof src !== 'undefined' && src != ''){
                    this.initSrc = src;
                    this.src     = src;
                    this.GetContainer().attr('src', src);
                }
                if(hideCallback != null && typeof hideCallback !== 'undefined'){
                    this.hideCallback = hideCallback;
                }
                if(messageCallback != null && typeof messageCallback !== 'undefined'){
                    this.messageCallback = messageCallback;               
                }
                if(typeof this.label != 'undefined' && this.label != ''){
                    this.GetContainer().attr('aria-label', this.label);
                }
            }

            SetLabel(label){
                this.label = label;
                this.GetContainer().attr('aria-label', label);
            }

            HandleReceived(e){
                var local = this;
            }

            EventReceived(e){
                var local = this;

                try{
                    let json = JSON.parse(e.data);
                    if(typeof json != 'undefined'){
                        if(local.messageCallback != null && typeof local.messageCallback !== 'undefined'){
                            local.messageCallback(json.action, json.eptable, json.type, json.tid, json.data);
                        }
                    }
                }catch(e){
                    // Invalid JSON parse
                }
            }

            StartListening(){
                var local = this;

                if(this.messageCallback != null){
                    // ******************************************************
                    // I-Frame Messaging
                    // Listen to message from child window		
                    var wp_eventMethod  = window.addEventListener ? "addEventListener" : "attachEvent";
                    var wp_eventer      = window[wp_eventMethod];
                    var wp_messageEvent = wp_eventMethod == "attachEvent" ? "onmessage" : "message";
                    wp_eventer(wp_messageEvent, this.funcHandler, false);
                }
            }

            StopListening(){
                if(this.messageCallback != null){
                    window.removeEventListener('message', this.funcHandler);
                }
            }

            GetSrc(){
                return this.src;
            }

            Disable(){
                this.StopListening();

                this.GetContainer().css("opacity", "0.2");
                this.GetContainer().css("pointer-events", "none");
            }

            Enable(){
                this.StartListening();

                this.GetContainer().css("opacity", "1");
                this.GetContainer().css("pointer-events", "auto");
            }

            Reveal(){
                this.StartListening();

                this.GetContainer().show();
                this.GetContainer().css({'display':'flex'});

                let frameElement = this.GetFrameElement().contentWindow;

                let loginstatechange =  SessionStoreGetItem(this.confid, 'loginstatechange');
                if (typeof frameElement != 'undefined' && frameElement != null) {
                    if(loginstatechange != null){
                        loginstatechange = JSON.parse(loginstatechange);
                        if(typeof loginstatechange.ts != 'undefined' && loginstatechange.ts > this.hideTS){
                            frameElement.location.reload();
                            return;
                        }
                    } 
                
                    if(typeof frameElement.epView != 'undefined'){
                        frameElement.epView.OnResume();
                    }
                }
            }

            Show(src, noReload){
                this.StartListening();

                if(typeof src != 'undefined'){
                    if(noReload != null && typeof noReload !== 'undefined' && noReload){
                        if(this.src != src){
                            this.src     = src;
                            this.GetContainer().attr('src', src);
                        }
                    }else{
                        this.src     = src;
                        this.GetContainer().attr('src', src);
                    }
                }

                let container = this.GetContainer();
                container.show();
                container.contents().scrollTop(this.scrollPosition);

                let frameElement = this.GetFrameElement().contentWindow;
                if (typeof frameElement != 'undefined' && frameElement != null) {
                    if(typeof frameElement.epView != 'undefined'){
                        frameElement.epView.OnResume();
                    }
                }
            }
            Hide(){
                this.StopListening();
                this.hideTS = new Date().getTime();
                
                let container = this.GetContainer();
                this.scrollPosition = container.contents().scrollTop();
                container.hide();
                if(this.hideCallback != null && this.hideCallback !== 'undefined'){
                    this.hideCallback();
                }

                let frameElement = this.GetFrameElement().contentWindow;
                if (typeof frameElement != 'undefined' && frameElement != null) {
                    if(typeof frameElement.epView != 'undefined'){
                        frameElement.epView.OnPause();
                    }
                }
            }
            Clear(){
                this.GetContainer().attr('src', '');
            }

            // Override base class function Remove
            Remove(){
                this.StopListening();

                this.GetContainer().remove();
            }

            Send(action, eptable, type, tid, data){
               // console.log("IFrame2UIDraw::Send("+action+", "+eptable+", "+type+", "+tid+", "+data+")");
                if(action == 'open' && IsExternalUrl(data)){
                    window.open(data, '_blank');
                }else{
                    SendParentPostMessage(action, eptable, type, tid, data);
                }
            }

            HasParent(){
                if(window.frameElement != null){
                    return true;
                }
                return false;
            }

            GetParentFrameInfo(){
                if(window.frameElement != null){
                    let info = window.frameElement.getAttribute('data-info');
                    if(typeof info != 'undefined' && info != ''){
                        return atob(info);
                    }
                }
                return '';
            }

            GetStartHTML(){
                let id = this.prefix + '_iframe2uidraw_container';

                let html = `
                <iframe class="iframe2uidraw_container" id="${id}" data-info="" src="" width='${this.width}' height='${this.height}'>
                    <p>Your browser does not support iframes.</p>
                </iframe>
                `;

                return html;
            }

            GetFrameElement(){
                return document.getElementById(this.prefix + '_iframe2uidraw_container');
            }
        }
//# sourceURL=IFrame2UIDraw.js
        </script>
            <!-- EPWebBackDraw -->
            <style>
                .epwebbackdraw{
                    margin-right:10px;
                }
                .epwebbackdraw button{
                    padding:3px 12px;
                }
            </style>
            <script>
                // **************************************************
                // EPWebBackDraw - JS Class
                class EPWebBackDraw extends UIDraw{

                    constructor(objname){
                        super(objname);
                        this.backButton = new ButtonUIDraw(objname+'.backButton');

                        this.frame = new IFrame2UIDraw(this.objname+'.frame');
                        
                        
                        this.touchstartX = 0;
                        this.touchendX = 0;
                        this.touchstartY = 0;
                        this.touchendY = 0;
                        this.xTolerance = 200;
                        this.yTolerance = 75;

                        this.swipeBackDisabled = false;
                        
                    }

                    Setup(callback){
                        var local = this;
                        var frameID = "none";

                        let baseurl = 'https://eppro02.ativ.me/';
                        let formdata = {'interface':'websettings', 'action':'getdefine', 'define':'BANNER_COLOR'};
                        EPPost(baseurl+'web/api.php', formdata, function(success, msg, data){
                            console.log(data);
                            if(success){
                                let json = JSON.parse(data);
                                // Fetching json[1] because websettings returns json[0] as the define name, and json[1] as the value
                                let color = '#'+json[1].replace('#', '');
                                local.SetColor(color);
                            } else {
                                local.SetColor('#1a80b6');
                            }
                        });

                        document.addEventListener('touchstart', e => {
                            local.touchstartX = e.changedTouches[0].screenX
                            local.touchstartY = e.changedTouches[0].screenY
                        })
                        
                        document.addEventListener('touchend', e => {
                            local.touchendX = e.changedTouches[0].screenX
                            local.touchendY = e.changedTouches[0].screenY
                            local.CheckDirection()
                        })

                        if(window.self != window.top){
                            if(window.frameElement !== null){
                                frameID = window.frameElement.id;
                                var loc = window.location.href;
                                var lastloc = '';
                                if(typeof window.frameElement.eplocations == 'undefined'){
                                    window.frameElement.eplocations = [];
                                } else {
                                    lastloc = window.frameElement.eplocations[window.frameElement.eplocations.length - 1];
                                }
                                let nohistory = $('#'+this.prefix+'_epwebbackdraw').attr('data-nohistory');

                                if(loc != lastloc && nohistory != 'true'){
                                    // only add this location to our history list if it is different than that last history item
                                    window.frameElement.eplocations.push(window.location.href);
                                }
                                local.HandleVisibility();
                            }
                        }

                        this.backButton.Setup(function(){
                            local.HistoryBack();
                        });
                    }

                    SetSwipeBackDisabled(disabled){
                        this.swipeBackDisabled = disabled;
                    }

                    HistoryBack(){
                        var local = this;

                        if((window.frameElement != null) && (window.frameElement.eplocations != null) && (window.frameElement.eplocations.length > 1)){
                            window.frameElement.eplocations.pop();
                            window.location.replace(window.frameElement.eplocations[window.frameElement.eplocations.length - 1]);
                        }else{
                            let action  = 'close';
                            let eptable = '';
                            let type    = '';
                            let tid     = '';
                            let data    = '';
                            local.frame.Send(action, eptable, type, tid, data);
                        }
                    }

                    HandleVisibility(){
                        //If we are not on the bottom frame then we don't want to hide the back button
                        let info = window.frameElement.dataset.info;
                        if(typeof info != 'undefined' && info != ''){
                            info = JSON.parse(atob(info));
                            if(info.idx > 0){
                                this.backButton.Show();
                                return true;
                            }
                        }

                        var loc = window.location.href;
                        var lastloc = window.frameElement.eplocations[window.frameElement.eplocations.length - 1];
                        if(window.frameElement.eplocations.length == 0){
                            this.backButton.Hide();
                        } else if (window.frameElement.eplocations.length == 1 && loc == lastloc){
                            this.backButton.Hide();
                        } else {
                            this.backButton.Show();
                        }
                    }

                    SetColor(color){
                        this.backButton.SetColor(color);
                    }

                    CheckDirection() {
                        if(this.swipeBackDisabled){
                            return;
                        }
                        let travelX = this.touchendX - this.touchstartX;
                        let travelY = Math.abs(this.touchendY - this.touchstartY);
                        // If the touch started on the left of the screen, 
                        // The touch start and touch end y positions are within yTolerance of each other,
                        // and the travel is greater than the xTolerance, this is a swipe. 
                        // Go back to the previous page.
                        if (this.touchstartX < 100 && travelY < this.yTolerance && travelX > this.xTolerance){
                            this.HistoryBack();
                        }
                    }
                }
//# sourceURL=EPWebBackDraw.js
            </script>
            <!-- EPWebHeaderDraw -->
            <style>
            </style>
            <script>
            // **************************************************
            // EPWebHeaderDraw - JS Class
            class EPWebHeaderDraw extends WebHeaderUIDraw{
                constructor(obj){
                    super(obj);

                    this.callback = null;
                    this.epBackButton = new EPWebBackDraw(this.objname+'.epBackButton');
                }

                Setup(callback){
                    super.Setup(callback)
                    this.epBackButton.Setup();

                    // static SetupHeader(obj, header_ext)
                    UIDraw.SetupHeader(this, 'content');
                }
                GoBack(){
                    this.epBackButton.HistoryBack();
                }

                SetSwipeBackDisabled(disabled){
                    this.epBackButton.SetSwipeBackDisabled(disabled);
                }
                    
            }
//# sourceURL=EPWebHeaderDraw.js
        </script>		<link rel="stylesheet" type="text/css" href="page_data_003/web_base.css">
		<link rel="stylesheet" type="text/css" href="page_data_003/web_agenda.css">
		<script>
			// Force caching on ajax requests
			jQuery.ajaxSetup({ cache: true });
		</script>

		<style>
		.base_bannercolor{background-color:#f7f7f7 !important;background:#f7f7f7 !important;}
		.bannercolor{background-color:#003A70 !important; } /*Overrides the default background color, used to change color of header or category separator bars. */
		.greycolor{background-color:#f7f7f7 !important; color:rgb(128,128,128) !important;}
		.headerbanner.bannercolor{background:#003A70 !important; }
		.text_bannercolor{color:#003A70 !important;}
		#proof_banner{
			position:absolute;
			left:calc(50% - 40px);
			top:5px;
			width:80px;
			font-weight:bold;
			border:1px solid #CCC;
			border-radius:10px;
			color:#777;
			background-color:#FFF;
			height:15px;
			line-height:15px;
			font-size:0.7em;
			letter-spacing:1px;
			text-align:center;
			z-index:100;
			pointer-events:none;
		}
		/*this color override needs to be included here to have access to bannercolor*/

		.date_buttonpressed .ui-btn-text {color:#003A70 !important;}
		</style>
        <script src="page_data_003/EPUtility_002.js" type="text/javascript"></script>

		            <script>
                RequireOnce('https://eppro02.ativ.me//src/EventPilot/php/express/common/EPViewInterface.js?v=21');
                var epView = EPViewInterface.GetInstance();
            </script><script type="text/javascript" src="EPViewInterface.js">		<script>
            RequireOnce('https://eppro02.ativ.me//src/EventPilot/php/express/common/EPConnectInterface.js?v=21');
			var epConnect = new EPConnectInterface();
        </script><script type="text/javascript" src="page_data_003/EPConnectInterface_002.js">		<script>
            RequireOnce('https://eppro02.ativ.me//src/EventPilot/php/express/common/EPFeedInterface2.js?v=21');
            var epFeed = new EPFeedInterface();
        </script><script type="text/javascript" src="page_data_003/EPFeedInterface2.js">		<script>
            RequireOnce('https://eppro02.ativ.me//src/EventPilot/php/express/common/EPDefinesInterface.js?v=21');
			var epDefine = new EPDefinesInterface();
        </script><script type="text/javascript" src="page_data_003/EPDefinesInterface.js">		<script>
            RequireOnce('https://eppro02.ativ.me//src/EventPilot/php/express/common/EPTableInterface.js?v=21');
			var epTable = new EPTableInterface();
        </script><script type="text/javascript" src="page_data_003/EPTableInterface_002.js">		<script>
            RequireOnce('https://eppro02.ativ.me//src/EventPilot/php/express/common/EPSystemInterface.js?v=21');
			var epSystem = new EPSystemInterface();
        </script><script type="text/javascript" src="page_data_003/EPSystemInterface.js">		<script>
            RequireOnce('https://eppro02.ativ.me//src/EventPilot/php/express/common/EPWebAuthInterface.js?v=21');
			var epWebAuth = new EPWebAuthInterface();
        </script><script type="text/javascript" src="page_data_003/EPWebAuthInterface.js">
		<!-- <link rel="stylesheet" href="css/filters_drawer.css?v=21" /> -->
		<link rel="stylesheet" type="text/css" href="page_data_003/web_session.css">
		<link rel="stylesheet" type="text/css" href="page_data_003/web_exhibitor.css">
		<link rel="stylesheet" type="text/css" href="page_data_003/web_person.css">

		<script src="page_data_003/EPEventInterface.js"></script>
		<script>
			var epEvent = null;
			$(document).ready(function(){
				epEvent = new EPEventInterface();
			});
		</script>

        <!-- getmdl -->
        <style>
            @font-face {
                font-family: 'Material Icons Outlined';
                font-style: normal;
                font-weight: 100 700;
                src: url('https://eppro02.ativ.me/doc/Fonts/MaterialDesignOutline.woff2') format('woff2');
            }
            .material-symbols-outlined {
                font-family: 'Material Icons Outlined';
                font-weight: normal;
                font-style: normal;
                font-size: 24px;
                line-height: 1;
                letter-spacing: normal;
                text-transform: none;
                display: inline-block;
                white-space: nowrap;
                word-wrap: normal;
                direction: ltr;
                -webkit-font-feature-settings: 'liga';
                -webkit-font-smoothing: antialiased;
            }
            @font-face {
                font-family: 'Material Icons';
                font-style: normal;
                font-weight: 200;
                src: url('https://eppro02.ativ.me/doc/Fonts/MaterialDesign.woff2') format('woff2');
            }
            .material-icons {
                font-family: 'Material Icons Outlined';
                font-weight: normal;
                font-style: normal;
                font-size: 24px;
                line-height: 1;
                letter-spacing: normal;
                text-transform: none;
                display: inline-block;
                white-space: nowrap;
                word-wrap: normal;
                direction: ltr;
                -webkit-font-feature-settings: 'liga';
                -webkit-font-smoothing: antialiased;
            }
        </style>
        <link href="page_data_002/fontawesome.min.css" rel="stylesheet">
        <link href="page_data_002/sharp-thin.css" rel="stylesheet">

        <link rel="stylesheet" href="page_data_002/material.min.css">
        <script defer="defer" src="page_data_002/material.min.js"></script>
        <!-- material-components-web -->

        <script defer="defer" src="page_data_002/material-components-web.min.js"></script>
        <!--getmdl-select-->
        <link rel="stylesheet" href="page_data_002/getmdl-select.min.css">
        <script defer="defer" src="page_data_002/getmdl-select.min.js"></script>
        <!--dialog-polyfill-->
        <link rel="stylesheet" href="page_data_002/dialog-polyfill.css">
        <script defer="defer" src="page_data_002/dialog-polyfill.js"></script>        		<script>
            if(window.self !== window.top){
                // prevent an index.php page from being loaded in an index.php page
                if(window.parent.location.href.indexOf("web/index.php?") > -1) {
                    if(window.location.href.indexOf("web/index.php?") > -1) {
                        let redirect = window.location.href.replace("web/index.php?", "web/page.php?");
                        location.replace(redirect)
                    }
                }
            }
		var os = "web";

		$('a').click(function(e){
			e.stopPropagation();
		});

                //listen for link click events at the document level
        if (document.addEventListener) {
            document.addEventListener('click', interceptClickEvent);
        } else if (document.attachEvent) {
            document.attachEvent('onclick', interceptClickEvent);
        }
        // Open href links in new tab
        function interceptClickEvent(e) {
            var href;
            var target = e.target || e.srcElement;
            if (target.tagName !== 'a') target = target.closest('a');
            if (target != null && typeof target.tagName != 'undefined' && target.tagName === 'A') {
                url = target.getAttribute('href');
                if(url == null) {return}

                if(IsExternalUrl(url) || url.startsWith("mailto:")){
                    target.target = '_blank';
                    return;
                } else {
                    e.preventDefault();
                    
                    // Check if we have an epView interface w/ OpenDialog function
                    if(typeof epView !== 'undefined' && typeof epView.OpenDialog !== 'undefined'){
                        if(typeof params == 'undefined'){
                            params = {};
                        }
                        var target = e.target.target;
                        params['target'] = target;
                        if(typeof confid != 'undefined'){
                            params['confid'] = confid;
                        }
                        
                        epView.OpenDialog(url, params);
                        return;
                    }
                }
                window.location.replace(url);
            }
            
        };
        
		// When ready...
		window.addEventListener("load",function() {
			// Set a timeout...
			setTimeout(function(){
				// Hide the address bar!
				window.scrollTo(0, 1);
			}, 0);
		});

		//make a global "table" & "project" var for all JS functions to use: 
		var table = 'agenda';var project = 'AIAAASCEND24';
		function resize_img_width(img, setWidth){
	        var width  = $(img).width();    // Current image width
	        var height = $(img).height();  // Current image height
			//alert("w,h " + width + "," + height);
			if(width >= height){
				var newHeight = (height*setWidth)/width;
				//alert("width x height " + width + "x" + height + " new height: " + newHeight);
	            $(img).css("width", setWidth); // Set new width
	            $(img).css("height", newHeight);  // Scale height based on ratio
			}
		}
		
        if(window.frameElement != null && typeof window.frameElement.eplocations == 'undefined'){
            window.frameElement.eplocations = [];
        } else {
            if(window.frameElement != null && window.frameElement.eplocations.length > 0){
                if (window.location.href == window.frameElement.eplocations[window.frameElement.eplocations.length - 1]){
                    // We are currently on this location. Remove it from the history tracking
                    window.frameElement.eplocations.pop();
                }
            }
        }

        
		$(window).on('pageshow', function(){

			if($('#proof_banner').length < 1){
				$('#custom_home_header').prepend(GetProofBanner());
			}

			//If we are logged in, Try to count the session
							AppCount('web');
					});

		function GetProofBanner(){
			var str = "";
			
			return str;
		}

		function getURLParameter(name) {
		    return decodeURI(
		        (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
		    );
		}

        function AddRemoveCredit(event, id, item, tableName){
			event.stopPropagation();
			event.preventDefault();
               $.post('user.php?webapi=true&action=addremovecredit', {'sessionid':id}, function(res){
                   if($(res).find('Item').attr('success') == 'true'){
                       var src = item.attr('src');
					   var prevState = 'not_credit';
                       if( src == '../doc/common/images/ep_cmeon@2x.png'){
                           item.attr('src', '../doc/common/images/ep_cme@2x.png');
						   prevState = 'credit';
                       }
                       if(src == '../doc/common/images/ep_cme@2x.png'){
                           item.attr('src', '../doc/common/images/ep_cmeon@2x.png');
                       }

					   	// Pass function call to parent sending added value
						if(self!=top){
							parent.postMessage({'msg':'ToggleQuickAddIcons', 'prevState':prevState, 'type':'credit', 'id':id},"*");  //  `*` on any domain
						}
                   }else{
                       alert($(res).find('Item').attr('message'));
                   }
               }, 'XML');
        }


        function AddRemoveSession(event, id, item, tableName){
				event.stopPropagation();
				event.preventDefault();
             	$.post('user.php?webapi=true&action=addremovesession', {'sessionid':id}, function(res){
                 	if($(res).find('Item').attr('success') == 'true'){
						var src = item.attr('src');
						var sessionAdded = false;
						if( src == '../doc/common/images/ep_removefromschedule@2x.png'){
							item.attr('src', '../doc/common/images/ep_addtoschedule@2x.png');
							//set 'added' value
							sessionAdded = false;
						}
						if(src == '../doc/common/images/ep_addtoschedule@2x.png'){
							item.attr('src', '../doc/common/images/ep_removefromschedule@2x.png');
							sessionAdded = true;
						}
						// Pass function call to parent sending added value
						if(self!=top){
							try {
								parent.SessionAdded(sessionAdded, id);
							}catch(err) {
								//console.log("SessionAdded() is not defined in the parent iframe.");
							}
						}
					}else{
						alert($(res).find('Item').attr('message'));
					}
             	}, 'XML');
        }

        function AddRemoveStar(event, id, item, tableName){
			event.stopPropagation();
			event.preventDefault();
               $.post('user.php?webapi=true&action=addremovestar', {'id':id, 'table':tableName}, function(res){
                  if($(res).find('Item').attr('success') == 'true'){
                      var src = item.attr('src');
					  var prevState = "not_like";
                      if( src == '../doc/common/images/ep_likeon@2x.png'){
                          item.attr('src', '../doc/common/images/ep_like@2x.png');
						  prevState = "like";
                      }
                      if(src == '../doc/common/images/ep_like@2x.png'){
                          item.attr('src', '../doc/common/images/ep_likeon@2x.png');
                      }
				   	// Pass function call to parent sending added value
					if(self!=top){
						try {

							parent.postMessage({'msg':'ToggleQuickAddIcons', 'prevState':prevState, 'type':'like', 'id':id},"*");  //  `*` on any domain

						}
						catch(err) {
					        //console.log(err);
					    }
					}
                  }
                  else{
                      alert($(res).find('Item').attr('message'));
                  }
              }, 'XML');
        }


		var note = '', hash = '';
		var noteCallback = null;
		function ShowNotePad(table, id, callback){
							note = '';
				hash = '';
				noteCallback = callback;
		   $.post('user.php?webapi=true&action=fetchnote', {'table':table, 'id':id}, function(response){
				var success     = new Array(1);
				var responseMsg = new Array(1);
				var data        = new Array(1);
				if(ReadResponseXML(response, success, responseMsg, data)){
					if(responseMsg == 'newnote'){
						note = '';
					} else {
						if(isNoteFormatCorrect(data[0])){
							noteObj = GetNoteAndHashFromFormat(data[0]);
							hash = noteObj['hash'];
							note = noteObj['note'];
						} else {
							note = data[0];
						}
					}

					$('#notepad-contianer').find('textarea').val(note);
					$('#notepad').attr('data-table', table);
					$('#notepad').attr('data-id', id);

					$('#notepad-contianer').show();
					$('#notepad-contianer').find('textarea').focus()
					//console.log(responseMsg[0]);
				}else{
					console.log("Failed to fetch note: error 43521");
				}
		   });
			
		}

		function SubmitNote(){
						var newnote	= $('#notepad-contianer').find('textarea').val();
			if(newnote != note){
				var table 	= $('#notepad').attr('data-table');
				var id		= $('#notepad').attr('data-id');

				var hashedNote = hash+newnote
			   $.post('user.php?webapi=true&action=updatenote', {'table':table, 'id':id, 'note':hashedNote}, function(response){
					var success     = new Array(1);
					var responseMsg = new Array(1);
					var data        = new Array(1);
					if(ReadResponseXML(response, success, responseMsg, data)){
						if(success){
							if(noteCallback != null && typeof noteCallback != 'undefined'){
								noteCallback(newnote);
							}
							var noteAdded = false
							if(responseMsg[0] == 'delete'){
								EPConfirm('Alert', 'Delete Note?', function(confirm){
									if(confirm){
										DeleteNote(table, id);
									}
								});
							}
							if(data[0].length > 0){
								noteAdded = true;
								$('.upnotebutton[data-id='+id+']').attr('src', '../doc/common/images/ep_notes_sel@2x.png');
							} else {
								noteAdded = false;
								$('.upnotebutton[data-id='+id+']').attr('src', '../doc/common/images/ep_compose_sel@2x.png');
							}

							// Pass function call to parent sending added value
							if(self!=top){
								try {
									parent.NoteAdded(table, noteAdded, id);
								}
								catch(err) {
							        //console.log("NoteAdded() is not defined in the parent iframe.");
							    }
							}
							// Reload to refresh icons

						}
					}else{
						console.log("Failed to fetch note: error 43521");
					}
			   });
			}
						$('#notepad-contianer').hide();
		}

		function DeleteNote(table, id){
			$.post('user.php?webapi=true&action=deletenote', {'table':table, 'id':id}, function(response){
					var success     = new Array(1);
					var responseMsg = new Array(1);
					var data        = new Array(1);
					if(ReadResponseXML(response, success, responseMsg, data)){
						if(responseMsg[0] == 'removed'){
							$('.upnotebutton[data-id='+id+']').attr('src', '../doc/common/images/ep_compose_sel@2x.png');
						} else {
							$('.upnotebutton[data-id='+id+']').attr('src', '../doc/common/images/ep_notes_sel@2x.png');
						}
						//console.log(responseMsg[0]);
					}else{
						console.log("Failed to fetch note: error 43521");
					}
		       });
		}

		function AppCount(id){
			//Only attempt to count if app is not in iframe
			if(window.self == window.top){
				var appCount = sessionStorage.getItem("web_appCount");
				// Only count session if the session variable doesn't exist
				if(appCount == null){
	           		$.post('user.php?webapi=true&action=appcount', {'id':id}, function(response){
						var success     = new Array(1);
						var responseMsg = new Array(1);
						var data        = new Array(1);
						if(ReadResponseXML(response, success, responseMsg, data)){
							sessionStorage.setItem("web_appCount", 'true');
						}else{
							console.log("appcount failure");
						}
		           });
				}
			}
        }

        function Viewed(table, id){
			           $.post('user.php?webapi=true&action=viewed', {'table':table, 'id':id}, function(response){
				var success     = new Array(1);
				var responseMsg = new Array(1);
				var data        = new Array(1);
				if(ReadResponseXML(response, success, responseMsg, data)){
					//console.log("viewed success");
				}else{
					console.log("viewed failure");
				}
           });
			        }

        function Clicked(table, id, url){
			           $.post('user.php?webapi=true&action=clicked', {'table':table, 'id':id}, function(response){
				var success     = new Array(1);
				var responseMsg = new Array(1);
				var data        = new Array(1);
				if(ReadResponseXML(response, success, responseMsg, data)){
					//console.log("clicked success");
				}else{
					console.log("clicked failure");
				}

           });
           if(url != ''){
                if(url.search('http') != -1){
                    setTimeout(function(){window.open(url);},300);
                } else {
                    setTimeout(function(){window.location.replace(url);},300);
                }
            }
			        }

            function print_call_stack() {
                var stack = new Error().stack;
                console.log("PRINTING CALL STACK");
                console.log( stack );
            }
		

			var getUrlParameter = function getUrlParameter(sParam) {
			    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
			        sURLVariables = sPageURL.split('&'),
			        sParameterName,
			        i;

			    for (i = 0; i < sURLVariables.length; i++) {
			        sParameterName = sURLVariables[i].split('=');

			        if (sParameterName[0] === sParam) {
			            return sParameterName[1] === undefined ? true : sParameterName[1];
			        }
			    }
			};

			function Login(){
                var plannerSession = getURLParameter('plannersession');
                if(plannerSession != 'true'){
                    epView.OpenDialog("page.php?page=Login&project=AIAAASCEND24&url=https%3A%2F%2Feppro02.ativ.me%2Fweb%2Fpage.php%3Fpage%3DSession%26project%3DAIAAASCEND24%26id%3D491255&error=error_logintoaccess&nohistory=true")                }else{
                    if(self!=top){
                        parent.postMessage("Login","*");  //  `*` on any domainoplann
                    }
                }
			}

			function OpenPrivateChat(userid, firstname, lastname){
				// firstname and lastname are base64 encoded
				let append = '';
				if(typeof firstname != 'undefined' && typeof lastname != 'undefined'){
					append = "|FIRST="+firstname.replaceAll('=', '')+"|LAST="+lastname.replaceAll('=', '');
				}
				window.location.replace("page.php?page=CustomIntHtml&project="+project+"&id=privatechat&url=urn:eventpilot:all:custom:data-id:view=privatechat|CHATID=|USERID="+userid+append);
			}
		//# sourceURL=BaseWeb.js
		</script>
	  <script type="text/javascript" src="page_data_002/EPFormatWebInterfaceFactory.js"><script type="text/javascript" src="page_data_002/EPFormat.js"><script type="text/javascript" src="page_data_002/EPFormatWebEPConnectInterface.js"><script type="text/javascript" async="" src="page_data/taas"></script></head>
	            <body>
                        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5GNBKD"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) --><main style="height:100%">
			<div id="notepad-contianer">
				<div id="notepad">
					<span id="text">Enter Note</span>
					<span id="button" tabindex="0" onkeyup="event.keyCode == 13 ? $(this).click() : '';" onclick="SubmitNote()">Done</span>
					<div style="clear:both"></div>
					<textarea></textarea>
				</div>
			</div>
			<div id="disabling_div" onclick="DisablingDivClick(event)"></div>
		
                <!-- EPCellDrawFactory -->
                <style>
                    /* Add any styles needed by the draw */
                </style>
                <script>
                    // **************************************************
                    // EPCellDrawFactory - JS Class
                    class EPCellDrawFactory extends Draw{
                        constructor(obj){
                            super(obj);
                        }

                        Setup(){
                            var local = this;
                        }

                        static Create(name, obj='') {
                            let draw;

                            switch (name) {
                              case 'agenda':
                                draw = new SessionCellDraw(obj);
                                break;
                              case 'speakers':
                                draw = new SpeakerCellDraw(obj);
                                break;
                              case 'members':
                                draw = new MemberCellDraw(obj);
                                break;
                              case 'exhibitors':
                                draw = new ExhibitorCellDraw(obj);
                                break;
                              case 'ad':
                                draw = new MediaAdCellDraw(obj);
                                break;
                              case 'alert':
                                draw = new MediaAlertCellDraw(obj);
                                break;
                              case 'html':
                              case 'cache/html':
                              case 'ext/html':
                              case 'sso/html':
                                draw = new MediaHtmlCellDraw(obj);
                                break;
                              case 'int/html':
                                draw = new MediaIntHtmlCellDraw(obj);
                                break;
                              case 'mp4':
                              case 'pdf':
                                draw = new MediaPdfCellDraw(obj);
                                break;
                              case 'xpub':
                                draw = new MediaXpubCellDraw(obj);
                                break;
                              default:
                                break;
                            }

                            return draw;
                        }
                    }
    //# sourceURL=EPCellDrawFactory.js
                </script>
            <!-- CellUIDraw -->
            <style>
                .celluidraw_container{
                    border:0px;
                    background:#ffffff; 
                    box-sizing: border-box;
                    position:relative;
                }

                /*
                .celluidraw_container:not(:first-child){
                    border-top:thin solid #ededed;
                }
                */
                .celluidraw_container:hover{
                    background-color:#f5f5f5f5
                }
                .celluidraw_container a{
                    padding:0;
                    display:flex;
                    position:relative;
                    color:#555;
                    font-size:12px;
                    font-weight:300;
                    text-decoration:none;
                }
                .celluidraw_container .cell_info{
                    display:flex;
                    flex-direction:column;
                    margin: 5px 10px;;
                    margin-right:60px;
                    height: 70px;
                    justify-content:space-around;
                    flex-grow:1;
                    min-width:0;
                }
                .celluidraw_container .cell_info h1{
                    font-size:16px;
                    line-height:1.3;
                    font-weight:500;
                    margin:0;
                    height:40px;
                    overflow:hidden;
                }
                .celluidraw_container .cell_icon{
                    margin:5px 10px; 
                    margin-right:0px;
                    height:70px;
                    width:70px;
                    object-fit: cover;
                    border-radius:2px;
                    flex-shrink:0;
                }
                
                .list_cell_title_popup{
                    pointer-events:none;
                    font-size:14px;
                    font-weight: 400;
                    white-space:normal;
                    z-index: 1000;
                    padding: 10px;
                    background-color: #FEFEFE;
                    border: 1px solid rgba(0,0,0,.5);
                    border-radius: 5px;
                    -moz-box-shadow: 4 4 8px rgba(0,0,0,.5);
                    -webkit-box-shadow: 4 4px 8px rgba(0,0,0,.5);
                    box-shadow: 4px 4px 8px rgba(0,0,0,.5);
                    position:absolute;
                    top:3px;
                    left:25px;
                    margin-right:55px;
                }
            
            </style>
            <script>
                // **************************************************
                // CellUIDraw - JS Class

                class CellUIDraw extends UIDraw{

                    constructor(objname){
                        super(objname);
                        this.popupTime = null;
                    }

                    Setup(){
                        var local = this;
                    }

                    ShowCellPopup(el){
                        var titlePadding = 10;
                        // If there is overflow of the title
                        // Start a timer to display the title popup

                        let spanHeight = $(el).find('.list_cell_title span').height();
                        if(spanHeight > 40){
                            this.popupTime = setTimeout(function(){
                                var title = $(el).find('.list_cell_title > span').text();
                                var popupHTML = '<div class="list_cell_title_popup">' + title + '</div>';
                                $(el).prepend(popupHTML);
                            }, 1000);
                        }
                    }
                    HideCellPopup(el){
                        clearTimeout(this.popupTime);
                        $('.list_cell_title_popup').remove();
                    }

                }
//# sourceURL=CellUIDraw.js
            </script>
            <!-- QuickaddButtonDraw -->
            <style>
            .quickadd{
                cursor:pointer;
                width:15px;
                height:15px;
                margin-right:5px;
                opacity:.9;
                background-size:contain;
                background-repeat: no-repeat;
                border: 0;
                background-color: transparent;
            }

            </style>
            <script>
                // **************************************************
                // QuickaddButtonDraw - JS Class
                class QuickaddButtonDraw extends UIDraw{
                    constructor(obj){
                        super(obj);
                        this.table = null;
                        this.tid = null;
                        this.callback = null;
                        RequireOnce('https://eppro02.ativ.me/common/EPFormat/js/EPFormatWebInterfaceFactory.js');
                        this.epConnect = WebInterfaceFactory.Create('epconnect', 'https://eppro02.ativ.me/');
                    }

                    Setup(table, tid, callback){
                        var local = this;
                        this.table = table;
                        this.tid = tid;

                        this.callback = callback;
                    }

                    OnClick(ev){
                        var local = this;
                        this.callback(ev, this.tid, this.table);
                    }

                    Login(){
                        if(typeof epConnect != 'undefined'){
                            epConnect.Login();
                        } else {
                            Login();
                        }
                    }

                    RefreshButton(){
                        var local = this;
                        this.epConnect._GetQuickaddState(this.table, this.tid, this.type, function(success, msg, data){
                            var json = JSON.parse(data);
                            var updata = json['data'];
                            var btn = local.GetButtonHtml(updata);
                            
                            local.SetContent(btn)
                            return;
                            
                        });
                    }

                    GetButtonHtml(updata) {
                        var local = this;
                        var onclickStmt = '';
                        var classstr = local.type;
                        if (updata && updata.loggedin === 'true') {
                            onclickStmt = 'onclick="'+local.objname+'.OnClick(event)"';

                            if (updata['state'] !== 'exists') {
                                classstr = 'not_'+local.type;
                            }
                        } else {
                            onclickStmt = 'onclick="event.stopPropagation(); event.preventDefault(); '+local.objname+'.Login()"';
                            classstr = 'not_'+local.type;
                        }

                        if (local.type === 'note') {
                            onclickStmt = 'disabled';
                        }

                        var html = '<button aria-label="Add or remove '+local.type+'" class="quickadd_'+classstr+' quickadd" data-id="'+local.tid+'" '+onclickStmt+'></button>';

                        return html;
                    }
                }
//# sourceURL=QuickaddButtonDraw.js
            </script>
            <!-- CreditQuickaddButtonDraw -->
            <style>
            .quickadd_credit{
                background-image:url(../../doc/common/images/mini_credit.png);
            }
            
            .quickadd_not_credit{
                background-image:url(../../doc/common/images/tab_credits_sta_b.png);
                opacity:.4;
            }
            </style>
            <script>
                // **************************************************
                // CreditQuickaddButtonDraw - JS Class
                class CreditQuickaddButtonDraw extends QuickaddButtonDraw{
                    constructor(obj){
                        super(obj);
                        this.type     = 'credit';
                        this.callback = null;
                        this.adapter  = 'CreditQuickaddButtonDraw:'+this.objname;
                    }


                }
//# sourceURL=CreditQuickaddButtonDraw.js
            </script>
            <!-- ScheduleQuickaddButtonDraw -->
            <style>
            .quickadd_schedule{
                background-image:url(../../doc/common/images/mini_schedule.png);
            }
            
            .quickadd_not_schedule{
                background-image:url(../../doc/common/images/menu_schedule_b.png);
                opacity:.4;
            }
            </style>
            <script>
                // **************************************************
                // ScheduleQuickaddButtonDraw - JS Class
                class ScheduleQuickaddButtonDraw extends QuickaddButtonDraw{
                    constructor(obj){
                        super(obj);
                        this.type = 'schedule';
                        this.callback = null;
                        this.adapter = 'ScheduleQuickaddButtonDraw:'+this.objname;
                    }
                }
//# sourceURL=ScheduleQuickaddButtonDraw.js
            </script>
            <!-- BookmarkQuickaddButtonDraw -->
            <style>
            .quickadd_like{
                background-image:url(../../doc/common/images/sp_star.png);
            }
            
            .quickadd_not_like{
                background-image:url(../../doc/common/images/mini_star_black.png);
                opacity:.4;
            }
            </style>
            <script>
                // **************************************************
                // BookmarkQuickaddButtonDraw - JS Class
                class BookmarkQuickaddButtonDraw extends QuickaddButtonDraw{
                    constructor(obj){
                        super(obj);
                        this.type     = 'like';
                        this.callback = null;
                        this.adapter  = 'BookmarkQuickaddButtonDraw:'+this.objname;
                    }

                }
//# sourceURL=BookmarkQuickaddButtonDraw.js
            </script>
            <!-- NoteQuickaddButtonDraw -->
            <style>
            .quickadd_note{
                background-image:url(../../doc/common/images/mini_note.png);
            }
            
            .quickadd_not_note{
                pointer-events:none;
            }
            </style>
            <script>
                // **************************************************
                // NoteQuickaddButtonDraw - JS Class
                class NoteQuickaddButtonDraw extends QuickaddButtonDraw{
                    constructor(obj){
                        super(obj);
                        this.type     = 'note';
                        this.callback = null;
                        this.adapter  = 'NoteQuickaddButtonDraw:'+this.objname;

                    }


                }
//# sourceURL=NoteQuickaddButtonDraw.js
            </script>
            <!-- EPCellDraw -->
            <style>
                .epcelldraw_link{
                    cursor:pointer;
                }
                .epcell_leftcontent{
                    flex-shrink:0;
                    display:flex;
                }

                .cell_action_container {
                    position: absolute;
                    top: 8px;
                    right: 5px;
                    display:flex;
                }
                .celluidraw_container a:focus-visible{
                    outline: 0;
                    background:#eee;
                }
                .epcelldraw_sub{
                    display: flex;
                    min-width: 0;
                    overflow: hidden;
                    justify-content: space-between;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                }
                .epcelldraw_sub div{
                    min-width: 0;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                }
            
            </style>
            <script>
                // **************************************************
                // EPCellDraw - JS Class

                class EPCellDraw extends CellUIDraw{

                    constructor(objname){
                        super(objname);
                        this.like_quickadd  = new BookmarkQuickaddButtonDraw(this.objname + '.like_quickadd');
                        this.note_quickadd  = new NoteQuickaddButtonDraw(this.objname + '.note_quickadd');

                        this.popupTime = null;
                        
                        this.callback = null;
                    }

                    Setup(callback){
                        var local = this;

                        this.callback = callback;

                        this.like_quickadd.Setup(this.table, this.tid,function(ev){
                            ev.stopPropagation();
                            ev.preventDefault();
                            EPPost('user.php?webapi=true&action=addremovestar', {'id':local.tid, 'table':local.table}, function(success, msg, data){
                                if(success){
                                    var prevState = "not_like";
                                    // Update quickadd icons
                                    $('.quickadd[data-id='+local.tid+']').each(function(){
                                        if($(this).hasClass('quickadd_like')){
                                            $(this).removeClass('quickadd_like');
                                            $(this).addClass('quickadd_not_like');
                                            prevState = "like";
                                        } else if($(this).hasClass('quickadd_not_like')){
                                            $(this).removeClass('quickadd_not_like');
                                            $(this).addClass('quickadd_like');
                                        }
                                    })
                                        // Pass function call to parent sending added value
                                    if(self!=top){
                                        try {
                                            parent.postMessage({'msg':'ToggleQuickAddIcons', 'prevState':prevState, 'type':'like', 'id':local.tid},"*");  //  `*` on any domain
                                        }
                                        catch(err) {
                                            //console.log(err);
                                        }
                                    }
                                }
                                else{
                                    EPAlert(msg);
                                }
                            });
                        });

                        this.note_quickadd.Setup(this.table, this.tid,function(ev){

                        });
                    }

                    OnClick(id){
                        if(typeof this.callback != 'undefined'){
                            this.callback(id);
                        }else{
                            console.log("EPCellDraw.OnClick() - No callback defined");
                        }
                    }

                    ShowCellPopup(el){
                        var titlePadding = 10;
                        // If there is overflow of the title
                        // Start a timer to display the title popup

                        let spanHeight = $(el).find('.list_cell_title span').height();
                        if(spanHeight > 40){
                            this.popupTime = setTimeout(function(){
                                var title = $(el).find('.list_cell_title > span').text();
                                var popupHTML = '<div class="list_cell_title_popup">' + title + '</div>';
                                $(el).prepend(popupHTML);
                            }, 1000);
                        }
                    }
                    HideCellPopup(el){
                        clearTimeout(this.popupTime);
                        $('.list_cell_title_popup').remove();
                    }

                    ViewedPrivate(table, id){
                        $.post('user.php?webapi=true&action=viewedprivate', {'table':table, 'confid':this.confid, 'id':id}, function(response){
                             var success     = new Array(1);
                             var responseMsg = new Array(1);
                             var data        = new Array(1);
                             if(ReadResponseXML(response, success, responseMsg, data)){
                                 //console.log("viewed success");
                             }else{
                                 console.log("viewed failure");
                             }
                        });
                    }

                    Clicked(confid, table, id, url){
                                        $.post('user.php?webapi=true&action=clicked', {'table':table, 'id':id}, function(response){
                    var success     = new Array(1);
                    var responseMsg = new Array(1);
                    var data        = new Array(1);
                    if(ReadResponseXML(response, success, responseMsg, data)){
                        //console.log("clicked success");
                    }else{
                        console.log("clicked failure");
                    }
    
               });
                        
                        if(url != ''){
                            if(IsURN(url)){
                                window.location.replace('/web/index.php?page=urn&project='+confid+'&urn='+url);
                            } else if(url.search('http') != -1){
                                window.open(url);
                            } else {
                                window.location.replace(url);
                            }
                        }
                    }            

                    Refresh(){
                        this.like_quickadd.RefreshButton();
                        this.note_quickadd.RefreshButton();
                    }

                }
//# sourceURL=EPCellDraw.js
            </script>
            <!-- SessionCellDraw -->
            <style>

            .session_cell_past.celluidraw_container .list_cell_title{
                opacity:.5;
            }

            .celluidraw_container .cell_info h1 {
                margin-right:40px; /* extra margin for the two additional quickadd buttons in session lists */
            }

            .celluidraw_container.session_cell .epcell_leftcontent, .celluidraw_container.session_cell_past .epcell_leftcontent {
                width: 100px;
                margin-right: -62px;
            }

            .celluidraw_container .category_label, .sub-session{
                height: 18px;
                width:74px;
                padding:0 3px;
                color: #FFF;
                font-size: 8px;
                line-height: 2;
                text-align:center;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
                font-weight: 500;
                letter-spacing:.2px;
                transform:rotate(270deg) translate(-31px, -31px); /* When rotated, the div actually still takes up the original width horizontally. It must be translated and negative margin applied to subsession in order toaccount for this invisible space*/
            }
            .celluidraw_container .sub-session {
                background-color: #333;
                margin-right:-62px; /* This is to pull the category label up against the subsession banner. */
            }

            .celluidraw_container .session_date_time, .session_location{
                font-weight: 200;
                font-size:1em;
                color: #333;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
            }
            
            .celluidraw_container .session_location { /* aditional location-specific styles */
                flex-grow:1;
            }
            </style>
            <script>
                // **************************************************
                // SessionCellDraw - JS Class

                class SessionCellDraw extends EPCellDraw{
                    constructor(objname){
                        super(objname);
                        this.table = 'agenda';
                        this.tid = null;
                        this.credit_quickadd    = new CreditQuickaddButtonDraw(this.objname + '.credit_quickadd');
                        this.schedule_quickadd  = new ScheduleQuickaddButtonDraw(this.objname + '.schedule_quickadd');
                    }

                    Setup(item, callback){
                        var local = this;
                        this.tid = item['sessionid'];
                        super.Setup(callback);
                        
                        this.credit_quickadd.Setup(this.table, this.tid,function(ev){
                            ev.stopPropagation();
                            ev.preventDefault();
                            EPPost('user.php?webapi=true&action=addremovecredit', {'sessionid':local.tid}, function(success, msg, data){
                                if(success){
                                    var prevState = 'not_credit';
                                    $('.quickadd[data-id='+local.tid+']').each(function(){
                                        if($(this).hasClass('quickadd_credit')){
                                            $(this).removeClass('quickadd_credit');
                                            $(this).addClass('quickadd_not_credit');
                                            var prevState = 'credit';
                                        } else if($(this).hasClass('quickadd_not_credit')){
                                            $(this).removeClass('quickadd_not_credit');
                                            $(this).addClass('quickadd_credit');
                                        }
                                    });
                                    // Pass function call to parent sending added value
                                    if(self!=top){
                                        parent.postMessage({'msg':'ToggleQuickAddIcons', 'prevState':prevState, 'type':'credit', 'id':local.tid},"*");  //  `*` on any domain
                                    }
                                }else{
                                    EPAlert(msg);
                                }
                            });
                        });
                        this.schedule_quickadd.Setup(this.table, this.tid,function(ev){
                            ev.stopPropagation();
                            ev.preventDefault();
                            EPPost('user.php?webapi=true&action=addremovesession', {'sessionid':local.tid}, function(success, msg, data){
                                if(success){
                                    var prevState = 'not_schedule';
                                    // Update quickadd icons
                                    $('.quickadd[data-id='+local.tid+']').each(function(){
                                        if($(this).hasClass('quickadd_schedule')){
                                            $(this).removeClass('quickadd_schedule');
                                            $(this).addClass('quickadd_not_schedule');
                                            prevState = 'schedule';
                                        } else if($(this).hasClass('quickadd_not_schedule')){
                                            $(this).removeClass('quickadd_not_schedule');
                                            $(this).addClass('quickadd_schedule');
                                        }
                                    })
                    
                                    // Pass function call to parent sending added value
                                    if(self!=top){
                                        try {
                                            parent.postMessage({'msg':'ToggleQuickAddIcons', 'prevState':prevState, 'type':'schedule', 'id':local.tid},"*");  //  `*` on any domain
                                        }catch(err) {
                                            //console.log("SessionAdded() is not defined in the parent iframe.");
                                        }
                                    }
                                }else{
                                    EPAlert(msg);
                                }
                            });
                        });
                    }

                    Refresh(){
                        super.Refresh();
                        this.credit_quickadd.RefreshButton();
                        this.schedule_quickadd.RefreshButton();
                    }
                }
//# sourceURL=SessionCellDraw.js
            </script>            <style>
            .celluidraw_container .cell_info h1{
                height: 20px;
                text-overflow: ellipsis;
                white-space: nowrap;
                overflow: hidden;
            }
            
            </style>
            <script>
                // **************************************************
                // SpeakerCellDraw - JS Class

                class SpeakerCellDraw extends EPCellDraw{

                    constructor(objname){
                        super(objname);
                        this.table = 'speakers';
                        this.tid = null;
                    }

                    Setup(item, callback){
                        this.tid = item['personid'];
                        super.Setup(callback);
                    }
                }
//# sourceURL=SpeakerCellDraw.js
            </script>            <style>
                .celluidraw_container.member_cell .cell_icon{
                    border-radius:50%;
                }
                .celluidraw_container .cell_info h1{
                    height: 20px;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                    overflow: hidden;
                }
            
            </style>
            <script>
                // **************************************************
                // MemberCellDraw - JS Class

                class MemberCellDraw extends EPCellDraw{

                    constructor(objname){
                        super(objname);
                        this.table = 'members';
                        this.tid = null;
                    }

                    Setup(item, callback){
                        this.tid = item['personid'];
                        super.Setup(callback);
                    }

                }
//# sourceURL=MemberCellDraw.js
            </script>            <style>
            .exhibitor_cell.celluidraw_container .cell_icon{
                object-fit: contain;
            }
            .text_exhibitor_cell.celluidraw_container .cell_icon{
                display:none;
            }
            .text_exhibitor_cell.celluidraw_container .cell_info{
                height:auto;
                max-height:70px;
            }

            </style>
            <script>
                // **************************************************
                // ExhibitorCellDraw - JS Class

                class ExhibitorCellDraw extends EPCellDraw{

                    constructor(objname){
                        super(objname);
                        this.table = 'exhibitors';
                        this.tid = null;
                    }

                    Setup(item, callback){
                        this.tid = item['orgid'];
                        super.Setup(callback);
                    }

                }
//# sourceURL=ExhibitorCellDraw.js
            </script>            <style>
                .celluidraw_container.media_cell .cell_icon{
                    object-fit: contain;
                }
            </style>
            <script>
                // **************************************************
                // MediaCellDraw - JS Class

                class MediaCellDraw extends EPCellDraw{

                    constructor(objname){
                        super(objname);
                        this.table = 'media';
                        this.tid = null;
                    }

                    Setup(item, callback){
                        this.tid = item['mediaid'];
                        super.Setup(callback);
                    }

                }
//# sourceURL=MediaCellDraw.js
            </script>            <style>
            .celluidraw_container.media_ad_cell a:focus-visible{
                outline: 2px solid blue;
                outline-offset: -2px;
            }
            </style>
            <script>
                // **************************************************
                // MediaAdCellDraw - JS Class

                class MediaAdCellDraw extends MediaCellDraw{

                    constructor(objname){
                        super(objname);
                    }

                }
//# sourceURL=MediaAdCellDraw.js
            </script>            <style>
            
            </style>
            <script>
                // **************************************************
                // MediaAlertCellDraw - JS Class

                class MediaAlertCellDraw extends MediaCellDraw{

                    constructor(objname){
                        super(objname);
                    }

                }
//# sourceURL=MediaAlertCellDraw.js
            </script>            <style>
            
            </style>
            <script>
                // **************************************************
                // MediaHtmlCellDraw - JS Class

                class MediaHtmlCellDraw extends MediaCellDraw{

                    constructor(objname){
                        super(objname);
                    }

                }
//# sourceURL=MediaHtmlCellDraw.js
            </script>            <style>
            
            </style>
            <script>
                // **************************************************
                // MediaIntHtmlCellDraw - JS Class

                class MediaIntHtmlCellDraw extends MediaCellDraw{

                    constructor(objname){
                        super(objname);
                    }

                }
//# sourceURL=MediaIntHtmlCellDraw.js
            </script>            <style>
            
            </style>
            <script>
                // **************************************************
                // MediaPdfCellDraw - JS Class

                class MediaPdfCellDraw extends MediaCellDraw{

                    constructor(objname){
                        super(objname);
                    }

                }
//# sourceURL=MediaPdfCellDraw.js
            </script>            <style>
            
            </style>
            <script>
                // **************************************************
                // MediaXpubCellDraw - JS Class

                class MediaXpubCellDraw extends MediaCellDraw{

                    constructor(objname){
                        super(objname);
                    }

                }
//# sourceURL=MediaXpubCellDraw.js
            </script>		<style>
        .customdialog_container{
            position: fixed;
            left:50%;
            top:50%;
            background-color:white;
            min-height:200px;
            max-width: 80%;
            width:400px;
            transition: visibility 0s linear 0.25s, opacity 0.25s 0s, transform 0.25s;
            display:none;
            z-index: 101;
        }
        .customdialog_header{
            height:25px;
            margin:15px;
            font-weight:600;
            font-size:1.2em;
        }
        .customdialog_msg{
            padding:20px 15px;
        }
        .customdialog_dark_overlay{
            display: flex;
            justify-content: center;
            align-items: center;

            display:none;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            width: 100%;
            height: 100%;
            background-color: #000;
            filter:alpha(opacity=60);
            -moz-opacity: 0.6;
            opacity: 0.6;
        }
		</style>
		<script>

        // Hide any open custom dialog draw
        $(document).keyup(function(e) {
            if (e.key === "Escape") { // escape key maps to keycode `27`
                $('.customdialog_dark_overlay').hide();
                $('.customdialog_container').hide();
            }
        });

		// **************************************************
        // Custom Dialog Draw - JS Class
		var CustomDialogDraw = function(){
                    this.objname;
        this.prefix;
        this.data = {};

        CustomDialogDraw.prototype.Setup = function(objname){
            this.objname = objname; 
            this.prefix  = objname.replace(/\./g, '_');
            
        }

        CustomDialogDraw.prototype.GetContainerId = function(){
            return this.prefix+'_customdialog_container';
        }                    
        
        // Clear associative array
        CustomDialogDraw.prototype.ClearData = function(){
            this.data = {};
        }            

        // Store data to custom dialog for later access
        CustomDialogDraw.prototype.StoreData = function(key, value){
            this.data[key] = value;
        }            

        // Fetch data to custom dialog, previously stored
        CustomDialogDraw.prototype.FetchData = function(key){
            if(this.data[key] !== undefined){
                return this.data[key];
            }
            return null;
        }                        

        CustomDialogDraw.prototype.Show = function(){
            //console.log("CustomDialogDraw::Show");
            $('#'+this.prefix+'_customdialog_dark_overlay').show();
            $('#'+this.prefix+'_customdialog_container').show();
            this.Center();

            var local = this;
            window.onresize = function(){
                clearTimeout(local.resizeTimer);
                local.resizeTimer = setTimeout(function(){
                    local.Center();
                }, 100);
            };
        }

        CustomDialogDraw.prototype.Center = function(){
            let height = $('#'+this.prefix+'_customdialog_container').outerHeight();
            let width = $('#'+this.prefix+'_customdialog_container').outerWidth();
            $('#'+this.prefix+'_customdialog_container').css({
                'margin-top': '-'+height/2+'px',
                'margin-left': '-'+width/2+'px'
                });
        }

        CustomDialogDraw.prototype.Hide = function(){
            //console.log("CustomDialogDraw::Hide");
            $('#'+this.prefix+'_customdialog_dark_overlay').hide();
            $('#'+this.prefix+'_customdialog_container').hide();
        }

        CustomDialogDraw.prototype.Create = function(html){
            $('#'+this.prefix+'_customdialog_container').html(html);
        }        

            CustomDialogDraw.prototype.SetWidth = function(width){
                $('.customdialog_container').css('width', width);
            }
        }
//# sourceURL=CustomDialogDraw.js        
		</script>        <style>
            .timzonetranslatoruidraw_activity{
                display:none;
                text-align:center;
            }
            .timzonetranslatoruidraw_activity svg{
                padding-top:10px;
            }
            .timzonetranslatoruidraw_options{

                overflow-y: scroll;
                overflow-x: hidden;
            }

            .timezonetranslationdraw_dialog_contents{
                padding:0 10px;
            
            }

            .settimezone_placeholder{
                text-decoration:underline;
            }

            .timzonetranslatoruidraw_display{
                
                cursor:pointer;
            }
            .timzonetranslatoruidraw_translated_time{
                text-decoration:none;
            }
            .timezonetranslationdraw_dialog_header{
                color:#333;
                font-size:1.4em;
                text-align:center;
                padding:15px 0;
            }
            .timezonetranslationdraw_dialog_selector_label{
                color: #3f51b5;
                font-size: 12px;
                top: 4px;
            }
            .timezonetranslationdraw_dialog_selector{
                color: #333;
            }

            .select_dropdown,
.select_dropdown * {
  margin: 0;
  padding: 0;
  position: relative;
  box-sizing: border-box;
}
.select_dropdown {
  position: relative;
  background-color: transparent;
  border-bottom:thin solid;
}
.select_dropdown select {
  font-size: 1rem;
  font-weight: normal;
  width: 100%;
  padding: 8px 24px 8px 10px;
  border: none;
  background-color: transparent;
    -webkit-appearance: none;
    -moz-appearance: none;
  appearance: none;
}

.select_dropdown:after {
  content: "";
  position: absolute;
  top: 50%;
  right: 8px;
  width: 0;
  height: 0;
  margin-top: -2px;
  border-top: 5px solid #aaa;
  border-right: 5px solid transparent;
  border-left: 5px solid transparent;
}


        </style>
        <script>
		// **************************************************
		// TimezoneTranslationDraw - JS Class
		class TimezoneTranslationDraw extends Draw{
            constructor(objname){
                super(objname);
                this.setTimezoneDialog  = null; 
                this.callback           = null;
                this.confid             =null;
                this.time1              =null;
                this.time2              =null;
            }

            Setup(confid, initTimezone, time1, time2){
                console.log("Setup TimezoneTranslationDraw");
                // Initialte our element's dialog
                this.setTimezoneDialog = new CustomDialogDraw();
                this.setTimezoneDialog.Setup(this.objname+'.setTimezoneDialog');
                this.confid = confid;
                this.curTimezone = initTimezone;
                this.time1 = time1;
                this.time2 = time2;

                let translatedTimezone = window.localStorage.getItem(this.confid+'_TimezoneTranslate');
                if(translatedTimezone != null && translatedTimezone != this.curTimezone){
                   this.TranslateTime(translatedTimezone);
                } else {
                    $("#" + this.prefix + "_timzonetranslatoruidraw_timezone_display").html("<span class='settimezone_placeholder'>See in my timezone</span>");
                }
                
            }
            
            ShowDialog(){
                this.setTimezoneDialog.Show();
                $("#" + this.prefix + "_timezone_selector_input").focus();
            }

            TranslateTime(timezone){
                console.log(timezone)
                var local = this;

                this.setTimezoneDialog.Hide();
                if(timezone != this.curTimezone){
                    this.curTimezone = timezone;
                } else {
                    return;
                }

                localStorage.setItem(this.confid+'_TimezoneTranslate', timezone);

                var formdata = {'interface':'datetime', 'action':'translate_timezone', 'confid':this.confid, 'adapter':'TimezoneTranslationDraw:'+this.objname, 'timezone': timezone, 'time1': this.time1, 'time2': this.time2};
                EPPost('../data/api.php', formdata, function(success, msg, data){
                    if(success){
                        let json = JSON.parse(data);
                        $("#" + local.prefix + "_timzonetranslatoruidraw_timezone_display").html(json.html);
                    } else {
                        HandleEPPostError(msg, data);
                        $("#" + local.prefix + "_timzonetranslatoruidraw_timezone_display").html(msg);
                    }
                });
            }

        }
//# sourceURL=TimezoneTranslationDraw.js
        </script>
        
		<script>

			var timezoneTranslation = null;

			$('document').ready(function(){
				timezoneTranslation = new TimezoneTranslationDraw('timezoneTranslation');
				timezoneTranslation.Setup('AIAAASCEND24', 'America/Los_Angeles', '2024-08-01 15:30:00', '2024-08-01 17:00:00');
			});
		</script><div id="page_session">        <div id="epwebheaderdraw_epwebheaderdraw_container" class="webheaderuidraw_container webheaderuidraw">
            <div id="epwebheaderdraw_epwebheaderdraw_content" class="webheaderuidraw_content darkmode_ui_component no-print " aria-label="Session." aria-level="1">
                <div id="epwebheaderdraw_epwebheaderdraw_left" class="webheaderuidraw_left">
                        <div id="epwebheaderdraw_epBackButton_epwebbackdraw" class="epwebbackdraw" data-nohistory="false">
                    <!-- ButtonUIDraw -->
                    <div style="" class="buttonuidraw_container" id="epwebheaderdraw_epBackButton_backButton_buttonuidraw_container">
                <div id="epwebheaderdraw_epBackButton_backButton_buttonuidraw_activity" class="buttonuidraw_activity"><svg style="fill:#555" width="18" height="18" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring"><circle cx="50" cy="50" ng-attr-r="{{config.radius}}" ng-attr-stroke-width="{{config.width}}" ng-attr-stroke="{{config.stroke}}" ng-attr-stroke-dasharray="{{config.dasharray}}" fill="none" stroke-linecap="round" r="40" stroke-width="4" stroke="#555" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(34.6018 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg></div>
                <button id="epwebheaderdraw_epBackButton_backButton" class=" buttonuidraw  buttonuidraw_mini" style="background-color: rgb(0, 58, 112); color: rgb(255, 255, 255); font-family: HelveticaNeue, Helvetica, Arial, sans-serif; font-size: 0.8em; border: medium;" data-id="" onclick="epwebheaderdraw.epBackButton.backButton.OnClick(event, this);" role="button" aria-label="Back" tabindex="0">
                                <svg fill="#FFFFFF" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="18" height="18" viewBox="0 0 30 30" xml:space="preserve">
            <g transform="translate(-30 -80)">
                <polygon xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" id="arrow-big-01_2_" points="45,91 45,85 32,95 45,105 45,99 58,99 58,91  "></polygon>
            </g>
        </svg>
                </button>
                <div class="buttonuidraw_subtitle" style="color:#555; " id="epwebheaderdraw_epBackButton_backButton_buttonuidraw_subtitle"></div>
            </div>
                    <!-- TooltipUIDraw -->
        <div id="_tooltipuidraw" style="min-width:75px; " class="mdl-tooltip mdl-tooltip--top" data-mdl-for="epwebheaderdraw_epBackButton_backButton" data-upgraded=",MaterialTooltip">
            Go to previous page in this tab
        </div>
        </div>
                
                </div>
                <div id="epwebheaderdraw_epwebheaderdraw_title" class="webheaderuidraw_title">
                    Session
                </div>
                <div id="epwebheaderdraw_epwebheaderdraw_right" class="webheaderuidraw_right">
                
                </div>
            </div>
            <div id="epwebheaderdraw_epwebheaderdraw_push" class="webheaderuidraw_push"></div>
        </div>        <script>
            var epwebheaderdraw = new EPWebHeaderDraw('epwebheaderdraw');
            $(document).ready(function(){
                epwebheaderdraw.Setup();
            });
        </script>
		<style>
		.handout_button{
			background-color: #969063;
		}
		</style>        <div class="content" data-role="content" style="font-size: 14px; padding-bottom:0;">
		    <ul class="ep_ul_section"><li data-role="listdivider" class="headerbar" style="background:#969063; padding:3px 10px;color:white;">AVIATION Technical Workshop</li>		<!-- SHARE LINK: -->
				<li class="detail_up_icons">
                <div style="display:flex; justify-content:space-between;">
                    <div style="display:flex;">
					<div class="sessionShareLink mapSession"><a aria-label="Show on map" href="https://eppro02.ativ.me/web/page.php?page=MapViewWeb&amp;project=AIAAASCEND24&amp;name=FL-14%3A+Aviation+Operations+and+other+Applications+of+Autonomy&amp;path=avasmasterfloorplancalmresize.jpg&amp;table=agenda&amp;id=491255&amp;action=pindrop" rel="external"> <img class="handout_button" alt="Map Icon" src="page_data_002/ep_map_sel.png"></a></div>                    </div>
					<!-- ADD SCHEDULE/LIKE/CREDIT: -->
					<div class="schedule_like_credit">
				            <img class="handout_button" alt="" aria-label="Remove bookmark." tabindex="0" onkeyup="event.keyCode == 13 ? $(this).click() : '';" id="uplikebutton" data-sessionid="491255" src="page_data_002/ep_likeon@2x.png" onclick="AddRemoveStar(event, $(this).attr('data-sessionid'), $(this), 'agenda')" height="30" width="30" title="Remove bookmark from this session.">				    </div>
					</div>
				</li>
						<li class="session_detail_title" style="padding:25px 0px 25px 0px;"><div class="subsession_nav_button empty"></div><span>FL-14: Aviation Operations and other Applications of Autonomy</span><div class="subsession_nav_button empty"></div></li>
		
        <!-- ChipUIDraw -->
        <style>
            
        .chipuidraw_content {
            /*margin: 4px;*/
            cursor: pointer;
        }

        .chipuidraw_content.mdl-chip{
            padding:0 7px;
        }

        .chipuidraw_content .material-icons{
            font-size:22px;
            margin-top:1px;
        }

        .mdl-chip__text {
            font-size: 14px;
            line-height: 32px;
            padding: 0 6px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width:100px;
        }

        .chipuidraw_content .mdl-chip__action {
            margin:0px;
            opacity:0.7;
        }

        .mdl-chip__action {
            cursor: pointer;
        }

        .chipuidraw_content button:focus-visible {
            opacity: 1;
            border-radius:50%;
            box-shadow:inset 0 0 4px blue;
        }

        .chipuidraw_content i:hover {
            transform: scale(1.1);  /* Enlarges the element by 10% */
            transition: transform 0.3s ease;  /* Smooth transition for the scaling effect */
        }

        .chipuidraw_content:hover{
            transform: scale(1.02);  /* Enlarges the element by 10% */
            transition: transform 0.3s ease;  /* Smooth transition for the scaling effect */
        }
        </style>
        <script>
            class ChipUIDraw extends UIDraw{
    constructor(obj){
        super(obj);

        this.callback = null;

        this.bgcolor = '';
        this.label   = '';
        this.color   = '';
        this.button  = '';
        this.bordercolor = '';
    }

    Setup(callback){
        var local = this;

        this.callback = callback;
    }

    SetCallback(callback){
        this.callback = callback;
    }

    GetLabel(){
        return this.label;
    }

    SetLabel(label){
        this.label = label;
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content span').html(label);
    }

    SetButton(button){
        this.button = button;
        if(typeof button != 'undefined'){
            if(button == 'none'){
                $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content button').css('display', 'none');
            }else{
                $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content i').html(button);
                $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content button').show();
                $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content i').css('color', this.color);
            }
        }else{
            $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content i').css('display', 'none');
            $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content i').show();
        }
    }

    SetBackgroundColor(color){
        this.bgcolor = color;
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content').css('background-color', color);
    }

    GetColor(){
        return this.color;
    }

    SetColor(color){
        this.color = color;
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content').css('color', color);
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content i').css('color', color);
    }

    SetBorderColor(color){
        this.bordercolor = color;
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content').css('border', '1px solid '+color);
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content i').css('color', color);
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content button').css('opacity', '1');
    }

    SetMaxWidth(width){
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content span').css('max-width', width);
    }

    OnClick(type){
        var local = this;
        if(typeof this.callback != 'undefined'){
            local.callback(type);
        }
    }

    GetLabel(){
        return this.label;
    }

    SetLabel(label){
        this.label = label;
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content span').html(label);
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content span').attr("title", this.label);
        $('#'+this.prefix+'_'+this.GetClassNameLower()+'_content button').attr("aria-label", "Clear: ${this.label}");
    }

    GetStartHTML() {
        let html = super.GetStartHTML();
        let iconStyle = '';
        let style = '';
        if (this.bgcolor !== '') {
          style = `background-color:${this.bgcolor};`;
        }
        if(this.color !== ''){
            style += `color:${this.color};`;
            iconStyle = `color:${this.color};`;
        }
        let buttonStyle = '';
        if(this.button == ''){
            buttonStyle += `display:none;`;
        }
        let borderStyle = '';
        if(this.bordercolor !== ''){
            borderStyle = `border:1px solid ${this.bordercolor};`;
        }
      
        html += `
          <div id="${this.prefix}_${this.GetClassNameLower()}_container" class="chipuidraw_container">
            <div onclick="${this.objname}.OnClick('chip')" id="${this.prefix}_${this.GetClassNameLower()}_content" class="chipuidraw_content mdl-chip" style="${style}${borderStyle}">
              <button style='${buttonStyle}' aria-label="" onclick="${this.objname}.OnClick('button');event.stopPropagation();" type="button" class="mdl-chip__action">
                <i style="${iconStyle}" class="material-icons">${this.button}</i>
              </button>
              <span class="mdl-chip__text">${this.label}</span>
            </div>
          </div>
        `;
      
        return html;
      }
}
//# sourceURL=ChipUIDraw.js
        </script>
        <!-- ChipButtonUIDraw -->
        <style>
            
        /* Add any styles needed by the draw */
        </style>
        <script>
                    // **************************************************
        // ChipButtonUIDraw - JS Class
        class ChipButtonUIDraw extends ChipUIDraw{
            constructor(obj){
                super(obj);

                this.active = false;

                this.primaryColor = '';
            }

            Init(config){
                // Check for necessary fields: primaryColor, active
                if(config.primaryColor != undefined){

                    this.primaryColor = config.primaryColor;

                    if(config.button != undefined){
                        this.button = config.button;
                        //this.SetButton(config.button);
                    }
                    if(config.label != undefined){
                        this.label = config.label;
                        //this.SetLabel(config.label);
                    }

                    if(config.visible != undefined){
                        if(config.visible){
                            this.Show();
                        }else{
                            this.Hide();
                        }
                    }

                    this.active = config.active;
                    if(config.active){
                        this.bgcolor = config.primaryColor;
                        this.bordercolor = config.primaryColor;
                        this.color = '#ffffff';
                    }else{
                        this.bgcolor = '#ffffff';
                        this.bordercolor = config.primaryColor;
                        this.color = config.primaryColor;
                    }
                }else{
                    EPAlert('ChipButtonUIDraw: Config missing primaryColor');
                }
            }

            Config(data){
                let config = this.ParseConfig(data);
                // Check for necessary fields: primaryColor, active
                if(config.primaryColor != undefined){

                    this.primaryColor = config.primaryColor;

                    if(config.button != undefined){
                        this.SetButton(config.button);
                    }
                    if(config.label != undefined){
                        this.SetLabel(config.label);
                    }

                    if(config.visible != undefined){
                        if(config.visible){
                            this.Show();
                        }else{
                            this.Hide();
                        }
                    }

                    this.active = config.active;
                    if(config.active){
                        this.SetBackgroundColor(config.primaryColor);
                        this.SetBorderColor(config.primaryColor);
                        this.SetColor('#ffffff');
                    }else{
                        this.SetBackgroundColor('#ffffff');
                        this.SetBorderColor(config.primaryColor);
                        this.SetColor(config.primaryColor);
                    }
                }else{
                    EPAlert('ChipButtonUIDraw: Config missing primaryColor');
                }

                this.Setup();
            }

            Setup(callback){
                var local = this;

                this.callback = callback;
            }

            IsActive(){
                return this.active;
            }

            SetPrimaryColor(color){
                this.primaryColor = color;
            }

            SetActive(active){
                if(this.active){
                    this.SetBackgroundColor('#ffffff');
                    this.SetBorderColor(this.primaryColor);
                    this.SetColor(this.primaryColor);
                }else{
                    this.SetBackgroundColor(this.primaryColor);
                    this.SetBorderColor(this.primaryColor);
                    this.SetColor('#ffffff');
                }
                this.active = active;
            }

            Toggle(){
                // Invert the colors and set the button to active or inactive
                if(this.active){
                    this.SetActive(false);
                }else{
                    this.SetActive(true);
                }
            }

        }
//# sourceURL=ChipButtonUIDraw.js
        </script>
        <!-- ChipButtonsUIDraw -->
        <style>
            
        .chipbuttonsuidraw_content{
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap:10px;
            align-items: center;
            flex-wrap: wrap;
        }
        </style>
        <script>
                    // **************************************************
        // ChipButtonsUIDraw - JS Class
        class ChipButtonsUIDraw extends UIDraw{
            constructor(obj){
                super(obj);

                this.callback = null;

                this.buttons = {};
            }

            CreateButtonsFromConfig(config){
                var local = this;
                for(let i=0; i<config.length; i++){
                    let id     = config[i].id;
                    let button = config[i].button;
                    let label  = config[i].label;
                    let active = config[i].active;
                    let primaryColor = config[i].primaryColor;
                    local.buttons[id] = new ChipButtonUIDraw(this.objname+'.buttons[\''+id+'\']');
                }
            }

            // Creates the buttons, but not the DOM elements
            Init(config){
                var local = this;
                // [{"id":"home","active":false,"label":"Home","button":"home","backgroundColor":"#ffffff","color":"#ff0000","borderColor":"#ff0000"},{"id":"edit","active":true,"label":"Edit","button":"edit","backgroundColor":"#ffffff","color":"#00ff00","borderColor":"#00ff00"},{"id":"delete","active":false,"label":"Delete","button":"trash","backgroundColor":"#ffffff","color":"#0000ff","borderColor":"#0000ff"}]
                // Iterate over our config and create our buttons, add buttons to the content using the array definition above
                this.CreateButtonsFromConfig(config);
                for(let i=0; i<config.length; i++){
                    let id     = config[i].id;
                    local.buttons[id].Init(config[i]);
                    // Config calls setup w/o a callback so we need to set it here
                    local.buttons[id].SetCallback(function(){
                        if(local.callback != null && typeof local.callback != 'undefined'){
                            local.callback(id);
                        }
                    });
                }
            }

            // Creates the buttons and the DOM elements
            Config(data){
                var local = this;
                let config = this.ParseConfig(data);

                this.CreateButtonsFromConfig(config);
                for(let i=0; i<config.length; i++){
                    let id     = config[i].id;
                    this.AppendContent(local.buttons[id].GetStartHTML());
                    local.buttons[id].Config(JSON.stringify(config[i]));
                    local.buttons[id].SetCallback(function(){
                        if(local.callback != null && typeof local.callback != 'undefined'){
                            local.callback(id);
                        }
                    });
                }
            }

            Setup(callback){
                var local = this;

                this.callback = callback;
            }

            SetCallback(callback){
                this.callback = callback;
            }

            Get(id){
                return this.buttons[id];
            }

            GetStartHTML(){

                let name = this.GetClassNameLower();

                let html = `
                <div id="${this.prefix}_${name}_container" class="chipbuttonsuidraw_container">
                    <div id="${this.prefix}_${name}_content" class="chipbuttonsuidraw_content">
                    </div>
                </div>
                `;

                return html;
            }
        }
//# sourceURL=ChipButtonsUIDraw.js
        </script>
        <!-- AgendaDetailButtonsDraw -->
        <style>
            
        /* Add any styles needed by the draw */
        </style>
        <script>
                    // **************************************************
        // AgendaDetailButtonsDraw - JS Class
        class AgendaDetailButtonsDraw extends UIDraw{
            constructor(obj){
                super(obj);

                this.callback = null;

                this.primaryColor = '#1a80b6';

                this.draw = new ChipButtonsUIDraw(this.objname+'.draw');

                this.order = ['schedule','notes','credits'];

                this.data = {'schedule':{'button':'calendar_today','label':'Schedule','visible':false,'active':false},
                             'notes':{'button':'edit_square','label':'Notes','visible':false,'active':false},
                             'credits':{'button':'editor_choice','label':'Credits','visible':false,'active':false}};
            }

            Get(id){
                return this.draw.Get(id);
            }

            Init(config){
                var local = this;

                this.primaryColor = config.primaryColor || '#1a80b6';

                let buttons = [];
                for(let i=0; i<this.order.length; i++){
                    let id   = this.order[i];
                    let item = this.data[id];

                    item.id           = id;
                    // Our config only specifies if active and/or visible
                    if(config.buttons[id] != undefined){
                        item.active = config.buttons[id].active;
                        item.visible = config.buttons[id].visible;
                    }
                    item.primaryColor = this.primaryColor;
                    buttons.push(item);
                }//for

                // Configure
                this.draw.Init(buttons);

                return buttons;
            }

            Config(data){
                var local = this;
                let config = this.ParseConfig(data);

                let buttons = this.Init(config);
                this.draw.Config(JSON.stringify(buttons));
            }

            SetCallback(callback){
                this.callback = callback;
                this.draw.SetCallback(callback);
            }

            Setup(callback){
                var local = this;

                this.callback = callback;
                this.draw.SetCallback(callback);
            }

            GetStartHTML() {
                let buttonsHtml = this.draw.GetStartHTML();

                let name = this.GetClassNameLower();

                let html = `
                  <div id="${this.prefix}_${name}_container" class="agendadetailbuttonsdraw_container">
                      <div id="${this.prefix}_${name}_content" class="agendadetailbuttonsdraw_content">
                          ${buttonsHtml}
                      </div>
                  </div>
                `;
                return html;
            }
        }
//# sourceURL=AgendaDetailButtonsDraw.js
        </script>		<style>
		.detailbuttons{
			margin-top:20px;
			margin-bottom:20px;
		}
		</style>
		<script>

			function _AddRemoveSession(id, scheduled){
				$.post('user.php?webapi=true&action=addremovesession', {'sessionid':id}, function(res){
					if($(res).find('Item').attr('success') == 'true'){
						if(self!=top){
							try {
								parent.SessionAdded(scheduled, id);
							}catch(err) {
								console.log("SessionAdded() is not defined in the parent iframe.");
							}
						}
					}else{
						alert($(res).find('Item').attr('message'));
					}
				}, 'XML');
			}

			function _AddRemoveCredit(id, prevState){
				$.post('user.php?webapi=true&action=addremovecredit', {'sessionid':id}, function(res){
					if($(res).find('Item').attr('success') == 'true'){
						// Pass function call to parent sending added value
						if(self!=top){
							parent.postMessage({'msg':'ToggleQuickAddIcons', 'prevState':prevState, 'type':'credit', 'id':id},"*");  //  `*` on any domain
						}
					}else{
						alert($(res).find('Item').attr('message'));
					}
				}, 'XML');
			}

			var buttons = new AgendaDetailButtonsDraw('buttons');
			$(document).ready(function(){
				let loginurl = '';
				let crediturl = '';
				buttons.Init(JSON.parse('{"primaryColor":"#969063","buttons":{"schedule":{"active":true,"visible":true,"desc":"Remove from schedule"},"notes":{"active":false,"visible":true,"desc":"Enter note"},"credits":{"active":false,"visible":false,"desc":"Add credit"}}}'));
				buttons.Setup(function(id){
					if(loginurl != ''){
						location.href = loginurl;
					}else{
						switch(id){
							case 'schedule':
                                if(buttons.Get(id).IsActive()){
									_AddRemoveSession('491255', true);
                                }else{
                                    _AddRemoveSession('491255', false);
                                }
								buttons.Get(id).Toggle();
								break;
							case 'notes':
								ShowNotePad('agenda', '491255', function(note){
									if(note == ''){
										buttons.Get(id).SetActive(false);
									}else{
										buttons.Get(id).SetActive(true);
									}
								});
								break;
							case 'credits':
								if(crediturl != ''){
									epView.OpenDialog(crediturl);
								}else{
									if(buttons.Get(id).IsActive()){
										_AddRemoveCredit('491255', 'credit');
									}else{
										_AddRemoveCredit('491255', 'not_credit');
									}
									buttons.Get(id).Toggle();
								}
								break;
						}//end switch
					}
				});
			});
		</script>
		<div class="detailbuttons">
			        <div id="buttons_agendadetailbuttonsdraw_container" class="agendadetailbuttonsdraw_container">
            <div id="buttons_agendadetailbuttonsdraw_content" class="agendadetailbuttonsdraw_content">
                        <div id="buttons_draw_chipbuttonsuidraw_container" class="chipbuttonsuidraw_container">
            <div id="buttons_draw_chipbuttonsuidraw_content" class="chipbuttonsuidraw_content">
                        <div id="buttons_draw_buttons_schedule__chipbuttonuidraw_container" class="chipuidraw_container">
            <div onclick="buttons.draw.buttons['schedule'].OnClick('chip')" id="buttons_draw_buttons_schedule__chipbuttonuidraw_content" class="chipuidraw_content mdl-chip" style="background-color:#969063;color:#ffffff;border:1px solid #ffffff;">
                <button aria-label="Remove from schedule" onclick="buttons.draw.buttons['schedule'].OnClick('button');event.stopPropagation();" type="button" class="mdl-chip__action">
                    <i style="color:#ffffff;" class="material-icons">calendar_today</i>
                </button>
                <span class="mdl-chip__text">Schedule</span>
            </div>
        </div>        <div id="buttons_draw_buttons_notes__chipbuttonuidraw_container" class="chipuidraw_container">
            <div onclick="buttons.draw.buttons['notes'].OnClick('chip')" id="buttons_draw_buttons_notes__chipbuttonuidraw_content" class="chipuidraw_content mdl-chip" style="background-color:#ffffff;color:#969063;border:1px solid #969063;">
                <button aria-label="Enter note" onclick="buttons.draw.buttons['notes'].OnClick('button');event.stopPropagation();" type="button" class="mdl-chip__action">
                    <i style="color:#969063;" class="material-icons">edit_square</i>
                </button>
                <span class="mdl-chip__text">Notes</span>
            </div>
        </div>        <div id="buttons_draw_buttons_credits__chipbuttonuidraw_container" class="chipuidraw_container" style="display: none;">
            <div onclick="buttons.draw.buttons['credits'].OnClick('chip')" id="buttons_draw_buttons_credits__chipbuttonuidraw_content" class="chipuidraw_content mdl-chip" style="background-color:#ffffff;color:#969063;border:1px solid #969063;display:none;">
                <button aria-label="Add credit" onclick="buttons.draw.buttons['credits'].OnClick('button');event.stopPropagation();" type="button" class="mdl-chip__action">
                    <i style="color:#969063;" class="material-icons">editor_choice</i>
                </button>
                <span class="mdl-chip__text">Credits</span>
            </div>
        </div>
            </div>
        </div>
            </div>
        </div>
		</div>                <!-- TIME: -->
                <li class="session_detail_time" style="color:#666;font-size: 1.0em;">
                    <div style="display:flex; justify-content:space-between;">
                        <button class="session_detail_day text_bannercolor button_style_override" onclick="DateTimeClicked('urn:eventpilot:all:agenda:filter:day=2024-08-01')">
                            Thu, Aug 01
                        </button>
                        <span class="session_detail_location">
                            <img alt="Location Icon" class="bannercolor" style="width:16px; height:16px; margin-right:5px;" src="page_data_002/mini_map.png"><a class="text_bannercolor" aria-label="location: Alliance Ballroom 321" style="text-decoration:none;" href="https://eppro02.ativ.me/web/page.php?page=MapViewWeb&amp;project=AIAAASCEND24&amp;name=FL-14%3A+Aviation+Operations+and+other+Applications+of+Autonomy&amp;path=avasmasterfloorplancalmresize.jpg&amp;table=agenda&amp;id=491255&amp;action=pindrop" rel="external">Alliance Ballroom 321</a>
                        </span>
                    </div>
                    <div style="display:flex; justify-content:space-between;">
                        <button class="session_detail_day text_bannercolor button_style_override" onclick="DateTimeClicked('urn:eventpilot:all:agenda:filter:day=2024-08-01|time=15_30_00-17_00_00')">
                            3:30pm - 5:00pm &nbsp; (Pacific)
                        </button>
                        <div class="sessionnumber"></div>
                        
                    </div>
                    <div style="display:flex; justify-content:space-between;">
                        <div class="session_detail_day text_bannercolor">
                                    <!-- TimezoneTranslationDraw -->
        <div id="timezoneTranslation_timzonetranslatoruidraw_container">
            <div id="timezoneTranslation_timzonetranslatoruidraw_activity" class="timzonetranslatoruidraw_activity"><svg style="fill:#555" width="18" height="18" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring"><circle cx="50" cy="50" ng-attr-r="{{config.radius}}" ng-attr-stroke-width="{{config.width}}" ng-attr-stroke="{{config.stroke}}" ng-attr-stroke-dasharray="{{config.dasharray}}" fill="none" stroke-linecap="round" r="40" stroke-width="4" stroke="#555" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(34.6018 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg></div>
            <button id="timezoneTranslation_timzonetranslatoruidraw_timezone_display" class="timzonetranslatoruidraw_display button_style_override" onclick="timezoneTranslation.ShowDialog()"><span class="settimezone_placeholder">See in my timezone</span></button>     
                        <div onclick="timezoneTranslation.setTimezoneDialog.Hide();" id="timezoneTranslation_setTimezoneDialog_customdialog_dark_overlay" class="customdialog_dark_overlay"></div>
            <div id="timezoneTranslation_setTimezoneDialog_customdialog_container" class="customdialog_container">
                        <div class="timezonetranslationdraw_dialog_contents">
            <div class="timezonetranslationdraw_dialog_header">Set Timezone</div>
            <div id="timezoneTranslation_timezone_selector" class="timezone_selector">

    <label for"timezonetranslation_timezone_selector_input"="" class="">Timezone</label>
    <div class="select_dropdown">
        <select id="timezoneTranslation_timezone_selector_input" class="timezone_select" onchange="timezoneTranslation.TranslateTime(this.value)">
                    <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Honolulu" data-val="Pacific/Honolulu" value="Pacific/Honolulu" selected="selected">(GMT-10:00) Hawaii</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Anchorage" data-val="America/Anchorage" value="America/Anchorage">(GMT-09:00) Alaska</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Los_Angeles" data-val="America/Los_Angeles" value="America/Los_Angeles">(GMT-08:00) Pacific Time (US &amp; Canada)</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Phoenix" data-val="America/Phoenix" value="America/Phoenix">(GMT-07:00) Arizona</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Denver" data-val="America/Denver" value="America/Denver">(GMT-07:00) Mountain Time (US &amp; Canada)</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Chicago" data-val="America/Chicago" value="America/Chicago">(GMT-06:00) Central Time (US &amp; Canada)</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/New_York" data-val="America/New_York" value="America/New_York">(GMT-05:00) Eastern Time (US &amp; Canada)</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Indiana/Indianapolis" data-val="America/Indiana/Indianapolis" value="America/Indiana/Indianapolis">(GMT-05:00) Indiana (East)</option>
<option style="color:#777; text-align:center;"></option>        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Kwajalein" data-val="Kwajalein" value="Kwajalein">(GMT-12:00) International Date Line West</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Midway" data-val="Pacific/Midway" value="Pacific/Midway">(GMT-11:00) Midway Island</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Samoa" data-val="Pacific/Samoa" value="Pacific/Samoa">(GMT-11:00) Samoa</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Tijuana" data-val="America/Tijuana" value="America/Tijuana">(GMT-08:00) Tijuana, Baja California</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Chihuahua" data-val="America/Chihuahua" value="America/Chihuahua">(GMT-07:00) Chihuahua</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Mazatlan" data-val="America/Mazatlan" value="America/Mazatlan">(GMT-07:00) Mazatlan</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Regina" data-val="America/Regina" value="America/Regina">(GMT-06:00) Saskatchewan</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Tegucigalpa" data-val="America/Tegucigalpa" value="America/Tegucigalpa">(GMT-06:00) Central America</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Mexico_City" data-val="America/Mexico_City" value="America/Mexico_City">(GMT-06:00) Mexico City</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Monterrey" data-val="America/Monterrey" value="America/Monterrey">(GMT-06:00) Monterrey</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Bogota" data-val="America/Bogota" value="America/Bogota">(GMT-05:00) Bogota</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Lima" data-val="America/Lima" value="America/Lima">(GMT-05:00) Lima</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Rio_Branco" data-val="America/Rio_Branco" value="America/Rio_Branco">(GMT-05:00) Rio Branco</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Caracas" data-val="America/Caracas" value="America/Caracas">(GMT-04:30) Caracas</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Halifax" data-val="America/Halifax" value="America/Halifax">(GMT-04:00) Atlantic Time (Canada)</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Manaus" data-val="America/Manaus" value="America/Manaus">(GMT-04:00) Manaus</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Santiago" data-val="America/Santiago" value="America/Santiago">(GMT-04:00) Santiago</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/La_Paz" data-val="America/La_Paz" value="America/La_Paz">(GMT-04:00) La Paz</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/St_Johns" data-val="America/St_Johns" value="America/St_Johns">(GMT-03:30) Newfoundland</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Argentina/Buenos_Aires" data-val="America/Argentina/Buenos_Aires" value="America/Argentina/Buenos_Aires">(GMT-03:00) Georgetown</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Sao_Paulo" data-val="America/Sao_Paulo" value="America/Sao_Paulo">(GMT-03:00) Brasilia</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Godthab" data-val="America/Godthab" value="America/Godthab">(GMT-03:00) Greenland</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="America/Montevideo" data-val="America/Montevideo" value="America/Montevideo">(GMT-03:00) Montevideo</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Atlantic/South_Georgia" data-val="Atlantic/South_Georgia" value="Atlantic/South_Georgia">(GMT-02:00) Mid-Atlantic</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Atlantic/Azores" data-val="Atlantic/Azores" value="Atlantic/Azores">(GMT-01:00) Azores</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Atlantic/Cape_Verde" data-val="Atlantic/Cape_Verde" value="Atlantic/Cape_Verde">(GMT-01:00) Cape Verde Is.</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Dublin" data-val="Europe/Dublin" value="Europe/Dublin">(GMT) Dublin</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Lisbon" data-val="Europe/Lisbon" value="Europe/Lisbon">(GMT) Lisbon</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/London" data-val="Europe/London" value="Europe/London">(GMT) London</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Africa/Monrovia" data-val="Africa/Monrovia" value="Africa/Monrovia">(GMT) Monrovia</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Atlantic/Reykjavik" data-val="Atlantic/Reykjavik" value="Atlantic/Reykjavik">(GMT) Reykjavik</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Africa/Casablanca" data-val="Africa/Casablanca" value="Africa/Casablanca">(GMT) Casablanca</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Belgrade" data-val="Europe/Belgrade" value="Europe/Belgrade">(GMT+01:00) Belgrade</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Bratislava" data-val="Europe/Bratislava" value="Europe/Bratislava">(GMT+01:00) Bratislava</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Budapest" data-val="Europe/Budapest" value="Europe/Budapest">(GMT+01:00) Budapest</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Ljubljana" data-val="Europe/Ljubljana" value="Europe/Ljubljana">(GMT+01:00) Ljubljana</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Prague" data-val="Europe/Prague" value="Europe/Prague">(GMT+01:00) Prague</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Sarajevo" data-val="Europe/Sarajevo" value="Europe/Sarajevo">(GMT+01:00) Sarajevo</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Skopje" data-val="Europe/Skopje" value="Europe/Skopje">(GMT+01:00) Skopje</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Warsaw" data-val="Europe/Warsaw" value="Europe/Warsaw">(GMT+01:00) Warsaw</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Zagreb" data-val="Europe/Zagreb" value="Europe/Zagreb">(GMT+01:00) Zagreb</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Brussels" data-val="Europe/Brussels" value="Europe/Brussels">(GMT+01:00) Brussels</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Copenhagen" data-val="Europe/Copenhagen" value="Europe/Copenhagen">(GMT+01:00) Copenhagen</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Madrid" data-val="Europe/Madrid" value="Europe/Madrid">(GMT+01:00) Madrid</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Paris" data-val="Europe/Paris" value="Europe/Paris">(GMT+01:00) Paris</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Africa/Algiers" data-val="Africa/Algiers" value="Africa/Algiers">(GMT+01:00) West Central Africa</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Amsterdam" data-val="Europe/Amsterdam" value="Europe/Amsterdam">(GMT+01:00) Amsterdam</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Berlin" data-val="Europe/Berlin" value="Europe/Berlin">(GMT+01:00) Berlin</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Rome" data-val="Europe/Rome" value="Europe/Rome">(GMT+01:00) Rome</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Stockholm" data-val="Europe/Stockholm" value="Europe/Stockholm">(GMT+01:00) Stockholm</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Vienna" data-val="Europe/Vienna" value="Europe/Vienna">(GMT+01:00) Vienna</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Minsk" data-val="Europe/Minsk" value="Europe/Minsk">(GMT+02:00) Minsk</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Africa/Cairo" data-val="Africa/Cairo" value="Africa/Cairo">(GMT+02:00) Cairo</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Helsinki" data-val="Europe/Helsinki" value="Europe/Helsinki">(GMT+02:00) Helsinki</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Riga" data-val="Europe/Riga" value="Europe/Riga">(GMT+02:00) Riga</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Sofia" data-val="Europe/Sofia" value="Europe/Sofia">(GMT+02:00) Sofia</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Tallinn" data-val="Europe/Tallinn" value="Europe/Tallinn">(GMT+02:00) Tallinn</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Vilnius" data-val="Europe/Vilnius" value="Europe/Vilnius">(GMT+02:00) Vilnius</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Athens" data-val="Europe/Athens" value="Europe/Athens">(GMT+02:00) Athens</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Bucharest" data-val="Europe/Bucharest" value="Europe/Bucharest">(GMT+02:00) Bucharest</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Istanbul" data-val="Europe/Istanbul" value="Europe/Istanbul">(GMT+02:00) Istanbul</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Jerusalem" data-val="Asia/Jerusalem" value="Asia/Jerusalem">(GMT+02:00) Jerusalem</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Amman" data-val="Asia/Amman" value="Asia/Amman">(GMT+02:00) Amman</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Beirut" data-val="Asia/Beirut" value="Asia/Beirut">(GMT+02:00) Beirut</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Africa/Windhoek" data-val="Africa/Windhoek" value="Africa/Windhoek">(GMT+02:00) Windhoek</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Africa/Harare" data-val="Africa/Harare" value="Africa/Harare">(GMT+02:00) Harare</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Kuwait" data-val="Asia/Kuwait" value="Asia/Kuwait">(GMT+03:00) Kuwait</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Riyadh" data-val="Asia/Riyadh" value="Asia/Riyadh">(GMT+03:00) Riyadh</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Baghdad" data-val="Asia/Baghdad" value="Asia/Baghdad">(GMT+03:00) Baghdad</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Africa/Nairobi" data-val="Africa/Nairobi" value="Africa/Nairobi">(GMT+03:00) Nairobi</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Tbilisi" data-val="Asia/Tbilisi" value="Asia/Tbilisi">(GMT+03:00) Tbilisi</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Moscow" data-val="Europe/Moscow" value="Europe/Moscow">(GMT+03:00) Moscow</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Europe/Volgograd" data-val="Europe/Volgograd" value="Europe/Volgograd">(GMT+03:00) Volgograd</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Tehran" data-val="Asia/Tehran" value="Asia/Tehran">(GMT+03:30) Tehran</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Muscat" data-val="Asia/Muscat" value="Asia/Muscat">(GMT+04:00) Muscat</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Baku" data-val="Asia/Baku" value="Asia/Baku">(GMT+04:00) Baku</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Yerevan" data-val="Asia/Yerevan" value="Asia/Yerevan">(GMT+04:00) Yerevan</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Yekaterinburg" data-val="Asia/Yekaterinburg" value="Asia/Yekaterinburg">(GMT+05:00) Ekaterinburg</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Karachi" data-val="Asia/Karachi" value="Asia/Karachi">(GMT+05:00) Karachi</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Tashkent" data-val="Asia/Tashkent" value="Asia/Tashkent">(GMT+05:00) Tashkent</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Kolkata" data-val="Asia/Kolkata" value="Asia/Kolkata">(GMT+05:30) Calcutta</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Colombo" data-val="Asia/Colombo" value="Asia/Colombo">(GMT+05:30) Sri Jayawardenepura</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Katmandu" data-val="Asia/Katmandu" value="Asia/Katmandu">(GMT+05:45) Kathmandu</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Dhaka" data-val="Asia/Dhaka" value="Asia/Dhaka">(GMT+06:00) Dhaka</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Almaty" data-val="Asia/Almaty" value="Asia/Almaty">(GMT+06:00) Almaty</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Novosibirsk" data-val="Asia/Novosibirsk" value="Asia/Novosibirsk">(GMT+06:00) Novosibirsk</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Rangoon" data-val="Asia/Rangoon" value="Asia/Rangoon">(GMT+06:30) Yangon (Rangoon)</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Krasnoyarsk" data-val="Asia/Krasnoyarsk" value="Asia/Krasnoyarsk">(GMT+07:00) Krasnoyarsk</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Bangkok" data-val="Asia/Bangkok" value="Asia/Bangkok">(GMT+07:00) Bangkok</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Jakarta" data-val="Asia/Jakarta" value="Asia/Jakarta">(GMT+07:00) Jakarta</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Brunei" data-val="Asia/Brunei" value="Asia/Brunei">(GMT+08:00) Beijing</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Chongqing" data-val="Asia/Chongqing" value="Asia/Chongqing">(GMT+08:00) Chongqing</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Hong_Kong" data-val="Asia/Hong_Kong" value="Asia/Hong_Kong">(GMT+08:00) Hong Kong</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Urumqi" data-val="Asia/Urumqi" value="Asia/Urumqi">(GMT+08:00) Urumqi</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Irkutsk" data-val="Asia/Irkutsk" value="Asia/Irkutsk">(GMT+08:00) Irkutsk</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Ulaanbaatar" data-val="Asia/Ulaanbaatar" value="Asia/Ulaanbaatar">(GMT+08:00) Ulaan Bataar</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Kuala_Lumpur" data-val="Asia/Kuala_Lumpur" value="Asia/Kuala_Lumpur">(GMT+08:00) Kuala Lumpur</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Singapore" data-val="Asia/Singapore" value="Asia/Singapore">(GMT+08:00) Singapore</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Taipei" data-val="Asia/Taipei" value="Asia/Taipei">(GMT+08:00) Taipei</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Perth" data-val="Australia/Perth" value="Australia/Perth">(GMT+08:00) Perth</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Seoul" data-val="Asia/Seoul" value="Asia/Seoul">(GMT+09:00) Seoul</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Tokyo" data-val="Asia/Tokyo" value="Asia/Tokyo">(GMT+09:00) Tokyo</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Yakutsk" data-val="Asia/Yakutsk" value="Asia/Yakutsk">(GMT+09:00) Yakutsk</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Darwin" data-val="Australia/Darwin" value="Australia/Darwin">(GMT+09:30) Darwin</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Adelaide" data-val="Australia/Adelaide" value="Australia/Adelaide">(GMT+09:30) Adelaide</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Canberra" data-val="Australia/Canberra" value="Australia/Canberra">(GMT+10:00) Canberra</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Melbourne" data-val="Australia/Melbourne" value="Australia/Melbourne">(GMT+10:00) Melbourne</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Sydney" data-val="Australia/Sydney" value="Australia/Sydney">(GMT+10:00) Sydney</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Brisbane" data-val="Australia/Brisbane" value="Australia/Brisbane">(GMT+10:00) Brisbane</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Australia/Hobart" data-val="Australia/Hobart" value="Australia/Hobart">(GMT+10:00) Hobart</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Vladivostok" data-val="Asia/Vladivostok" value="Asia/Vladivostok">(GMT+10:00) Vladivostok</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Guam" data-val="Pacific/Guam" value="Pacific/Guam">(GMT+10:00) Guam</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Port_Moresby" data-val="Pacific/Port_Moresby" value="Pacific/Port_Moresby">(GMT+10:00) Port Moresby</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Magadan" data-val="Asia/Magadan" value="Asia/Magadan">(GMT+11:00) Magadan</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Fiji" data-val="Pacific/Fiji" value="Pacific/Fiji">(GMT+12:00) Fiji</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Asia/Kamchatka" data-val="Asia/Kamchatka" value="Asia/Kamchatka">(GMT+12:00) Kamchatka</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Auckland" data-val="Pacific/Auckland" value="Pacific/Auckland">(GMT+12:00) Auckland</option>
        <option id="select_item_timezoneTranslation_timezone_selector" data-label="Pacific/Tongatapu" data-val="Pacific/Tongatapu" value="Pacific/Tongatapu">(GMT+13:00) Nukualofa</option>

        </select>
    
</div>
        </div>
            </div>            
        </div>
                        </div>
                    </div>
                </div></li>
            </ul>    
		<script>
		//if we are in an iframe, hide the share link
		//if(window!=window.top) { $('.sessionShareLink').not('.mapSession').hide(); }

		function DateTimeClicked(urn){
			if(IsPlannerIframe()){
				try {
					var filters = GetPrefiltersFromPrefilterURN( urn );
		   			parent.UpdateFiltersFromWebapp('agenda', filters);
				}catch(err) {
			        console.log("UpdateFiltersFromWebapp() is not defined in the parent iframe.");
			    }
			} else {
				location.replace("page.php?page=Sessions&project=AIAAASCEND24&id=2024-08-01&filterUrn="+encodeURI(urn));
			}
		}
		</script>
	
	        <script>
                        var speakercell_1713556409875 = new SpeakerCellDraw('speakercell_1713556409875');
            $(document).ready(function(){
                            speakercell_1713556409875.Setup({personid:'1713556409875'}, function(id){
                epView.OpenDialog('page.php?page=speaker&project=AIAAASCEND24&id='+id);
            });
            });
        </script>
                <div id="speakercell_1713556409875_speakercelldraw_container" class="celluidraw_container speaker_cell" onmouseover="speakercell_1713556409875.ShowCellPopup($(this))" onmouseout="speakercell_1713556409875.HideCellPopup($(this))" data-info="eyJsaW5rIjoicGFnZS5waHA/cGFnZT1TcGVha2VyJnByb2plY3Q9QUlBQUFTQ0VORDI0JmlkPTE3MTM1NTY0MDk4NzUifQ==">
            <a tabindex="0" class="epcelldraw_link" onclick="speakercell_1713556409875.OnClick('1713556409875');" onkeyup="event.keyCode == 13 ? $(this).click() : '';">
                <div class="epcell_leftcontent">
                    
                </div>
                            <img class="cell_icon" src="page_data_002/62nywiej5.jpg" alt="image of Andrew Lacher">
                <div class="cell_info">
                            <h1 class="list_cell_title"><span>Andrew Lacher</span></h1>
                            <div class="epcelldraw_sub"><div>Chief Technologist, Future Airspace Operations</div></div>
                                <div class="epcelldraw_sub"><div>NASA Langley Research Center</div></div>
                </div>
                <div class="cell_action_container">
                            <div id="speakercell_1713556409875_note_quickadd_notequickaddbuttondraw_container" class="notequickadd_container">
            <div id="speakercell_1713556409875_note_quickadd_notequickaddbuttondraw_content" class="notequickadd_content" style="display:flex; flex-direction:column; align-items:center;">
                        <img class="quickadd_note quickadd" src="page_data_002/mini_note.png">
            </div>
        </div>        <div id="speakercell_1713556409875_like_quickadd_bookmarkquickaddbuttondraw_container" class="bookmarkquickadd_container">
            <div id="speakercell_1713556409875_like_quickadd_bookmarkquickaddbuttondraw_content" class="bookmarkquickadd_content">
                    <button aria-label="Add or remove like" title="Add or remove like" class="quickadd_like quickadd" data-id="1713556409875" onclick="speakercell_1713556409875.like_quickadd.OnClick(event)"></button>
            </div>
        </div>
                </div>
            </a>
        </div>	<div id="session_detail_description" class="detail_description">
		<script src="page_data_003/EPConnectInterface.js"></script>
		<script src="page_data_003/EPDefinesInterface_002.js"></script>
		<script src="page_data_003/EPTableInterface.js"></script>
		<script>
			var epConnect = new EPConnectInterface();
			var epFeed    = new EPFeedInterface();
			var epDefine  = new EPDefinesInterface();
		</script>
	    <div id="rating_session"><style>
#rating_container{
    position:absolute;
    top:0px;
    display:inline-block;
    width:auto;
    height:45px;
    /*margin:0 -15px;*/
    z-index: 2;
}
#rating_container #rate_scale{
    padding-left:5px;
    background-color: #003A70;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin:auto;
    display:none;
    transition:opacity .5s;
    box-shadow: 3px 3px 4px rgba(0,0,0,.3);
}
#rating_container #rate_button{
    padding-left:5px;
    background-color: #003A70;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin:auto;
    transition:opacity .5s;
    box-shadow: 3px 3px 4px rgba(0,0,0,.3);
    color: white;
    padding: 8px;
    padding-left: 20px;
    padding-right: 20px;
    cursor:pointer;
    text-shadow: none;
    border:none;
}
#rating_container #not_available{
    text-align: center;
    text-shadow: none;
    color:#777777;
    max-width: 600px;
    padding:18px;
    left:0;
    right:0;
    margin: auto;
    font-size: 1.3em;
    z-index:100;
}
#rating_container .rating{
    cursor:pointer;
    text-align:center;
    font-size: 0;
    padding: 0;
    border: 0;
    background: transparent;
}
#rating_container .rating img{
    height:27px;
    padding:7px 12px;
    transition:all .3s;
}
#rating_container .rating.deselected img{
    height:0px;
    padding:0;
}

#rating_container .rating.selected img{
    padding:5px 10px;
    height:25px;
}
#rating_container .rating:not(.selected):not(.deselected) img{
    image-rendering: optimizeSpeed;             /*                     */
    image-rendering: -moz-crisp-edges;          /* Firefox             */
    image-rendering: -o-crisp-edges;            /* Opera               */
    image-rendering: -webkit-optimize-contrast; /* Chrome (and Safari) */
    image-rendering: optimize-contrast;         /* CSS3 Proposed       */
    -ms-interpolation-mode: nearest-neighbor;   /* IE8+                */
}
#rating_survey{
    padding: 6px;
    font-size:1.2em;
    text-align:center;
    box-shadow: 3px 3px 4px rgba(0,0,0,.3);
    text-shadow:none;
    cursor:pointer;
    padding-left:25px;
    padding-right:25px;
    margin-left:15px;
    overflow:hidden;
    white-space:nowrap;
    transition:all 1s ease-in-out;
}

.rating_survey_nottaken{
    width:80px;
    background-color:#779EE5;
    color:white;
    border:none;
}

.rating_survey_taken{
    background-color:white;
    border:1px solid #CCC;
    color:#777;
}

.rating_survey_partial{
    background-color:white;
    border:1px solid #CCC;
    color:red;
}

</style>
<div id="rating_container" style="margin-left: -20px;"><button title="Rate this session" id="rate_button" onclick="ratingWidget.Rate()">Rate &nbsp;</button><div id="rate_scale"><button title="Did not attend" class="rating " data-rating="0" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="page_data_002/rate_w_0.png"> </button><button title="Rate session 1 out of 5." class="rating " data-rating="1" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="page_data_002/rate_w_1.png"> </button><button title="Rate session 2 out of 5." class="rating " data-rating="2" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="page_data_002/rate_w_2.png"> </button><button title="Rate session 3 out of 5." class="rating " data-rating="3" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="page_data_002/rate_w_3.png"> </button><button title="Rate session 4 out of 5." class="rating " data-rating="4" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="page_data_002/rate_w_4.png"> </button><button title="Rate session 5 out of 5." class="rating " data-rating="5" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="page_data_002/rate_w_5.png"> </button></div></div>
<script>

    var ratingWidget = null;

    var RatingWidget = function(){
        this.loggedin  = 'true';
        this.tableData = '';
        this.confTime  = '';
        this.confid    = 'AIAAASCEND24';
        this.tid       = '491255';
        this.os        = 'web';
        this.startdate = '';
        this.isSurvey  = false;
        this.rating    = '';

        RatingWidget.prototype.SetResponse = function(confid, table, type, tid, idx, val, success){
            if(success){
                if(this.isSurvey){
                }else{
                    var rating = val;
                    var ratings = document.getElementsByClassName('rating')
                    for(var i = 0; i < ratings.length; i++){
                    ratings.item(i).classList.add("deselected");
                    ratings.item(i).disabled = true;
                    }
                    document.querySelector('.rating[data-rating="'+rating+'"]').classList.remove("deselected");
                    document.querySelector('.rating[data-rating="'+rating+'"]').classList.add("selected");
                    document.querySelector('.rating[data-rating="'+rating+'"]').disabled=false;
                }
            }else{
                console.log("Set failed");
            }
        };

        RatingWidget.prototype.GetEPConnectResponse = function(confid, table, type, tid, idx, val, success){

            if(this.isSurvey){
                if(success){
                    this.rating = val; // Store our current rating
                    //console.log("SetupSurvey("+val);
                    this.SetupSurvey(val);
                }else{
                    //console.log("SetupSurvey("+val);
                    this.SetupSurvey(0);
                }
            }else{
                //console.log("!IsSurvey GetEPConnectResponse");
                /* Do not check for success, as in this case, a failure is a valid response
                    indicating no rating for this item, in which case the widget should still
                    be drawn
                */
               
                var ratingStr = '<button title="Rate this session" id="rate_button" onclick="ratingWidget.Rate()">Rate &nbsp;&#x2605;</button>';
                ratingStr += '<div id="rate_scale">';
                var sessionRating = parseInt(val);
                for(var i=0; i<6; i++){
                    var selectedText = '';
                    var disabled = '';
                    if(sessionRating >= 0){
                        // If we get here, there is a session rating
                        selectedText = 'deselected';
                        disabled = 'disabled';
                        if(sessionRating == i){
                            selectedText = 'selected';
                            disabled = '';
                        }
                    }
                    let title = 'Rate session '+i+' out of 5.';
                    if(i == 0){
                        title = 'Did not attend';
                    }
                    ratingStr += '<button title="'+title+'" class="rating '+ selectedText +'" '+disabled+' data-rating="'+ i +'" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="../doc/common/images//rate_w_'+ i +'.png"> </button>';
                }
                ratingStr += '</div>';
                // Forcing the margin negative to compensate for the margin around the detail view description area
                //$('#rating_container').css('margin-left', '-15px');
                if(this.os == 'web'){
                    if(this.isSurvey){
                        $('#rating_container').css('margin-left', '-30px');
                    }else{
                        $('#rating_container').css('margin-left', '-20px');
                    }
                }else{
                    if(this.isSurvey){
                        $('#rating_container').css('margin-left', '-25px');
                    }else{
                        $('#rating_container').css('margin-left', '-15px');
                    }
                }
                document.getElementById('rating_container').innerHTML = ratingStr;

                if(sessionRating >= 0){
                    $('#rate_scale').css('display', 'flex');
                    $('#rate_button').css('display', 'none');
                }
            }
        };

        RatingWidget.prototype.SubmitRating = function(elem){
            var table    = 'agenda';
            if(elem.classList.contains('selected')){
                var elems = document.querySelectorAll(".rating");

                [].forEach.call(elems, function(el) {
                    el.classList.remove("deselected");
                    el.classList.remove("selected");
                    el.disabled = false;
                });
            } else {
                if(this.loggedin == "true"){

                    var rating = elem.getAttribute('data-rating');
                    var idx    = '';

                    epConnect.Set(this.confid, table, 'rating', this.tid, idx, rating, this);

                } else {
                    epView.Login();
                }
            }
        }

        RatingWidget.prototype.SetupRatingWithTableData = function (){
            var local = this;
            var table = 'agenda';
            epDefine.GetDefine(local.confid, 'EP_START_DATE', function(err, define, value){
                if(err['success'] == true){
                    local.startdate = value; // Start date of the event

                    epTable.GetTableData(local.confid, table, local.tid, function(err, table, tid, data){
                        if(typeof data === "string"){ // If we receive a string json decode it
                            local.tableData = JSON.parse(data); // Convert it to an object so we can decode it below
                        }else{
                            local.tableData = data;
                        }
                        epConnect.GetLoggedIn(local.confid, local);
                        //epConnect.GetTime(local.confid, local);
                    });

                    if(typeof epView !== 'undefined') {
                        epView.RegisterForViewEvents(local);
                    }
                }else{
                    console.log(err['msg']);
                }
            });
        }

        RatingWidget.prototype.GoToSurvey = function(link){
            if(this.loggedin == "true"){
                //epConnect.Set(this.confid, "agenda", "rating", "491255", "", "-1", this);
                epView.OpenDialog(link, {'confid':this.confid}); // Got our location
            } else {
                epView.Login();
            }
        }

        // Rating = 0 (not taken)
        // Rating = -1 (partially complete)
        // Rating = 1 (completed)
        RatingWidget.prototype.SetupSurvey = function (rating){
            var local = this;

            /*
            epDefine.GetDefine(this.confid, 'EP_SURVEY_MATCHING_TYPES', function(err, define, value){
                if(err['success'] == true){
                    console.log("EP_SURVEY_MATCHING_TYPES "+value);
                    if(value.length > 0){
            */
            // Check if we have a survey for this session
            var formdata = {'interface':'survey', 'action':'getsurveyids', 'adapter':'web_survey', 'confid':this.confid, 'eptable':'agenda', 'tid':this.tid};
            epWebAuth.EPWebPost('https://eppro02.ativ.me/web/api.php', formdata, function(msg, data){
                if(msg.success){
                    var json = JSON.parse(data);
                    if(json != null && json.surveyids.length > 0){

                        var tmp = 'rating_survey_nottaken';
                        var title = "Survey";
                        if(rating == -1){
                            title = "Survey Incomplete";
                            tmp = 'rating_survey_partial';
                        }else if(rating == 1){
                            title = "\u2713";
                            tmp = 'rating_survey_taken';
                        }

                        // http://localhost:8888/web/page.php?page=custom&id=survey&project=QA6&tid=236&eptable=agenda&nav=false
                        var link = 'https://eppro02.ativ.me/web/page.php?page=custom&id=survey&project='+local.confid+'&tid='+local.tid+'&eptable=agenda&navtmp=false&title=Survey';

                        var os = 'web';
                        if(local.os == 'web'){
                            // Use the link as it is
                        }else{ // Native, put the link in an auto-login URN
                            link = local.utf8_to_b64(unescape(encodeURIComponent( link ))); // Clear newlines or we break the b64
                            for(var idx = 0;idx < (link.length % 4);idx++){
                                link += "=";
                            }
                            link = link.replace(/=/g, '##EQUAL##');
                            link = 'urn:eventpilot:all:html:post:b64url='+link+'|username='+encodeURIComponent('5642')+'|password='+encodeURIComponent('##PASSWORD##')+'|confid='+encodeURIComponent('AIAAASCEND24')+'|webauth=true';
                        }

                        // Set rating so we mark this survey as taken
                        var ratingStr = '<div id="rate_survey"><div id="rating_survey" class="'+tmp+'" onclick=\'ratingWidget.GoToSurvey(\"'+link+'\")\'  tabindex=\'0\'  onkeyup="event.keyCode == 13 ? $(this).click() : \'\';">'+title+'</div></div>';

                        //console.log("Link: "+link);
                        document.getElementById('rating_container').innerHTML = ratingStr;

                        /*
                        var onclick = "";
                        var json = JSON.parse(value);
                        if(Object.values(json).includes(local.tableData.categoryid)){
                            document.getElementById('rating_container').innerHTML = ratingStr;
                        }else if(json.length == 0){
                            document.getElementById('rating_container').innerHTML = ratingStr;
                        }else{
                            local.isSurvey = false;
                            console.log("Survey data empty");
                            local.SetupRating();
                            return;
                        }
                        */

                        if(local.os == 'web'){
                            if(local.isSurvey){
                                $('#rating_container').css('margin-left', '-30px');
                            }else{
                                $('#rating_container').css('margin-left', '-20px');
                            }
                        }else{
                            if(local.isSurvey){
                                $('#rating_container').css('margin-left', '-25px');
                            }else{
                                $('#rating_container').css('margin-left', '-15px');
                            }
                        }
                    }else{
                        local.isSurvey = false;
                        console.log("Survey data empty");
                        local.SetupRating();
                    }
                }else{
                    console.log(err['msg']);
                }
            });
        }

        RatingWidget.prototype.IsSurvey = function(){
            return this.isSurvey;
        }

        RatingWidget.prototype.Setup = function(){
            //console.log("Setup");
            var local  = this;

            epDefine.GetDefine(local.confid, 'EP_WIDGET_SURVEY', function(err, define, value){
                if(err['success'] == true){
                    if(value == 'true'){
                        // check for surveys only appearing for parent sessions
                        epDefine.GetDefine(local.confid, 'EP_SURVEY_PARENT_ONLY', function(err, define, value){
                            if(err['success'] == true){
                                if (((value != 'false') && (local.tableData['parent'].length == 0)) || (value == 'false')) {
                                    // this is a parent, or the toggle is off
                                    local.isSurvey = true;
                                    var table     = 'agenda';
                                    var idx       = '';
                                    epConnect.Get(local.confid, table, 'rating', local.tid, idx, local);
                                } else {
                                    local.isSurvey = false;
                                    local.SetupRating();
                                }
                            }
                        });
                    }else{
                        //console.log("Widget Survey Disabled");
                        local.isSurvey = false;
                        local.SetupRating();
                        /*
                        var table     = 'agenda';
                        var idx       = '';
                        epConnect.Get(local.confid, table, 'rating', local.tid, idx, local);
                        */
                    }
                }else{
                    console.log(err['msg']);
                }
            });
        }

        RatingWidget.prototype.Rate = function (){
            // Opens rating widget
            $('#rate_scale').css('display', 'flex');
            $('#rate_button').css('display', 'none');
        }

        RatingWidget.prototype.SetupRating = function (){

            // console.log("rating widget setuprating");
            var table     = 'agenda';
            var idx       = '';
            if(this.loggedin == "true"){
                epConnect.Get(this.confid, table, 'rating', this.tid, idx, this);
            } else {
                
                var ratingStr = '<button title="Rate this session" id="rate_button" onclick="ratingWidget.Rate()">Rate &#x2605;</button>';
                ratingStr += '<div id="rate_scale">';
                for(var i=0; i<6; i++){
                    let title = 'Rate session '+i+' out of 5.';
                    if(i == 0){
                        title = 'Did not attend';
                    }
                    ratingStr += '<button title="'+title+'" class="rating" data-rating="'+ i +'" onclick="ratingWidget.SubmitRating(this)"> <img alt="" src="../doc/common/images//rate_w_'+ i +'.png"> </button>';
                }
                ratingStr += '</div>';
                document.getElementById('rating_container').innerHTML = ratingStr;
                //document.getElementById('rate_scale').style.opacity = '0';
            }
        }

        RatingWidget.prototype.SetSessionRated = function (id){
            var storageObj;
            var ratedSessions = [];
            var storageIdx = 'AIAAASCEND24_'+epConnect.upid+'_agenda_rated_items';

            storageObj = GetLocalStorageItem(storageIdx);

            if(storageObj != null && storageObj != ''){
                ratedSessions = JSON.parse(storageObj);
            }

            ratedSessions.push(id);

            SetLocalStorageItem(storageIdx, JSON.stringify(ratedSessions));
        };

        RatingWidget.prototype.utf8_to_b64 = function(str) {
            return window.btoa(unescape(encodeURIComponent( str )));
        }

        RatingWidget.prototype.GetDate = function(){
            var d = new Date(),
                month = '' + (d.getMonth() + 1),
                day = '' + d.getDate(),
                year = d.getFullYear();

            if (month.length < 2) 
                month = '0' + month;
            if (day.length < 2) 
                day = '0' + day;

            return [year, month, day].join('-');            
        }        

        RatingWidget.prototype.GetTimeResponse = function (confTime, unixTs){
            // console.log("rating widget gettimeresponse");
            this.confTime = confTime;
            /*
                We need to perform several operations on the date string.
                Replace - with / to support safari date parse limitations
                replace the seconds with 00 because they are returned as 00-99 by iOS
            */
            if(this.tableData['date'].length == 0){ // This is an on demand session
                // Session date greater than event start date
                if(this.GetDate().localeCompare(this.startdate) >= 0){ // Are we later than the session start
                    this.Setup();
                }else{
                    document.getElementById('rating_container').style.height = '20px';
                    document.getElementById('rating_container').style.backgroundColor = 'transparent';                    
                }
            }else{
                confTime = confTime.replace(/-/g, '/').slice(0, -2) + '00';
                var sessionDate = this.tableData['date'].replace(/-/g, '/');
                var sessionStop = this.tableData['stop'];
                var stopDateStr = sessionDate+" "+sessionStop;

                var t = new Date(confTime);
                var now = t.getTime();
                var d = new Date(stopDateStr);
                // Subtract 3 minutes from stop time before showing rating or survey widget
                var ratingStartTime = d.getTime() - 3*60000;

                if(now < ratingStartTime){
                    document.getElementById('rating_container').style.height = '20px';
                    document.getElementById('rating_container').style.backgroundColor = 'transparent';
                } else {
                    this.Setup();
                }
            }

            if(this.os == 'web'){
                if(this.isSurvey){
                    $('#rating_container').css('margin-left', '-30px');
                }else{
                    $('#rating_container').css('margin-left', '-20px');
                }
            }else{
                if(this.isSurvey){
                    $('#rating_container').css('margin-left', '-25px');
                }else{
                    $('#rating_container').css('margin-left', '-15px');
                }
            }
        }

        RatingWidget.prototype.OnPause = function (){
        };

        RatingWidget.prototype.HideSurveyComplete = function(){
            if(this.isSurvey && this.rating.length > 0 && this.rating == 1){
                if(this.os == 'web'){
                    $('#rating_survey').css('margin-left', '-140px');//addClass('rating_survey_small');
                }else{
                    $('#rating_survey').css('margin-left', '-160px');//addClass('rating_survey_small');
                }
            }
        }

        RatingWidget.prototype.Start = function(){
            this.SetupRatingWithTableData();
        }

        RatingWidget.prototype.OnResume = function (){
            //console.log("rating widget onresume()");
            epConnect.GetLoggedIn(this.confid, this);
        };

        RatingWidget.prototype.GetLoggedInResponse = function (confid, loggedin){
            this.loggedin = loggedin;
            //console.log("rating widget getloggedinresponse: "+this.loggedin);
            epConnect.GetTime(this.confid, this);
        };

    }; // Rating Widget

    function InitiateRatingSetup(){
        ratingWidget = new RatingWidget();
        ratingWidget.Start();
    }

    $(document).ready(function(){
        setTimeout(function(){
            InitiateRatingSetup();
        }, 1000);
    });

//# sourceURL=EP_WIDGET_RATING-9_0_0.js
</script>
</div><p><b>Location:</b> Alliance Ballroom 321</p><p>Autonomous systems
 will be both enabling and enhancing for future aviation applications. 
These will enable (a) more safe and efficient operations for legacy 
operators and (b) potential new aviation entrants. The need for autonomy
 is driven by the need to maintain or improve safety while increasing 
efficiency and providing access to new entrants.  Architecting 
autonomous systems and their operational integration presents 
significant challenges to our existing systems engineering paradigms. 
Modern digital engineering techniques offer the promise of more thorough
 exploration of the constraint space, more rigorous performance of the 
performance/cost/risk trades, and better management of mission and 
system complexity. Realizing the full potential of these techniques 
requires us to get a good understanding of (i) the constraints and 
requirements of these applications, (ii) how these drive system autonomy
 capabilities, and (iii) how metrics can be used to assess the safety 
and effectiveness. This Workshop will leverage the breadth and depth of 
expertise of the AIAA AVIATION community, to study a representative set 
of aviation applications and perform an initial analysis of these 
applications to develop such understanding. The Workshop will have three
 phases: 1. [Plenary] Introduction of an initial set of reference 
aviation applications enabled by the availability of greater autonomy, 
and background work from the AIAA Transformative Systems Engineering 
Task Force. 2. [Breakout groups] Groups representing different segments 
of the aviation community will brainstorm additional reference 
applications in their areas that are enabled or significantly enhanced 
by the infusion of greater autonomy and will produce a few PowerPoint 
slides describing each of their mission use cases, including the 
autonomy-related concept, the driving needs/requirements for the 
application, and the associated metrics to assess success. 3. [Plenary] 
The groups will reconvene to share key aspects of their mission use 
cases, and will discuss similarities and differences across the 
different segments. This AVIATION Workshop will feed directly into the 
products of the AIAA Transformative Systems Engineering Task Force and 
will also help shape the work of the AIAA Autonomy/AI/ML Task Force. The
 organizers of the session will capture the highlights of the discussion
 in a white paper to be provided to AIAA within 30 days of the 
conference. Confirmed Participants: Andy Lacher (NASA Langley Research 
Center) </p><div style="margin:0px 0">
<style>
.filters{
    padding: 20px 0;
}
.filter_name{
    font-weight:600 !important;
    font-size:1.0em;
}

.filter_value{
    cursor: pointer;
    display: inline-block;
    border:none;
    text-shadow: none;
    font-size:1.0em;
    font-weight:300;
    padding: 5px 18px;
    border-radius: 18px;
    margin: 5px;
    margin-left: 0;
    background:#003A70 !important;
    color:#fff;
}
</style>
    <div class="filters"><div class="filter" aria-label="Format:" data-name="metaid1"><div style="font-weight:bold;" class="filter_name">Format</div><button aria-label="filter by Format: Flight Lab" data-role="none" class="filter_value bannercolor" data-name="Flight+Lab" onclick="DetailFilterItemClicked('page.php?page=Sessions&amp;project=AIAAASCEND24&amp;filterUrn=urn%3Aeventpilot%3Aall%3Aagenda%3Afilter%3Ametaid1%3DFlight+Lab', 'metaid1', 'Flight+Lab')">Flight Lab</button>
</div><div class="filter" aria-label="Type:" data-name="categoryid"><div style="font-weight:bold;" class="filter_name">Type</div><button aria-label="filter by Type: AVIATION Technical Workshop" data-role="none" class="filter_value bannercolor" data-name="AVIATION+Technical+Workshop" onclick="DetailFilterItemClicked('page.php?page=Sessions&amp;project=AIAAASCEND24&amp;filterUrn=urn%3Aeventpilot%3Aall%3Aagenda%3Afilter%3Acategoryid%3DAVIATION+Technical+Workshop', 'categoryid', 'AVIATION+Technical+Workshop')">AVIATION Technical Workshop</button>
</div><div class="filter" aria-label="Topic/Discipline:" data-name="metaid3"><div style="font-weight:bold;" class="filter_name">Topic/Discipline</div><button aria-label="filter by Topic/Discipline: Applied Autonomy and Reslient Systems" data-role="none" class="filter_value bannercolor" data-name="Applied+Autonomy+and+Reslient+Systems" onclick="DetailFilterItemClicked('page.php?page=Sessions&amp;project=AIAAASCEND24&amp;filterUrn=urn%3Aeventpilot%3Aall%3Aagenda%3Afilter%3Ametaid3%3DApplied+Autonomy+and+Reslient+Systems', 'metaid3', 'Applied+Autonomy+and+Reslient+Systems')">Applied Autonomy and Reslient Systems</button>
</div><div class="filter" aria-label="Category:" data-name="metaid2"><div style="font-weight:bold;" class="filter_name">Category</div><button aria-label="filter by Category: AVIATION Technical Workshop" data-role="none" class="filter_value bannercolor" data-name="AVIATION+Technical+Workshop" onclick="DetailFilterItemClicked('page.php?page=Sessions&amp;project=AIAAASCEND24&amp;filterUrn=urn%3Aeventpilot%3Aall%3Aagenda%3Afilter%3Ametaid2%3DAVIATION+Technical+Workshop', 'metaid2', 'AVIATION+Technical+Workshop')">AVIATION Technical Workshop</button>
</div></div>
                <script>
				function DetailFilterItemClicked(url, field, val){
				    if(IsPlannerIframe()){

                        var width = '90';
                        var msg = {'msg':'OpenDialog', 'url': url, 'width': width};
                        parent.postMessage(msg,'*');
                    }else {
                        epView.OpenDialog(url);
                    }
				}
				</script>
</div>	</div>
	
<!--
 *      ATIV Solutions LLC - Copyright 2020 - Confidential - support@ativsoftware.com property of ATIV Solutions LLC
 *      UIEPDraw - Implements a MDL (Material Design Lite) UI Base class for EPDraw (js + css) compatible for broad platform use
-->
<!--
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
-->

<script>
    var uiDrawTimeout;
    function UIDrawUpdateMDL() {
        clearTimeout(uiDrawTimeout);
        uiDrawTimeout = setTimeout(function() {
            componentHandler.upgradeAllRegistered();
        }, 50);
    }
</script>
<script>
    class UIEPDraw {
        constructor(id){
            var local    = this;
            if(typeof id != 'undefined'){
                this.obj     = id;
                this.prefix  = id.replace(/\./g, '_');
            }
            
        }

		Setup(id){
            var local    = this;
            this.obj     = id;
            this.prefix  = id.replace(/\./g, '_');
		}			

		MDLUpdate(){
			UIDrawUpdateMDL();
        }

        static DrawIconButton(id, func, icon, color){
            if(typeof color == 'undefined'){
                color = '#000000aa';
            }
            var click = '';
            if(func != '' && func != null){
                click = `onclick="${func}"`;
            }
            var html =`<button id="${id}" class="mdl-button mdl-js-button mdl-button--icon" ${click}>
                <i style='color:${color}' class="material-icons">${icon}</i>
                <svg style="fill:gray;display:none;background: none;width:20px;height:20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring"><circle cx="50" cy="50" ng-attr-r="{{config.radius}}" ng-attr-stroke-width="{{config.width}}" ng-attr-stroke="{{config.stroke}}" ng-attr-stroke-dasharray="{{config.dasharray}}" fill="none" stroke-linecap="round" r="40" stroke-width="4" stroke="gray" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(34.6018 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg>
            </button>`;
            return html;
        }
    }  
//# sourceURL=UIEPDraw.js
</script><!--
    ATIV Solutions LLC - Copyright 2020 - Confidential - support@ativsoftware.com property of ATIV Solutions LLC
    ContextMenuEPDraw - Implements a MDL (Material Design Lite) Context Menu in EPDraw (js + css) compatible for broad platform use
-->
<script>
    const MenuTemplate = ({id, pos, items}) => `
            <ul id="${id}_items" class="mdl-menu mdl-js-menu ${pos}" for="${id}">
                ${items}
            </ul>
        `;

    class ContextMenuEPDraw extends UIEPDraw { 
        constructor(callback){
            super();
            this.callback = callback;
        }

        Setup(id){
            super.Setup(id); // parent::Setup equivalent
        }

        OnMenuClick(id, index, action){
            if(this.callback != null){
                this.callback(id, index, action);
            }
        }
        
        GetHtml(id, items1, pos){
            var local = this;
            if(typeof pos == 'undefined'){
                pos = "mdl-menu--bottom-left";
            }

            var items = '';
            $(items1).each(function(index, value){
                var action = '';
                if(items1[index].hasOwnProperty('action')){
                    action = items1[index].action;
                }
                items += '<li class="mdl-menu__item" onclick="event.stopPropagation(); '+local.obj+'.OnMenuClick(\''+id+'\',\''+index+'\', \''+action+'\')">'+items1[index].title+'</li>';
            });
            var menu = [];
            menu.push( {id:id, pos:pos, items:items});
            var html = menu.map(MenuTemplate).join('');
            // Remove any existing menu
            $('#'+id+'_items').closest('.mdl-menu').remove();
            // Add the new menu
            $('#'+id).after(html);
            super.MDLUpdate();
            return html;
        }
    }// ContextMenuEPDraw
//# sourceURL=ContextMenuEPDraw.js
</script>    
    
    <style>
        .chat_parent{
            text-shadow:none;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .chat_container{
            width:100%;
            min-height:40px;
            max-width: 740px;
            margin: auto;
            padding-top:5px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            overflow: auto;
            scrollbar-width: none;
            /* for Firefox */
        }
        
        .chat_container::-webkit-scrollbar {
            display: none;
            /* for Chrome, Safari, and Opera */
        }

        .chat_input_flexitem{
            flex-grow:1;
            width: calc(100% - 60px);
            max-width:600px;
        }
        

        .message_mode{
            flex-direction: column-reverse;

        }
        .message_mode .chat_container{
            flex-direction: column-reverse;
        }
        .comment_mode .chat_item:last-child{
            margin-bottom: 130px;
        }
        .message_mode .chat_input_section_container{
            border:none;
            /* border-top:thin solid; */
        }

        .comment_mode .chat_input_section_container{
            border:none;
            /* border-bottom:thin solid; */
        }

        .chat_invalid_user{
            color:red;
            font-size:1.2em;
            background: #ffffffdd;
            position:fixed;
            top:0;
            left:0;
            right: 0;
            bottom: 0;
            z-index:1000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #chat_supertitle{
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
        #chat_title{
            margin:2px 0;
            font-size:1.6em;
            
        }
        #chat_subtitle{
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .chat_input:focus{
            height:3em;
        }

        .chat_input_section_container.pinned{
            position:fixed;
            top:0;
            left:0;
            right:0;
        }

        .chat_button_container{
            appearance: none;
            background: transparent;
            border: 3px solid #FFFFFF00;
            margin-top:-3px;
            margin-left:20px;
            border-radius:50%;
            padding:0;
            outline:none;
        }
        .chat_button_container:focus{
            border:3px solid;
        }

        .chat_disabled{
            position: absolute;
            top: 0;
            bottom:0;
            right:0;
            left:0;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align:center;
            z-index:1;
        }

        .send_active .chat_button{
            background-color:rgba(255, 255, 255, 0);
            opacity:1;
        }

        .chat_button:hover{
            background-color:rgba(255, 255, 255, .3);
        }
        
        .chat_item{
            margin:30px 15px 10px;
            display:flex;
            flex-direction: column;
            align-items: flex-start;
            overflow-wrap: anywhere;
        }
        .flagged_spam{
            height:15px;
            width:15px;
            margin-left:-10px;
            background:white;
            padding:5px;
            border-radius:50%;
            border: thin solid red;
            flex-shrink:0;
            z-index:0;
        }
        .flagged_spam svg{
            margin-top:-7px;
            height:100%;
            width:100%;
            fill:red;
        }

        #reply_box{
            display:none;
            background-color:#EEE;
            border-radius: 20px 5px 0 0;
            border: thin solid;
            border-bottom: none;
            z-index: 2;
            position: relative;
            margin-bottom: -4px;
        }
        .reply_container{
            display:flex;
            flex-grow: 1;
            overflow:auto;
            padding: 15px;
            
        }

        .reply_container .msg_bubble{
            margin:0 10px;
            width: calc(100% - 50px); /* container width minus padding */
        }

        .msg_container{
            display:flex;
            max-width:85%;
            min-width:210px;
            position:relative;
        }
        .user_reply .msg_container{
            max-width: 100%;
            width:100%;
        }
        .chat_item.user_msg, .chat_item.user_msg .msg_container{
            justify-content:flex-end;
            align-items: flex-end;
            text-align: right;
        }
        .name_container{
            color:#777;
            font-size:12px;
            height:18px;
            max-width:85%;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
        .hidden_message{
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #eee;
            font-style: italic;
            color:#666;
            font-size:14px;
            
        }
        .chat_container .name_container{
            margin:-18px 20px 0;
        }

        .msg_reply .user_photo{
            z-index: 2;
            position: relative;
        }
        .default_message_container{
            text-align: center;
            padding: 10px 20px;
            font-size: 18px;
            font-weight: 200;
            margin:auto;
            min-height:20px;
            max-width: 600px;
            color:#333;
            border-radius:5px;
        }
        .msg_container .msg_bubble{
            padding:10px 10px 10px 30px;
            min-height:20px;
            background-color:#eee;
            border-radius:5px;
            display: flex;
            justify-content: space-between;
            width: 100%;
            position:relative;
        }

        
        .msg_container .kabab_container{
            margin:0 0 0 10px;
            height:25px;
            width:25px;
            cursor: pointer;
            border-radius:50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .msg_container .kabab_container:focus, .msg_container .kabab_container:hover{
            background-color: #ffffff99;
        }
        .msg_text{
            text-align:left;
            word-break: break-word;
            font-size: 15px;
        }

        .msg_container .kabab_container .icon_kabab{
            height:15px;
            width:15px;
            fill:#777
        }
        .user_msg .kabab_container{
            margin:0 10px 0 0 ;
        }
        .user_icon{
            border-radius:50%;
            overflow:hidden;
            height:40px;
            width:40px;
            position:relative;
            z-index:1;

            flex-shrink:0;
            align-self: flex-start;
        }
        .chat_container .user_icon{
            margin:0 -20px 0 0;
        }
        .reply_container .user_icon{
            margin:-15px 0 0 -15px;
        }
        .user_photo{
            background-size:cover;
            background-position: center;
            background-color:#eeeeee;
            height:40px;
            width:40px;
        }
        .ep_monogram{
            flex-shrink:0;
        }
        .user_msg:not(.user_reply) .user_icon{
            margin:0 0 0 -20px;
            
        }
        .char_limit_msg{
            text-align:right;
            color:white;
        }
        .join_button, .login_to_join{
            color: #1272A5;
            background:#f8f8f8;
            cursor:pointer;
            border:none;
        }

        .join_button:hover, .login_to_join:hover{
            text-decoration:underline;
        }
        #chat_banner{
            display:none;
            color:#FFF;
            padding:5px 15px;
            font-size:12px;
        }
        .chat_input_section_container{
            position:relative;
            padding: 15px;
            display:flex;
            justify-content:center;
            align-items:flex-start;
        }
        .chat_input{
            padding:10px 6px;
            border-radius:5px;
            width:100%;
            box-sizing: border-box;
            height:auto;
            resize:none;
            max-width:600px;
            margin:0;
            font-size: 15px;
            outline:none;
            font-family:-apple-system-body, "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        }
        .chat_button{
            border-radius:50%;
            border:1px solid;
            height:25px;
            width:25px;
            padding:4px;
            cursor:pointer;
            opacity:0.5;
        }
        .user_msg .msg_container .msg_bubble{
            padding:10px 30px 10px 10px;
            background:transparent;
        }
        .msg_text a{
            text-decoration: none;
            /* color:${color}; */
        }

        .mdl-button--icon{
            width: 20px;
            height: 20px;
            min-width: 20px;
        }
        .mdl-button--icon .material-icons{
            font-size: 18px;
        }

        .new_message_divider{
            margin:15px;
            text-align:center;
            position: relative;
        }

        .divider_text{
            display: inline-block;
            background: white;
            padding: 0 15px;
            position: relative;
            z-index: 1;
        }
        .divider_line{
            position: absolute;
            margin: 0;
            top: 50%;
            width: 100%;
        }

    </style>
        
        <script type="text/javascript">

const ChatTemplate = ({pref, obj, title, placeholder, mode}) => `
                <div id="${pref}_chat_parent" aria-live="off" class="chat_parent ${mode}_mode">
                    <div id="${pref}_chat_input_section_container" class="chat_input_section_container">
                            <div class="chat_input_flexitem">
                                <div id="reply_box"></div>
                                <textarea id="${pref}_chat_input" class="chat_input" onkeyup="${obj}.HandleKeyup(this, event)" onblur="${obj}.InputBlur();" placeholder="${placeholder}" rows="1" maxlength="1000"></textarea>
                            </div>
                            <button id="${pref}_chat_button_container" aria-label="Send ${mode}." class="chat_button_container" onkeyup="${obj}.ButttonKeyUp(event)" onclick="${obj}.Send()"><svg class="chat_button" class="icon_send" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="60px" height="60px" viewBox="0 0 60 60" style="enable-background:new 0 0 60 60;" xml:space="preserve">
                            <path d="M30,11.61l23.39,15.593L30,42.966v-8.813c0,0-17.034-1.017-22.542,14.237C6.61,34.491,14,20.593,30,20.762V11.61z"/>
                            </svg></button>
                    </div>
                    <div aria-live='off' id="${pref}_chat_container" class="chat_container"></div>
                </div>
        `;


            var onCloseInterval; // Interfal variables must be declared globally for clearInterval to work correctly
            //console.log("EP_DRAW_CHAT");
        
            class ChatEPDraw extends UIEPDraw{

                constructor(obj, confid, eptable, tid, userid, url, os, mode, placeholder, chatid){
                    super(obj);
                    // Mode is used to determin top down or bottom up message view orientation.
                    this.mode = (typeof mode == 'undefined') ? 'comment' : mode;
                    this.placeholder = (typeof placeholder == 'undefined') ? 'Add a comment' : placeholder;
                    this.conn = null;
                    this.joinButton = "false";

                    this.menuDirection = 'top';
                    if(this.mode == 'comment'){
                        this.menuDirection = 'bottom';
                    }

                    this.os       = os;
                    this.confid   = confid;
                    this.eptable  = eptable;
                    this.color    = '#1a80b6';
                    this.tid      = tid;
                    this.userid   = userid.toString();
                    this.url      = url;
                    this.loggedin = true; // Assume logged-in state
                    this.uri      = ''; // Derived from the root domain url
                    this.chatid   = (typeof chatid != 'undefined') ? chatid : ''; // If no chatid, we get it from registered response
                    this.state    = 'disabled';
                    this.userinfo = {}; // List of users and their information by upid
                    
                    this.sendMode = 'normal';
                    this.replyData = {};

                    this.menu = null;
                    
                    this.myMenuItems   = [{'title':'Delete Message', 'action':'delete'}];
                    this.menuItems     = [{'title':'Reply', 'action':'reply'}, {'title':'Message User', 'action':'messageuser'}, {'title':'Report Comment', 'action':'report'}, {'title':'Block User', 'action':'blockuser'}];
                    this.spamMenuItems = [{'title':'Reply', 'action':'reply'}, {'title':'Message User', 'action':'messageuser'}, {'title':'Unreport Comment', 'action':'unreport'}, {'title':'Block User', 'action':'blockuser'}];
                    this.noUserMenuItems     = [{'title':'Report Comment', 'action':'report'}, {'title':'Block User', 'action':'blockuser'}];
                    this.noUserSpamMenuItems = [{'title':'Unreport Comment', 'action':'unreport'}, {'title':'Block User', 'action':'blockuser'}];

                    this.menuItems931     = [{'title':'Report Comment', 'action':'report'}];


                    if(this.tid == 'privatechat'){
                        this.myMenuItems = [{'title':'Delete Message', 'action':'delete'}];
                        this.menuItems   = [{'title':'Reply', 'action':'reply'}, {'title':'Block User', 'action':'blockuser'}];
                    }

                    this.blockedMenuItems = [{'title':'Unblock User', 'action':'unblockuser'}];
                    
                    this.authkeyExpiry   = null;
                    this.authkeyLifetime = 20;
                    this.authTimeout     = null;
                    this.loadOnScroll    = null; // toggle to call Auth() on scroll or button click
                    this.registeredWithView = false;

                    this.timeagoInterval = null;


                    // Message fetching controls
                    this.messageFetchLimit = 25;
                    this.allMessagesFetched = false;
                    this.fetching = false;

                    this.profileUrn = '';

                    this.legacyChat = false;

                }
                
                HandleKeyup(el, e){
                    /*
                    var curHeight = el.offsetHeight;
                    el.style.height = "auto";
                    if(curHeight != el.scrollHeight){
                        el.style.height = el.scrollHeight+"px";
                    } else {
                        
                    }
                    */

                    if(/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) == false){
                        if(e.keyCode == 13){
                            this.Send();
                            el.style.height = "auto";
                        }
                    }
                    if(el.value.length > 0){
                        var button = $('.chat_button');
                        $('#'+this.prefix+'_chat_button_container').addClass('send_active');
                    } else {
                        $('.send_active').removeClass('send_active');
                    }
                    
                    $('.char_limit_msg').remove();
                    if(el.value.length == 1000){
                        var msg = "<div class='char_limit_msg'>Character limit reached</div>"
                        $('#'+this.prefix+'_chat_input').after(msg);
                    } else if(el.value.length > 950){
                        var chars = 1000 - el.value.length;
                        var msg = "<div class='char_limit_msg'>"+chars+" Characters remaining</div>"
                        $('#'+this.prefix+'_chat_input').after(msg);
                    }
                }

                ButttonKeyUp(e){
                    if(e.keyCode == 13){
                        this.Send();
                    }
                }

                ClearTextfield(){
                    $('#'+this.prefix+'_chat_input').val('');
                    $('#'+this.prefix+'_chat_input').css({'height':'auto'});
                    $('.send_active').removeClass('send_active');
                    $('.char_limit_msg').remove();
                    this.ClearReplyMode();
                }

                ClearReplyMode(){
                    this.sendMode = 'normal';
                    this.replyData = {};
                    $('#reply_box').hide();
                }

                InputBlur(){
                    var message = $('#'+this.prefix+'_chat_input').val();
                    if(message.trim() == ''){
                        this.ClearReplyMode();
                    }
                }

                SetCss(color){
                    $('#chat_banner').css({'background-color':color});
                    $('#'+this.prefix+'_chat_parent #reply_box').css({'border-color': color});
                    $('#'+this.prefix+'_chat_parent .chat_input').css({'border-color': color});
                    $('#'+this.prefix+'_chat_parent .chat_button').css({'fill': color, 'border-color': color});
                    $('#'+this.prefix+'_chat_parent .user_msg .msg_container .msg_bubble').css({'background-color': color+'33'});
                }

                GetHtml(){
                    var chat = [];
                    var title = 'Discussion';
                    chat.push( {pref:this.prefix, obj:this.obj, title:title, placeholder:this.placeholder, mode:this.mode});
                    return chat.map(ChatTemplate).join('');
                }
    
                Register(conn, authkey){
                    if (conn.readyState === WebSocket.CLOSED) {
                        //console.log('Connection Closed'); return;
                    }
                    var data = {'type':'register', 'kind':'client', 'confid':this.confid, 'eptable':this.eptable, 'tid':this.tid, 'userid':this.userid, 'authkey':authkey, 'chatid':this.chatid, 'lastmessageid':0, 'limit':this.messageFetchLimit};
                    conn.send(JSON.stringify(data));
                }

                FetchMore(){
                    var local = this;
                    if(local.fetching == true){
                        return;
                    }
                    local.fetching = true;
                    if (this.conn.readyState === WebSocket.CLOSED) {
                        console.log('Connection Closed'); return;
                    }
                    if(this.state == 'enabled'){
                        if(Date.now() > local.authkeyExpiry){
                            local.Authenticate(this.eptable+":"+this.tid, function(userid, authkey){
                                var lastmessageid = $('.chat_item').last().attr('data-messageid');
                                var data = {'type':'fetchmore', 'kind':'client', 'confid':local.confid, 'eptable':local.eptable, 'tid':local.tid, 'userid':local.userid, 'authkey':authkey, 'chatid':local.chatid, 'lastmessageid':lastmessageid, 'limit':local.messageFetchLimit};
                                local.conn.send(JSON.stringify(data));
                                
                            });
                        } else {
                            var lastmessageid = $('.chat_item').last().attr('data-messageid');
                            var data = {'type':'fetchmore', 'kind':'client', 'confid':this.confid, 'eptable':this.eptable, 'tid':this.tid, 'userid':this.userid, 'authkey':this.authkey, 'chatid':this.chatid, 'lastmessageid':lastmessageid, 'limit':this.messageFetchLimit};
                            this.conn.send(JSON.stringify(data));
                        }
                    }
                }
                
    
                Send(){
                    if (this.conn.readyState === WebSocket.CLOSED) {
                        //console.log('Connection Closed'); return;
                    }
                    
                    if(this.state == 'enabled'){
                        
                        var text = $('#'+this.prefix+'_chat_input').val();
                        text = text.trim();
                        if(text.length == 0){
                            this.ClearTextfield();
                            return;
                        }
                        var message = text;
                        if(this.sendMode == 'reply') {
                            // This is a reply message
                            // Create the reply json message format
                            message = {'orig_message':this.replyData, 'reply':text};
                            message = JSON.stringify(message);
                        } 
                        // Perform userprofile insertions if this is a private chat by specifying the userids
                        this.userids = [];
                        if(this.tid=='privatechat' && typeof this.userinfo != 'undefined' && this.userinfo != null){
                            this.userids = Object.keys(this.userinfo);
                        }
                        var data = {'type':'message','kind':'client', 'confid':this.confid, 'chatid':this.chatid, 'userid':this.userid, 'userids':this.userids, 'message':message};
                        this.conn.send(JSON.stringify(data));
                        this.ClearTextfield();
                    }else{
                        console.log("Chat Widget Disabled");
                    }
                } 
                
                Delete(messageid){
                    if (this.conn.readyState === WebSocket.CLOSED) {
                        console.log('Connection Closed'); return;
                    }
                    if(this.state == 'enabled'){
                        var data = {'type':'delete','kind':'client', 'confid':this.confid, 'chatid':this.chatid, 'userid':this.userid, 'messageid':messageid};
                        this.conn.send(JSON.stringify(data));
                        return true;
                    }else{
                        console.log("Chat Widget Disabled");
                    }
                    return false;
                }
                
                HideComment(messageid){
                     $('.chat_item[data-messageid="'+messageid+'"]').find('.msg_text').append("<div class='hidden_message'>Message hidden.</div>");
                }
                UnhideComment(messageid){
                     $('.chat_item[data-messageid="'+messageid+'"] .hidden_message').remove();
                }
    
                InsertMessage(message, newMessage){
                    message = message.replace("##OBJNAME##", this.obj);
                    if(newMessage){
                        $('#' +this.prefix+'_chat_container').prepend(message); // prepend vs. append
                    } else {
                        $('#' +this.prefix+'_chat_container').append(message); // prepend vs. append
                    }
                    
                }
                /*


<div class='new_message_divider'>
    <hr class='divider_line' style="border-color:#d641cb">
    <div class='divider_text'>
        <svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="24px" height="12px" viewBox="0 0 1280 640" preserveAspectRatio="xMidYMid meet">
        <g transform="translate(0.000000,640.000000) scale(0.100000,-0.100000)" fill="#d641cb" stroke="none">
        <path d="M3198 3205 c-1759 -1756 -3198 -3196 -3198 -3199 0 -3 2880 -6 6400 -6 3520 0 6400 3 6400 7 0 7 -6388 6387 -6399 6390 -3 1 -1445 -1435 -3203 -3192z"/>
        </g>
        <svg>
        <div class='divider_text_inner' style="color:#d641cb">New Messages</div>
    </div>
</div>
                */
                InsertNewMessageDivider(){
                    let svgrotate ="transform: rotate(180deg);";
                    if(this.mode == 'comment'){
                        // Arrow points up for comments
                        svgrotate = "";
                    }
                    let svg = `<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="16px" height="8px" viewBox="0 0 1280 640" preserveAspectRatio="xMidYMid meet" style="${svgrotate}">
                                    <g transform="translate(0.000000,640.000000) scale(0.100000,-0.100000)" fill="${this.color}" stroke="none">
                                        <path d="M3198 3205 c-1759 -1756 -3198 -3196 -3198 -3199 0 -3 2880 -6 6400 -6 3520 0 6400 3 6400 7 0 7 -6388 6387 -6399 6390 -3 1 -1445 -1435 -3203 -3192z"/>
                                    </g>
                                <svg>`;
                    let messgetxt = `
                                 <div class='divider_text_inner'  style="color:${this.color}">New Messages</div>
                                 ${svg}
                                 `;
                    if(this.mode == 'comment'){
                        // arrow should be on top for comments
                        messgetxt = `
                                ${svg}
                                 <div class='divider_text_inner'  style="color:${this.color}">New Messages</div>
                                 `;
                    }
                    var message = `<div class='new_message_divider'>
                                        <hr class='divider_line' style="border-color:${this.color}">
                                        <div class='divider_text'>
                                            ${messgetxt}
                                        </div>
                                        
                                    </div>`;
                    $('#' +this.prefix+'_chat_container').append(message); // prepend vs. append
                }

                InsertNoMessages(){
                    var message = "<div class='default_message_container'>No messages yet.<br>Post a comment to start the conversation!</div>";
                    $('#' +this.prefix+'_chat_container').prepend(message); // prepend vs. append
                }
                
                Authenticate(uniqid, callback){
                    var local = this;
                    var formdata = {'interface':'chat', 'action':'authenticate', 'confid':this.confid, 'uniqid':uniqid};
                    epWebAuth.EPWebPost(local.url+'web/api.php', formdata, function(msg, data){
                        if(msg.success){
                            var data = JSON.parse(data);
                            // success
                            local.authkey = data.authkey;

                            local.authkeyExpiry = new Date();
                            // Set the auth key to expire at the end of lifetime
                            local.authkeyExpiry.setMinutes(local.authkeyExpiry.getMinutes() + local.authkeyLifetime);
                            callback(data.userid, data.authkey);
                        }else if (msg.message == 'USER_BLOCKED'){
                            // Clear messages
                            $('#' +local.prefix+'_chat_container').html("");
                            local.ShowDisabledMessage('Disabled. Please contact your organizer.')
                        } else{
                            // Clear messages
                            $('#' +local.prefix+'_chat_container').html("");
                            local.ShowDisabledMessage('<button class="login_to_join" onclick="epView.Login()">Log in to join the discussion</button>')
                           // console.log("Authenticate: confid="+local.confid+" uniqid="+uniqid);
                        }
                    });
                }
                
                GetUserIdResponse(id, success){
                    if(this.userid != id){
                        epWebAuth.ClearAuthCredentials();
                    }
                    epConnect.upid = id.toString();
                    if(epConnect.upid != ""){
                        this.userid = id.toString();
                    }
                };       

                OpenLink(url){
                    if(this.os == 'android' || this.os == 'ios'){
                        window.location.href = url;
                    }else{
                        window.open(url);
                    }
                }
                
                CreateMessage(value){
                    var local = this;
                    if(local.IsReply(value.message)){
                        return local.CreateReply(value);
                    }
                    var message = "";
                    // Insert messages into chat with name
                    var first = '';
                    var last = '';
                    
                    var pict = '';

                    if(local.userinfo.hasOwnProperty(value.userid)){
                        if(typeof local.userinfo[value.userid].data != 'undefined'){
                            first = local.userinfo[value.userid].data.first;
                            last = local.userinfo[value.userid].data.last;
                        }
                        
                        if(typeof local.userinfo[value.userid].data.photo !== 'undefined'){
                            pict = "<div class='user_photo' style=\" background-image:url('" + local.userinfo[value.userid].data.photo +"'),url( '##RES_IMG_PATH##/menu_person.png')\"></div>";
                        }else if(typeof local.userinfo[value.userid].data.mono !== 'undefined'){
                            pict = local.userinfo[value.userid].data.mono;
                        }
                    } else {
                        first = "Unknown";
                        last = "User";
                        pict = "<div class='user_photo' style=\"background-image:url( '##RES_IMG_PATH##/menu_person.png')\"></div>";
                    }
    
                    
                    var timeago = this.GetTimeAgo(value.ts);
                    var message = value.message;
                    
                    if (value.userid == local.userid){
                        var ariaMsg = message.replace(/(<([^>]+)>)/gi, "");
                        var ariaLabel = `You said: ${ariaMsg}.`;
                        // Menu Button
                        var menuButton = UIEPDraw.DrawIconButton(`${value.messageid}_mymenu`, null, 'more_vert')
                        message=`<div aria-label="${ariaLabel}" aria-live="off" class='chat_item user_msg' data-chatid='${value.chatid}' data-userid='${value.userid}' data-messageid='${value.messageid}'>
                                    <div class='name_container' data-ts='${value.ts}'>${first} ${last} - <span class="chat_timeago" data-ts="${value.ts}">${timeago}</span></div>
                                    <div class='msg_container'>
                                        <div class='msg_bubble' style='background:${local.color}33;'>
                                            ${menuButton}
                                            <div class='msg_text'>${message}</div>
                                        </div>
                                        <div class='user_icon' onclick="${local.obj}.UserIconClicked('${value.userid}')">${pict}</div>
                                        
                                    </div>
                                </div>`;
                    } else {
                        var ariaMsg = message.replace(/(<([^>]+)>)/gi, "");
                        var ariaLabel = `${first} ${last} said: ${ariaMsg}.`;
                        // Menu Button
                        var menuButton = UIEPDraw.DrawIconButton(`${value.messageid}_menu`, null, 'more_vert');

                        var spamflag = '';
                        if(value.flaggedby == local.userid && value.flaggedspam == 'spam'){
                            spamflag = '<div class="flagged_spam"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="15px" viewBox="0 0 14 14" xml:space="preserve"><path d="M7,0L0,12h14L7,0z M7,11c-0.553,0-1-0.447-1-1s0.447-1,1-1c0.553,0,1,0.447,1,1S7.553,11,7,11z M7,8C6.447,8,6,7.553,6,7V5c0-0.553,0.447-1,1-1c0.553,0,1,0.447,1,1v2C8,7.553,7.553,8,7,8z"/></svg></div>';
                        }
                        
                        if(local.blockedList.includes(value.userid)){
                            message = "<em style='color:#777;'>Message Blocked</em>";
                        }
                        message=`<div aria-label="${ariaLabel}" aria-live="off" class='chat_item' data-chatid='${value.chatid}' data-userid='${value.userid}' data-messageid='${value.messageid}'>
                                    <div class='name_container' data-ts='${value.ts}'>${first} ${last} - <span class="chat_timeago" data-ts="${value.ts}">${timeago}</span></div>
                                    <div class='msg_container'>
                                        <div class='user_icon' onclick="${local.obj}.UserIconClicked('${value.userid}')">${pict}</div>
                                        <div class='msg_bubble'>
                                            <div class='msg_text'>${message}</div>
                                            ${menuButton}
                                        </div>
                                        ${spamflag}
                                    </div>
                                </div>`;
                    }
                    
                
                    return message;
                }
                CreateReply(value){
                    var local = this;
                    var first = "";
                    var last  = "";
                    var msgPict = '';
                    
                    var message = "";
                    var replyFirst = '';
                    var replyLast = '';
                    var replyPict = '';
                    
                    var timeago = this.GetTimeAgo(value.ts);

                    var replyObj = JSON.parse(value.message);
                    var replyUser = replyObj.orig_message.userid;
                    var origMsg = replyObj.orig_message.message;
                    var replyMsg = replyObj.reply;
                    
                    if(local.userinfo.hasOwnProperty(replyUser)){
                        replyFirst = local.userinfo[replyUser].data.first;
                        replyLast = local.userinfo[replyUser].data.last;

                        if(typeof local.userinfo[replyUser].data.photo !== 'undefined'){
                            replyPict = "<div class='user_photo' style=\"background-image:url('" + local.userinfo[replyUser].data.photo + "'),url( '##RES_IMG_PATH##/menu_person.png')\"></div>";
                        }else if(typeof local.userinfo[replyUser].data.mono !== 'undefined'){
                            replyPict = local.userinfo[replyUser].data.mono;
                        }
                    } else {
                        replyFirst = "Unknown";
                        replyLast = "User";
                        replyPict = "<div class='user_photo' style=\"background-image:url( '##RES_IMG_PATH##/menu_person.png')\"></div>";
                    }

                    if(local.userinfo.hasOwnProperty(value.userid)){
                        if(typeof local.userinfo[value.userid].data != 'undefined'){
                            first = local.userinfo[value.userid].data.first;
                            last = local.userinfo[value.userid].data.last;
                        }
                        
                        if(typeof local.userinfo[value.userid].data.photo !== 'undefined'){
                            msgPict = "<div class='user_photo' style=\" background-image:url('" + local.userinfo[value.userid].data.photo +"'),url( '##RES_IMG_PATH##/menu_person.png')\"></div>";
                        }else if(typeof local.userinfo[value.userid].data.mono !== 'undefined'){
                            msgPict = local.userinfo[value.userid].data.mono;
                        }
                    } else {
                        first = "Unknown";
                        last = "User";
                        msgPict = "<div class='user_photo' style=\"background-image:url( '##RES_IMG_PATH##/menu_person.png')\"></div>";
                    }
                    if (value.userid == local.userid){
                        var ariaMsg = replyMsg.replace(/(<([^>]+)>)/gi, "");
                        var ariaLabel = `You replied:${ariaMsg}.`;
                        // Menu Button
                        var menuButton = UIEPDraw.DrawIconButton(`${value.messageid}_mymenu`, null, 'more_vert')
                        if(local.blockedList.includes(replyUser)){
                            origMsg = "<em style='color:#777;'>Message Blocked</em>";
                        }
                        var replyBox = `<div class="msg_reply" style="display: flex;"">
                        <div class='user_icon' style='margin-top:-20px;margin-left:-20px;' onclick="${local.obj}.UserIconClicked('${replyUser}')">${replyPict}</div>
                        <div style='background:#eee;text-align:left; padding:10px 10px 10px 30px;border-radius:5px;flex-grow:1;width: calc(100% - 40px);'>
                            <div class="name_container" style="margin:0;">${replyFirst} ${replyLast} said:</div>
                            ${origMsg}
                        </div>
                        
                        </div>`;
                        message=`<div aria-label="${ariaLabel}" aria-live="off" class='chat_item user_msg user_reply' data-chatid='${value.chatid}' data-userid='${value.userid}' data-messageid='${value.messageid}'>
                                    <div class='name_container' data-ts='${value.ts}'>${first} ${last} - <span class="chat_timeago" data-ts="${value.ts}">${timeago}</span></div>
                                    <div style='background:${local.color}33;border-radius: 20px 5px 5px 5px;max-width: 85%; margin-right: 20px;'>
                                        <div class="repl_container" style='margin: 20px 10px 10px 20px;'>
                                            ${replyBox}
                                        </div>
                                        <div class='msg_container'>
                                            <div class='msg_bubble' >
                                                ${menuButton}
                                                <div class='msg_text'>${replyMsg}</div>
                                            </div>
                                            <div class='user_icon' onclick="${local.obj}.UserIconClicked('${value.userid}')">${msgPict}</div>
                                        </div>
                                    </div>
                                </div>`;
                    } else {
                        var ariaMsg = replyMsg.replace(/(<([^>]+)>)/gi, "");
                        var ariaLabel = `${first} ${last} replied: ${ariaMsg}`;
                        // Menu Button
                        var menuButton = UIEPDraw.DrawIconButton(`${value.messageid}_menu`, null, 'more_vert');

                        var spamflag = '';
                        if(value.flaggedby == local.userid && value.flaggedspam == 'spam'){
                            spamflag = '<div class="flagged_spam"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="15px" viewBox="0 0 14 14" xml:space="preserve"><path d="M7,0L0,12h14L7,0z M7,11c-0.553,0-1-0.447-1-1s0.447-1,1-1c0.553,0,1,0.447,1,1S7.553,11,7,11z M7,8C6.447,8,6,7.553,6,7V5c0-0.553,0.447-1,1-1c0.553,0,1,0.447,1,1v2C8,7.553,7.553,8,7,8z"/></svg></div>';
                        }
                        
                        if(local.blockedList.includes(value.userid)){
                            replyMsg = "<em style='color:#777;'>Message Blocked</em>";
                        }
                        var replyBoxColor = replyUser == local.userid ? `background:${local.color}33;` : `background:#ddd; color:#111;`;
                        var replyBox = `<div class="msg_reply" style="display: flex;flex-direction: row-reverse;">
                        <div class='user_icon' style='margin-top:-20px;margin-left:-20px;' onclick="${local.obj}.UserIconClicked('${replyUser}')">${replyPict}</div>
                        <div style='${replyBoxColor}text-align:left; padding:10px 30px 10px 10px;border-radius:5px;flex-grow:1;width: calc(100% - 40px);'>
                            <div class="name_container" style="margin:0;">${replyFirst} ${replyLast} said:</div>
                            ${origMsg}
                        </div>
                        
                        </div>`;
                        message=`<div aria-label="${ariaLabel}" aria-live="off" class='chat_item user_reply' data-chatid='${value.chatid}' data-userid='${value.userid}' data-messageid='${value.messageid}'>
                                    <div class='name_container' data-ts='${value.ts}'>${first} ${last} - <span class="chat_timeago" data-ts="${value.ts}">${timeago}</span></div>
                                    <div style='background:#eee;border-radius: 5px 20px 5px 5px;max-width: 85%; margin-left: 20px;'>
                                        <div class="repl_container" style='margin: 20px 20px 10px 10px;'>
                                            ${replyBox}
                                        </div>
                                        <div class='msg_container'>
                                            <div class='user_icon' style="margin:0 0 0 -20px;" onclick="${local.obj}.UserIconClicked('${value.userid}')">${msgPict}</div>
                                            <div class='msg_bubble'>
                                                <div class='msg_text'>${replyMsg}</div>
                                                ${menuButton}
                                            </div>
                                            ${spamflag}
                                        </div>
                                    </div>
                                </div>`
                    }
                    return message;
                }

                IsReply(str) {
                    // Reply messages are in json format
                    try {
                        var replyObj = JSON.parse(str);
                        if(typeof replyObj.reply != 'undefined'){
                            return true;
                        }
                    } catch (e) {
                        return false;
                    }
                    return false;
                }

                Reply(messageid, err){
                    var local = this;
                    var origMsg = $('.chat_item[data-messageid='+messageid+']');
                    var origUser = origMsg.attr('data-userid');
                    var origUserData = local.userinfo[origUser].data;
                    var origTxt = origMsg.find('.msg_text').html();;
                    var pict = '';
                    if(typeof origUserData.photo !== 'undefined'){
                        pict = "<div class='user_photo' style=\" background-image:url('" + origUserData.photo + "'),url( '##RES_IMG_PATH##/menu_person.png')\"></div>";
                    }else if(typeof origUserData.mono !== 'undefined'){
                        pict = origUserData.mono;
                    }

                    var replyBox=`<div class='reply_container'>
                                    <div class='user_icon'>${pict}</div>
                                    <div class='msg_bubble'>
                                        <div class='name_container'>${origUserData.first} ${origUserData.last} said:</div>
                                        <div class='msg_text'>${origTxt}</div>
                                    </div>
                                </div>`;
                    $('#reply_box').html(replyBox).show();
                    $('#'+this.prefix+'_chat_input').focus();
                    this.sendMode = 'reply';
                    this.replyData = {'messageid': messageid, 'userid':origUser, 'message':origTxt};
                    return true;
                }
    
    
                GetTimeAgo(ts){
                    var now = Date.now();
    
                    var diffMs = (now - (ts * 1000)); // milliseconds between now & timestamp of feed item (which is in seconds)
                    var diffDays = Math.floor(diffMs / 86400000); // days
                    var diffHrs = Math.floor((diffMs % 86400000) / 3600000); // hours
                    var diffMins = Math.round(((diffMs % 86400000) % 3600000) / 60000); // minutes
    
                    var diffStr = '';
    
                    if(diffDays > 0){
                        diffStr = diffDays + 'd ' + diffHrs + 'h ago';
                    } else if(diffHrs > 0){
                        diffStr = diffHrs + 'h ' + diffMins + 'm ago';
                    } else if (diffMins > 2){
                        diffStr =  diffMins + 'm ago';
                    } else {
                        diffStr = 'Just now';
                    }
                    return diffStr;
                }
                
                StartChat(authkey){
                    var local = this;

                    //var activity ='<svg style="fill:#555" width="15" height="15" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring" style="background: none;"><circle cx="50" cy="50" ng-attr-r="{{config.radius}}" ng-attr-stroke-width="{{config.width}}" ng-attr-stroke="{{config.stroke}}" ng-attr-stroke-dasharray="{{config.dasharray}}" fill="none" stroke-linecap="round" r="40" stroke-width="4" stroke="#555" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(34.6018 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg>';
                    //local.ShowDisabledMessage('Loading chat... &nbsp;'+activity)
                    
                    // Make sure we don't start a chat unless we are not active
                    if(this.state !== 'enabled'){
                        //console.log("StartChat Attmpted: chat already enabled");
                    }
                    
                    var port   = '80';
                    // Clear interval if it exists
                    local.ClearCloseInterval();
    
                    this.uri = '';
                    var url = this.url.replace(':8888/', '');
                    url = url.replace(':8888', '');
                    if(~this.url.indexOf("http://")){
                        this.uri = url.replace('http://', 'ws://') + ':80';
                        this.uri = this.uri.replace('/:80', '');
                    }else{
                        this.uri = url.replace('https://', 'wss://') + ':443';
                        this.uri = this.uri.replace('/:443', '');
                    }
                    
                    // If we are running localhost we want our localhost to be 8880 for chrome and 8881 for safari
                    // This forces the connection in a repeatable way so we can verify multiple chat servers in localhost
                    if(this.uri.includes('local')){
                        var ua = navigator.userAgent.toLowerCase(); 
                        if (ua.indexOf('safari') != -1) { 
                            if (ua.indexOf('chrome') > -1) {
                                this.uri = 'ws://eppro01.local:8880'; // Chrome
                            } else {
                                this.uri = 'ws://eppro02.local:8881'; // Safari
                            }
                        } else {
                            this.uri = 'ws://eppro01.local:8880'; // All other browsers
                        }
                    }

                    if(this.conn != null){
                        this.conn.close();
                    }
                    this.conn = new WebSocket(this.uri);//, "echo-protocol");
                    this.conn.onopen = function(e) {
                        //console.log("Chat - Connection established: "+local.uri);
                        local.Register(this, authkey); // auto register
                    };          
    
                    this.conn.onmessage = function(e) {
                        
                        var json = JSON.parse(e.data); // Message format {'type':<type>, 'channel':<channel>, 'message':<message>}
                        if(json == 'invalid user'){
                            local.ShowDisabledMessage('Disabled');
                            local.state = 'disabled';
                            local.ClearCloseInterval();
                            local.ShowInvalidUser();
                            return;
                        }
                        switch(json.type){
                            case 'newuser':
                                //console.log("newuser: "+e.data);
                                // Store our new user
                                local.userinfo[json.userid] = json.userinfo;
                                break;
                            case 'registered': // {'type':<type>, 'chatid':<chatid>, 'messages':<messages>}
                                if(typeof json.host != 'undefined' && typeof json.wsport != 'undefined'){
                                    //console.log("Registered host: "+json.host+" wsport: "+json.wsport);
                                }
                                // Clear messages
                                $('#' +local.prefix+'_chat_container').html(""); // Clear the content area before we reload
                                // This message contains all of the data the user needs to be up-to-date in the current chat
                                local.chatid   = json.chatid; // Store so we can respond appropriately
                                local.userinfo = json.userinfo; // Store our current list of users for rapid lookup
                                local.allMessagesFetched = false;
                                if(json.messages.length > 0) {
                                    let bShowNewMessage = true;
                                    $('.default_message_container').remove();
                                    //json.messages.reverse(); // Reverse the messages array so we iterare from oldest to newest and prepend newer messages closest to the message input
                                    $.each(json.messages, function(index, value){
                                        //console.log(value);
                                        
                                        local.InsertMessage(local.CreateMessage(value), false);

                                        if(value.userid != local.userid && bShowNewMessage && local.userinfo[local.userid].lastview < value.ts ){
                                            // this is a new message, check if the next message is older than my last visit and insert new message banner if so
                                            if(typeof json.messages[index+1] !== 'undefined' && local.userinfo[local.userid].lastview > json.messages[index+1].ts ){
                                                bShowNewMessage = false;
                                                local.InsertNewMessageDivider();
                                            }
                                        }

                                        // Insert menu options into message
                                        if(typeof local.userinfo[value.userid] === 'undefined'){
                                            if (value.flaggedby == local.userid && value.flaggedspam == 'spam'){
                                                local.menu.GetHtml(value.messageid+'_menu', local.noUserSpamMenuItems, 'mdl-menu--'+local.menuDirection+'-right');

                                            } else {
                                                local.menu.GetHtml(value.messageid+'_menu', local.noUserMenuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                            }
                                        } else if (value.userid == local.userid){
                                            local.menu.GetHtml(value.messageid+'_mymenu', local.myMenuItems, 'mdl-menu--'+local.menuDirection+'-left');
                                        }else if (local.legacyChat){
                                            local.menu.GetHtml(value.messageid+'_menu', local.menuItems931, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else if (local.blockedList.includes(value.userid)){
                                            local.menu.GetHtml(value.messageid+'_menu', local.blockedMenuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else if (value.flaggedby == local.userid && value.flaggedspam == 'spam'){
                                            local.menu.GetHtml(value.messageid+'_menu', local.spamMenuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else{
                                            local.menu.GetHtml(value.messageid+'_menu', local.menuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }
                                        
                                        let commentHidden = localStorage.getItem(local.confid+'_'+value.messageid+'_hidden');
                                        if(commentHidden == 'true'){
                                            local.HideComment(value.messageid)
                                        }
                                        
                                    });
                                    if(json.messages.length < local.messageFetchLimit){
                                        // fewer messages were returned than requested. All messages have been dded
                                        local.allMessagesFetched = true;
                                    }
                                } else {
                                    // No messages in chat. Insert the default invitation to chat message
                                    local.allMessagesFetched = true;
                                    local.InsertNoMessages();
                                }
                                local.fetching = false;
                                local.Enable(); // Enable after we've received the messages

                                // iOS WebKit bug fix
                                if(local.os == 'ios' && local.mode == 'message'){
                                    console.log( $('#' +local.prefix+'_chat_container').scrollTop())
                                    // iOS has a draw issue when inserting messages into the flex reverse container
                                    // Scroll top is negative when scrolling in message mode 
                                    // Toggling the scrill position like this forces the browser to redraw the container
                                    // No need to check if we are at the beginning of the messages. We shoul be because we just loaded chat
                                    setTimeout(function(){
                                        $('#' +local.prefix+'_chat_container').scrollTop(-1);
                                        $('#' +local.prefix+'_chat_container').scrollTop(0);
                                    }, 100);
                                }
                                


                                if(!local.allMessagesFetched && local.IsInViewport($('.chat_item').last())){
                                    // After loading initial set of messages, there is still room in the view for more
                                    // And there are still messages to fetch
                                    // Load More Messages
                                    local.FetchMore();
                                }
                                break;
                            case 'fetch': // {'type':<type>, 'chatid':<chatid>, 'messages':<messages>}
                                if(typeof json.host != 'undefined' && typeof json.wsport != 'undefined'){
                                    //console.log("Registered host: "+json.host+" wsport: "+json.wsport);
                                }
                                if(json.messages.length > 0) {
                                    $('.default_message_container').remove();
                                    //json.messages.reverse(); // Reverse the messages array so we iterare from oldest to newest and prepend newer messages closest to the message input
                                    $.each(json.messages, function(index, value){
                                        //console.log(value);
                                        local.InsertMessage(local.CreateMessage(value), false);

                                        if(value.userid != local.userid && bShowNewMessage && local.userinfo[local.userid].lastview < value.ts ){
                                            // this is a new message, check if the next message is older than my last visit and insert new message banner if so
                                            if(typeof json.messages[index+1] !== 'undefined' && local.userinfo[local.userid].lastview > json.messages[index+1].ts ){
                                                bShowNewMessage = false;
                                                local.InsertNewMessageDivider();
                                            }
                                        }
                                        // Insert menu options into message
                                        if(typeof local.userinfo[value.userid] === 'undefined'){
                                            if (value.flaggedby == local.userid && value.flaggedspam == 'spam'){
                                                local.menu.GetHtml(value.messageid+'_menu', local.noUserSpamMenuItems, 'mdl-menu--'+local.menuDirection+'-right');

                                            } else {
                                                local.menu.GetHtml(value.messageid+'_menu', local.noUserMenuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                            }
                                        } else if (value.userid == local.userid){
                                            local.menu.GetHtml(value.messageid+'_mymenu', local.myMenuItems, 'mdl-menu--'+local.menuDirection+'-left');
                                        }else if (local.legacyChat){
                                            local.menu.GetHtml(value.messageid+'_menu', local.menuItems931, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else if (local.blockedList.includes(value.userid)){
                                            local.menu.GetHtml(value.messageid+'_menu', local.blockedMenuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else if (value.flaggedby == local.userid && value.flaggedspam == 'spam'){
                                            local.menu.GetHtml(value.messageid+'_menu', local.spamMenuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else{
                                            local.menu.GetHtml(value.messageid+'_menu', local.menuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }
                                    
                                        let commentHidden = localStorage.getItem(local.confid+'_'+value.messageid+'_hidden');
                                        if(commentHidden == 'true'){
                                            local.HideComment(value.messageid)
                                        }

                                    });
                                    if(json.messages.length < local.messageFetchLimit){
                                        // fewer messages were returned than requested. All messages have been dded
                                        local.allMessagesFetched = true;
                                    }
                                } else {
                                    // No messages in chat. Insert the default invitation to chat message
                                    local.allMessagesFetched = true;
                                }
                                local.fetching = false;
                                local.Enable(); // Enable after we've received the messages
                                
                                if(!local.allMessagesFetched && local.IsInViewport($('.chat_item').last())){
                                    // After loading initial set of messages, there is still room in the view for more
                                    // And there are still messages to fetch
                                    // Load More Messages
                                    local.FetchMore();
                                }
    
                                
                                break;
                            case 'message': // {'type':<type>, 'chatid':<chatid>, 'messages':<messages>}
                                $('.default_message_container').remove();
                                if(json.chatid == local.chatid){
                                    if (json.kind == 'profanity') {
                                        if (typeof EPAlert == 'undefined') {
                                            alert("Profanity detected.")
                                        } else {
                                            EPAlert("Profanity detected.");
                                        }
                                        return;
                                    }
                                    if (json.kind == 'invalidspam') {
                                        if (typeof EPAlert == 'undefined') {
                                            alert("You have reached the limit of 50 pending contact requests. Please wait for some of your existing requests to respond to you before engaging in further networking.")
                                        } else {
                                            EPAlert("You have reached the limit of 50 pending contact requests. Please wait for some of your existing requests to respond to you before engaging in further networking.");
                                        }
                                        return;
                                    }
                                    local.RemoveMessageByMessageId(json.messageid);
                                    local.InsertMessage(local.CreateMessage(json), true);
    
                                    // Insert menu options into message
                                    if(typeof local.userinfo[json.userid] !== 'undefined'){
                                        if (json.userid == local.userid){
                                            local.menu.GetHtml(json.messageid+'_mymenu', local.myMenuItems, 'mdl-menu--'+local.menuDirection+'-left');
                                        }else if (local.legacyChat){
                                            local.menu.GetHtml(value.messageid+'_menu', local.menuItems931, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else if (local.blockedList.includes(json.userid)){
                                            local.menu.GetHtml(value.messageid+'_menu', local.blockedMenuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }else{
                                            local.menu.GetHtml(json.messageid+'_menu', local.menuItems, 'mdl-menu--'+local.menuDirection+'-right');
                                        }
                                    }
                                    // iOS WebKit bug fix
                                    if(local.os == 'ios' && local.mode == 'message'){
                                        console.log( $('#' +local.prefix+'_chat_container').scrollTop())
                                        // iOS has a draw issue when inserting messages into the flex reverse container
                                        // Scroll top is negative when scrolling in message mode 
                                        if($('#' +local.prefix+'_chat_container').scrollTop() >= -2){
                                            setTimeout(function(){
                                                // We are at the beginning of the messages. Toggle the scroll value to force WebKit to redraw
                                                $('#' +local.prefix+'_chat_container').scrollTop(-1);
                                                $('#' +local.prefix+'_chat_container').scrollTop(0);
                                            }, 100);
                                        }
                                    }
                                }else{
                                    console.log("Invalid chatid: "+json.chatid);
                                }

                                if(!local.allMessagesFetched && local.IsInViewport($('.chat_item').last())){
                                    // Load More Messages
                                }
                                break;
                            case 'delete': // {'type':<type>, 'chatid':<chatid>, 'messages':<messages>}
    
                                $('.chat_item[data-chatid="'+json.chatid+'"][data-userid="'+json.userid+'"][data-messageid="'+json.messageid+'"]').remove()
                                break;
                            case 'state': // {'type':<type>, 'chatid':<chatid>, 'messages':<messages>}
                                switch(json.state){
                                    case 'disabled':
                                        // Disable sending chats
                                        local.Disable();
                                        break;
                                    case 'enabled':
                                        // Enable sending chats
                                        local.Enable();
                                        break;
                                    default:
                                        console.log("Invalid state: "+json.state);
                                        break;
                                }//switch
                                break;
                            default:
                                console.log("Invalid message: "+e.data);
                                break;
                        }//switch
                    };
                    
                    this.conn.onclose = function(e) {

                        console.log('Socket is closed. '+ e.reason);
                        var activity ='<svg style="fill:#555" width="15" height="15" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring" style="background: none;"><circle cx="50" cy="50" ng-attr-r="{{config.radius}}" ng-attr-stroke-width="{{config.width}}" ng-attr-stroke="{{config.stroke}}" ng-attr-stroke-dasharray="{{config.dasharray}}" fill="none" stroke-linecap="round" r="40" stroke-width="4" stroke="#555" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(34.6018 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg>';
                        local.ShowDisabledMessage('Reconnecting ... &nbsp;'+activity);

                        // Clear interval if it exists
                        local.ClearCloseInterval();
                        if(typeof onCloseInterval == 'undefined'){
                            onCloseInterval = setInterval(function(){
                                local.Setup(local.color, true);
                            }, 15000);
                        }
                        
                    };
    
                    this.conn.onerror = function(err) {
                        console.log('Socket encountered error. ');
                        console.error('Socket encountered error: ', err.message, 'Closing socket');
                    };

                    // Listen for browser connectivity changes
                    window.addEventListener('online', function(){

                    });
                    window.addEventListener('offline', function(){
                        
                    });

                    // for inline chat, the document scrolls
                    var container = document;
                    if(local.prefix.indexOf('groupChat') > -1 || local.prefix.indexOf('privateChat') > -1 ){
                        // in group and private chat views, the chat container scrolls
                        container = document.getElementById(local.prefix+'_chat_container');
                    }
                    container.addEventListener('scroll', function () {
                        if($('.chat_item').last().length > 0){
                            if(local.IsInViewport($('.chat_item').last())  && !local.allMessagesFetched){
                                local.FetchMore();
                            } else {
                            }
                        }
                    }, {
                        passive: true
                    });
                }

                UpdateMenuOptions(messageid, menuItems){
                    var local = this;
                    local.menu.GetHtml(messageid+'_menu', menuItems, 'mdl-menu--'+local.menuDirection+'-right');
                }

                UpdateTimeAgo(){
                    var local = this;
                    $('.chat_timeago').each(function(){
                        var ts = $(this).attr('data-ts');
                        var timeago = local.GetTimeAgo(ts);
                        $(this).html(timeago);
                    })
                }

                ClearCloseInterval() {
                    var local = this;
                    clearInterval(onCloseInterval);
                    onCloseInterval = 'undefined';
                }                 
    
                Enable(){
                    this.HideDisabledMessage();
                    $(".chat_parent :input").attr("disabled", false);
                    this.state = 'enabled';
                }
    
                Disable(){
                    this.ShowDisabledMessage('Disabled')
                    $(".chat_parent :input").attr("disabled", true);
                    this.state = 'disabled';
                }

                ShowDisabledMessage(msg){
                    $('#'+this.prefix+'_chat_button_container').removeClass('send_active');

                    var html = '<div id="'+this.prefix+'_chat_disabled" class="chat_disabled">' + msg + '</div>';
                    $('#'+this.prefix+'_chat_disabled').remove();
                    $('#'+this.prefix+'_chat_input_section_container').prepend(html);
                }
                HideDisabledMessage(){
                    $('#'+this.prefix+'_chat_button_container').addClass('send_active');

                    $('#'+this.prefix+'_chat_disabled').remove();
                }

                ShowInvalidUser(){
                    var html ='<div id="'+this.prefix+'_chat_invalid_user" class="chat_invalid_user"><h4>Invalid user</h4><p style="color:#666;">You are attempting to access a private chat.</p><p style="color:#666;">You will be automatically be redirected in several seconds.</p></div>';
                    $('#'+this.prefix+'_chat_invalid_user').remove();
                    $('#'+this.prefix+'_chat_parent').append(html);
                    setTimeout(function(){
                        if(window.history.length > 1){
                            window.history.back();
                        }else{
                            window.close();
                        }
                    } , 5000);
                }
    
                MarkAsSpam(messageid, err){
                    if (this.conn.readyState === WebSocket.CLOSED) {
                        console.log('Connection Closed'); return;
                    }
                    var data = {'type':'info', 'kind':'client', 'operation':'spam', 'confid':this.confid, 'chatid':this.chatid, 'eptable':this.eptable, 'tid':this.tid, 'userid':this.userid, 'messageid':messageid, 'data':''};
                    this.conn.send(JSON.stringify(data));  
                    return true;
                }

                UnflagSpam(messageid, err){
                    if (this.conn.readyState === WebSocket.CLOSED) {
                        console.log('Connection Closed'); return;
                    }
                    var data = {'type':'info', 'kind':'client', 'operation':'unflagspam', 'confid':this.confid, 'chatid':this.chatid, 'eptable':this.eptable, 'tid':this.tid, 'userid':this.userid, 'messageid':messageid, 'data':''};
                    this.conn.send(JSON.stringify(data));  
                    return true;
                }

                RemoveMessageByMessageId(messageid){
                    var msg = $('.chat_item[data-messageid="'+messageid+'"]');
                    if(msg.length > 0){
                        msg.remove();
                    }
                }

                MessageUserByMessageId(messageid){
                    let userid = $('.chat_item[data-messageid='+messageid+']').attr('data-userid');
                    this.MessageUser(userid);
                }

                MessageUser(userid){
                    epView.OpenDialog(`urn:eventpilot:all:custom:data-id:view=privatechat|CHATID=|USERID=${userid}`, {'confid':this.confid});
                }

                BlockUser(messageid, err){
                    var local = this;

                    let userid = $('.chat_item[data-messageid='+messageid+']').attr('data-userid');
                    EPConfirm("Block User?", "You will no longer receive new message updates from this user.", function(confirm){
                        if(confirm){
                            var formdata = {'interface':'chat','action':'block_user', 'confid':local.confid, 'user':userid};
                            var url = local.url+'web/api.php';
                            local.EPWebPost2Poly(url, formdata, function(success, msg, data){
                                if(success){
                                    EPAlert("User Blocked.");
                                    local.InitChat();
                                } else {
                                    EPAlert("There was in issue processing your request. Please try again later.")
                                }
                            });
                        }
                    });
                }

                UnblockUser(messageid, err){
                    var local = this;

                    let userid = $('.chat_item[data-messageid='+messageid+']').attr('data-userid');
                    var formdata = {'interface':'chat','action':'unblock_user', 'confid':local.confid, 'user':userid};
                    var url = local.url+'web/api.php';
                    this.EPWebPost2Poly(url, formdata, function(success, msg, data){
                        if(success){
                            local.InitChat();
                        } else {
                            console.log("Failed to unblock user.");
                        }
                    });
                }

                GetBlockedList(userid, callback){
                    var local = this;
                    var formdata = {'interface':'chat','action':'get_blocked_list', 'confid':local.confid, 'user':userid};
                    var url = local.url+'web/api.php';
                    this.EPWebPost2Poly(url, formdata, function(success, msg, data){
                        if(success){
                            local.blockedList = data;
                            callback();
                            return true
                        } else {
                            console.log("GetBlockedList failed.")
                            local.blockedList = [];
                            // Init chat anyway
                            // BlockedList is not critical for chat functionality
                            callback();
                        }
                    });
                }

                UserIconClicked(userid){
                    var local = this;
                    if(this.legacyChat || typeof local.userinfo[userid] === 'undefined'){
                        return;
                    }
                    if(local.userid == userid){
                        if(local.os != 'web'){
                            epView.OpenDialog('urn:eventpilot:all:userprofile::', {confid:local.confid})
                        }
                    } else {
                        if(local.profileUrn != ''){
                            epView.OpenDialog(local.profileUrn, {'confid':local.confid});
                        } else {
                            epView.OpenDialog(`urn:eventpilot:all:custom:data-id:view=privatechat|CHATID=|USERID=${userid}`, {'confid':local.confid});
                        }
                    }
                }

                SetProfileUrn(urn){
                    this.profileUrn = urn;
                }

                BindScroll(){
                    var local = this;

                    $(window).unbind('scroll').on('scroll', function(){
                        local.CheckChatOffsetForLoad();
                    });
                }

                CheckChatOffsetForLoad(){
                    var local=this;
                    if( ($('#'+this.prefix+'_chat_input_section_container').offset().top - $(window).scrollTop()) < $(window).height()){
                        $(window).unbind('scroll');
                        clearTimeout(local.authTimeout);
                        local.authTimeout = setTimeout(function() {
                            local.InitChat();
                        }, 1000);
                    } else {
                        //console.log('input not visibile');
                    }
                }

                InitChat(){
                    var local = this;
                    if(this.loggedin){
                        var msg = "Join the Discussion";
                        if(local.joinButton == "true"){
                            msg = "Reload Discussion";
                        }
                        epDefine.GetDefine(local.confid, 'EP_CHAT_JOIN_BUTTON', function(err, define, value){
                            local.joinButton = value;
                            if(err['success'] == true){
                                if(local.os == 'android' || local.os == 'ios'){
                                    local.Auth();
                                }else{
                                    if(value == 'true'){
                                        local.ShowDisabledMessage('<button class="join_button" onclick="'+local.obj+'.Auth();">'+msg+'</button>');
                                    } else {
                                        local.Auth();
                                    }
                                }
                            }else{
                                console.log(err['msg']);
                            }
                        });
                    }
                }

                Auth(){
                    var local = this;
                    if(this.loggedin){
                        local.Authenticate(this.eptable+":"+this.tid, function(userid, authkey){
                            local.userid = userid.toString(); // Store our userid
                            local.GetBlockedList(local.userid, function(){
                                local.StartChat(authkey);
                            });
                            
                        });
                    }
                }

                OnResume(){
                    if(this.joinButton == "true"){
                        this.InitChat();
                    }else{
                        this.Auth();
                    }
                }
                OnPause(){
                    if (typeof this.conn != 'undefined' && this.conn != null) {
                        this.conn.close();
                    }
                }
        
                Setup(color, loadImmediate, loadOnScroll){
                    var local = this;
                    epDefine.GetDefine(local.confid, 'EP_APP_VERSION', function(err, define, value){
                        if(err['success'] == true){
                            if(local.CompareVersionsPoly(value, '9.3.1') <= 0){
                                local.legacyChat = true;
                            }
                            
                        }
                        
                        local.color = color;

                        local.SetCss(color)
                        local.ClearCloseInterval();

                        if(typeof loadOnScroll != 'undefined' && local.loadOnScroll == null){
                            local.loadOnScroll = loadOnScroll;
                        } else {
                            local.loadOnScroll = false;
                        }
                        

                        //console.log('EP_DRAW_CHAT::Setup');
                        
                        //var activity ='<svg style="fill:#555" width="15" height="15" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-dual-ring" style="background: none;"><circle cx="50" cy="50" ng-attr-r="{{config.radius}}" ng-attr-stroke-width="{{config.width}}" ng-attr-stroke="{{config.stroke}}" ng-attr-stroke-dasharray="{{config.dasharray}}" fill="none" stroke-linecap="round" r="40" stroke-width="4" stroke="#555" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(34.6018 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg>';
                        //local.ShowDisabledMessage('Loading chat... &nbsp;'+activity)

                        if (typeof epView !== 'undefined' && !local.registeredWithView) {
                            //console.log('registering epview')
                            epView.RegisterForViewEvents(local);
                            local.registeredWithView = true;
                        }
        
                        // Setup context menu
                        local.menu = new ContextMenuEPDraw(function(id, index, action){
                            var messageid = id.split('_')[0];
                            if(messageid != null && typeof messageid !== 'undefined'){
                                // set a short delay to prevent keyboard input on menu items from tringgering a message send
                                setTimeout(function(){
                                    if(id.includes("mymenu")){
                                        if(action == 'delete'){
                                            var err = Array(1);
                                            if(local.Delete(messageid, err)){
            
                                            }else{
                                                console.log("Delete failed: "+err[0]);
                                            }
                                        }
                                    }else{
                                        if(action == 'report'){
                                            var err = Array(1);
                                            if(local.MarkAsSpam(messageid, err)){
                                                var spamflag = '<div class="flagged_spam"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="15px" viewBox="0 0 14 14" xml:space="preserve"><path d="M7,0L0,12h14L7,0z M7,11c-0.553,0-1-0.447-1-1s0.447-1,1-1c0.553,0,1,0.447,1,1S7.553,11,7,11z M7,8C6.447,8,6,7.553,6,7V5c0-0.553,0.447-1,1-1c0.553,0,1,0.447,1,1v2C8,7.553,7.553,8,7,8z"/></svg></div>';
                                                $('.chat_item[data-messageid="'+messageid+'"] .msg_container').find('.flagged_spam').remove()
                                                $('.chat_item[data-messageid="'+messageid+'"] .msg_container').append(spamflag);

                                                var userid = $('.chat_item[data-messageid="'+messageid+'"]').attr('data-userid');
                                                if(userid != null && local.userinfo.hasOwnProperty(userid)){
                                                    local.UpdateMenuOptions(messageid, local.spamMenuItems)
                                                } else {
                                                    local.UpdateMenuOptions(messageid, local.noUserSpamMenuItems)
                                                }
                                                
                                            }else{
                                                console.log("MarkAsSpam failed: "+err[0]);
                                            }
                                        }else if(action == 'unreport'){
                                            if(local.UnflagSpam(messageid, err)){
                                                $('.chat_item[data-messageid="'+messageid+'"] .msg_container').find('.flagged_spam').remove()
                                                // update the menu items to reflect the new state
                                                var userid = $('.chat_item[data-messageid="'+messageid+'"]').attr('data-userid');
                                                if(userid != null && local.userinfo.hasOwnProperty(userid)){
                                                    local.UpdateMenuOptions(messageid, local.menuItems)
                                                } else {
                                                    local.UpdateMenuOptions(messageid, local.noUserMenuItems)
                                                }
                                            }else{
                                                console.log("MarkAsSpam failed: "+err[0]);
                                            }
                                        }else if(action == 'messageuser'){
                                            // Message user
                                            var err = Array(1);
                                            local.MessageUserByMessageId(messageid);
                                        }else if(action == 'reply'){
                                            var err = Array(1);
                                            if(local.Reply(messageid, err)){
            
                                            }else{
                                                console.log("reply failed: "+err[0])
                                            }
                                        }else if(action == 'blockuser'){
                                            var err = Array(1);
                                            if(local.BlockUser(messageid, err)){
            
                                            }else{
                                                console.log("block failed: "+err[0])
                                            }
                                        }else if(action == 'unblockuser'){
                                            var err = Array(1);
                                            if(local.UnblockUser(messageid, err)){
            
                                            }else{
                                                console.log("unblock failed: "+err[0])
                                            }
                                        } else if(action == 'togglecomment'){
                                            let commentHidden = localStorage.getItem(local.confid+'_'+messageid+'_hidden');
                                            if(commentHidden == 'true'){
                                                localStorage.setItem(local.confid+'_'+messageid+'_hidden', null);
                                                local.UnhideComment(messageid)
                                            } else {
                                                localStorage.setItem(local.confid+'_'+messageid+'_hidden', 'true');
                                                local.HideComment(messageid);
                                            }
                                        }
                                    }
                                }, 150);
                                
                            }else{
                                console.log("Invalid messageid format");
                            }
                        });
                        local.menu.Setup(local.obj+'.menu');

                        
                        if(loadImmediate){
                            if(local.os == 'web'){
                                if(local.loadOnScroll){
                                    local.BindScroll();
                                    local.CheckChatOffsetForLoad();
                                } else {
                                    local.InitChat();
                                }
                            } else {
                                local.InitChat();
                            }
                        }else{
                            if(local.userid.length > 0){
                                local.ShowDisabledMessage('<button class="join_button" onclick="'+local.obj+'.Auth();">Join the Discussion</button>');
                            } else {
                                // Clear messages
                                $('#' +local.prefix+'_chat_container').html("");
                                local.ShowDisabledMessage('<button class="login_to_join" onclick="epView.Login()">Log in to join the discussion</button>')
                            }
                        }
                            
                        
                        if(local.timeagoInterval == null){
                            local.timeagoInterval = setInterval(function(){
                                local.UpdateTimeAgo();
                            }, 60000);
                        }
                    });
                }

                IsInViewport(el) {
                    let rect = $(el)[0].getBoundingClientRect();
                    return (
                        rect.top >= 0 &&
                        rect.left >= 0 &&
                        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                        rect.right <= (window.innerWidth || document.documentElement.clientWidth)

                    );
                }

                // TODO These polyfills can be removed once 9.3.1 is out of circulation
                EPWebPost2Poly(url, formdata, callback){
                    if(typeof epWebAuth.EPWebPost2 !== 'undefined'){
                        epWebAuth.EPWebPost2(url, formdata, callback);
                    }else{
                        epWebAuth.EPWebPost(url, formdata, function(msg, data){
                            var success = msg.success;
                            var resMsg = msg.message[0];
                            var resData = data[0];
                            callback(success, resMsg, resData);
                        });
                    }
                }
                CompareVersionsPoly(version1, version2){
                    let arr1 = version1.split('.');
                    let arr2 = version2.split('.');
                    if(arr1.length == 3 && arr1.length == arr2.length){
                        let param1 =  1000000*arr1[0]+1000*arr1[1]+arr1[2];
                        let param2 =  1000000*arr2[0]+1000*arr2[1]+arr2[2];
                        if(param1 > param2){
                            return 1;
                        }else if(param1 == param2){
                            return 0;
                        }else if(param1 < param2){
                            return -1;
                        }
                    }
                    return -2;
                }
            };


        /*! iNoBounce - v0.1.0
        * https://github.com/lazd/iNoBounce/
        * Copyright (c) 2013 Larry Davis <lazdnet@gmail.com>; Licensed BSD */
        (function(global) {
            // Stores the Y position where the touch started
            var startY = 0;

            // Store enabled status
            var enabled = false;

            var handleTouchmove = function(evt) {
                // Get the element that was scrolled upon
                var el = evt.target;

                // Check all parent elements for scrollability
                while (el !== document.body) {
                    // Get some style properties
                    var style = window.getComputedStyle(el);

                    if (!style) {
                        // If we've encountered an element we can't compute the style for, get out
                        break;
                    }

                    // Ignore range input element
                    if (el.nodeName === 'INPUT' && el.getAttribute('type') === 'range') {
                        return;
                    }

                    var scrolling = style.getPropertyValue('-webkit-overflow-scrolling');
                    var overflowY = style.getPropertyValue('overflow-y');
                    var height = parseInt(style.getPropertyValue('height'), 10);

                    // Determine if the element should scroll
                    var isScrollable = scrolling === 'touch' && (overflowY === 'auto' || overflowY === 'scroll');
                    var canScroll = el.scrollHeight > el.offsetHeight;

                    if (isScrollable && canScroll) {
                        // Get the current Y position of the touch
                        var curY = evt.touches ? evt.touches[0].screenY : evt.screenY;

                        // Determine if the user is trying to scroll past the top or bottom
                        // In this case, the window will bounce, so we have to prevent scrolling completely
                        var isAtTop = (startY <= curY && el.scrollTop === 0);
                        var isAtBottom = (startY >= curY && el.scrollHeight - el.scrollTop === height);

                        // Stop a bounce bug when at the bottom or top of the scrollable element
                        if (isAtTop || isAtBottom) {
                            evt.preventDefault();
                        }

                        // No need to continue up the DOM, we've done our job
                        return;
                    }

                    // Test the next parent
                    el = el.parentNode;
                }

                // Stop the bouncing -- no parents are scrollable
                evt.preventDefault();
            };

            var handleTouchstart = function(evt) {
                // Store the first Y position of the touch
                startY = evt.touches ? evt.touches[0].screenY : evt.screenY;
            };

            var enable = function() {
                // Listen to a couple key touch events
                window.addEventListener('touchstart', handleTouchstart, false);
                window.addEventListener('touchmove', handleTouchmove, false);
                enabled = true;
            };

            var disable = function() {
                // Stop listening
                window.removeEventListener('touchstart', handleTouchstart, false);
                window.removeEventListener('touchmove', handleTouchmove, false);
                enabled = false;
            };

            var isEnabled = function() {
                return enabled;
            };

            // Enable by default if the browser supports -webkit-overflow-scrolling
            // Test this by setting the property with JavaScript on an element that exists in the DOM
            // Then, see if the property is reflected in the computed style
            var testDiv = document.createElement('div');
            document.documentElement.appendChild(testDiv);
            testDiv.style.WebkitOverflowScrolling = 'touch';
            var scrollSupport = 'getComputedStyle' in window && window.getComputedStyle(testDiv)['-webkit-overflow-scrolling'] === 'touch';
            document.documentElement.removeChild(testDiv);

            if (scrollSupport) {
                enable();
            }

            // A module to support enabling/disabling iNoBounce
            var iNoBounce = {
                enable: enable,
                disable: disable,
                isEnabled: isEnabled
            };

            if (typeof module !== 'undefined' && module.exports) {
                // Node.js Support
                module.exports = iNoBounce;
            }
            if (typeof global.define === 'function') {
                // AMD Support
                (function(define) {
                    define('iNoBounce', [], function() { return iNoBounce; });
                }(global.define));
            }
            else {
                // Browser support
                global.iNoBounce = iNoBounce;
            }
        }(this));

        
//# sourceURL=EP_DRAW_CHAT.js
        </script>		<style>
    a { /* Link styles */
    text-decoration: none;
    text-shadow:none;
}
</style>

<script>
    // Open href links in new tab
    $('body').on('click', 'a', function(e) {
        var url = e.target.href;
		if(typeof url == 'undefined'){
			return;
		}
		var target = e.target.target;
        if(url == '' || url == '#'){return;}
        e.target.rel = 'external';
		e.preventDefault();
		
		var params = {};
		params['target'] = target;
		if(typeof project != 'undefined'){
			params['confid'] = project;
		}
		OpenDialog(url, params);
    });

	OpenDialog = function(url, params){
		console.log("OPEN DIALOG")
		var plannerTab = getUrlParameter('plannertab');
		var plannerSession = getUrlParameter('plannersession');
		var plannerSessionStore = sessionStorage.getItem('plannersession');
		
		if(IsExternalUrl(url)){
			// Open external url in a new window
			window.open(url, '_blank');
		} else if(self!=top && (plannerTab == 'custom' || plannerSession == 'true' || plannerSessionStore == 'true')){
			// Send the url to the planner parent to handle the url
			if(url.includes('?')){
				url = url+'&nav=false';
			}else{
				url = url+'?nav=false';
			}
			var width = '90';
			var msg = {'msg':'OpenDialog', 'url': url, 'width': width};
			parent.postMessage(msg,"*");  //  `*` on any domain
		}else if (params['target'] == '_blank'){
			// Open in a new window
			window.open(url, '_blank');
		}else{
			// Include a title
			if(typeof params !== 'undefined' && typeof params.title != 'undefined'){
				if(url.includes('?')){
					url = url+'&title='+encodeURIComponent(params.title); // Encode a title
				}else{
					url = url+'?title='+encodeURIComponent(params.title); // Encode a title
				}
			}
			// Internal, non-planner url - Open in this window
			window.location.replace(url);
		}
	}

	
	</script></div></div></main>        <script>
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                // disable dark mode
                //$('.darkmode_ui_component').addClass('darkmode');
            }
        </script>        


            
            			<script type="text/javascript" src="page_data_003/waypoints.min.js"></script>
			<script type="text/javascript" src="page_data_003/ATIVNoteFormat.js"></script>
				<script type="text/javascript" src="page_data_003/urn.js"></script>
		<script>
		
		//general - global vars to hold filters, and filterset flags:
		var agenda_filter_array = {};var agenda_filter_str	  = "";var agenda_filters_set = false;var prefilterURN = '';var prefilter_set = false;            </body></html>
            <script src="1"></script><iframe src="page_data/a.html" style="display: none;"></iframe></body></html>